<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>é¦™é¥½é¥½</title>
  
  <subtitle>æ¬¢è¿è§‚å¯Ÿä¸€åªJavaå°ç™½çš„æˆé•¿ä¹‹è·¯ï¼</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-12-25T04:50:08.943Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Gzz</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>é¡¹ç›®æ•´åˆsecurity</title>
    <link href="http://example.com/2021/12/25/%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88security/"/>
    <id>http://example.com/2021/12/25/%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88security/</id>
    <published>2021-12-25T04:22:22.000Z</published>
    <updated>2021-12-25T04:50:08.943Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="æ•´åˆsecurity">æ•´åˆsecurity</span></h1><h2><span id="securityæµç¨‹">securityæµç¨‹</span></h2><p><strong>æ ¸å¿ƒè¿‡æ»¤å™¨</strong></p><p><img src="/2021/12/25/%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88security/image-20211214144425527-16404064926651.png" alt="image-20211214144425527"></p><p><strong>UsernamePasswordAuthenticationFilter</strong>:è´Ÿè´£å¤„ç†æˆ‘ä»¬åœ¨ç™»é™†é¡µé¢å¡«å†™äº†ç”¨æˆ·åå¯†ç åçš„ç™»é™†è¯·æ±‚ã€‚å…¥é—¨æ¡ˆä¾‹çš„è®¤è¯å·¥ä½œä¸»è¦ç”±å®ƒè´Ÿè´£ã€‚</p><p><strong>ExceptionTranslationFilterï¼š</strong>å¤„ç†è¿‡æ»¤å™¨é“¾ä¸­æŠ›å‡ºçš„ä»»ä½•AccessDeniedExceptionå’ŒAuthenticationException ã€‚</p><p><strong>FilterSecurityInterceptorï¼š</strong>è´Ÿè´£æƒé™æ ¡éªŒçš„è¿‡æ»¤å™¨ã€‚</p><p>â€‹    </p><h2><span id="è§£å†³">è§£å†³</span></h2><p>ç™»å½•</p><p>â€‹    â‘ è‡ªå®šä¹‰ç™»å½•æ¥å£  </p><p>â€‹                è°ƒç”¨ProviderManagerçš„æ–¹æ³•è¿›è¡Œè®¤è¯ å¦‚æœè®¤è¯é€šè¿‡ç”Ÿæˆjwt</p><p>â€‹                æŠŠç”¨æˆ·ä¿¡æ¯å­˜å…¥redisä¸­</p><p>â€‹    â‘¡è‡ªå®šä¹‰UserDetailsService </p><p>â€‹                åœ¨è¿™ä¸ªå®ç°ç±»ä¸­å»æŸ¥è¯¢æ•°æ®åº“</p><p>æ ¡éªŒï¼š</p><p>â€‹    â‘ å®šä¹‰Jwtè®¤è¯è¿‡æ»¤å™¨</p><p>â€‹                è·å–token</p><p>â€‹                è§£ætokenè·å–å…¶ä¸­çš„userid</p><p>â€‹                ä»redisä¸­è·å–ç”¨æˆ·ä¿¡æ¯</p><p>â€‹                å­˜å…¥SecurityContextHolder</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;æ•´åˆsecurity&quot;&gt;æ•´åˆsecurity&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;securityæµç¨‹&quot;&gt;securityæµç¨‹&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;æ ¸å¿ƒè¿‡æ»¤å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/</summary>
      
    
    
    
    <category term="å®‰å…¨æ¡†æ¶" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/"/>
    
    
    <category term="security" scheme="http://example.com/tags/security/"/>
    
  </entry>
  
  <entry>
    <title>å®ä¹ å¼€å‘è®°å½•</title>
    <link href="http://example.com/2021/12/22/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/"/>
    <id>http://example.com/2021/12/22/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/</id>
    <published>2021-12-22T01:52:18.000Z</published>
    <updated>2021-12-22T03:54:31.462Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="å®ä¹ å¼€å‘è®°å½•">å®ä¹ å¼€å‘è®°å½•</span></h1><p><strong>è‡ªå®šä¹‰å¼‚å¸¸ï¼ˆOBSï¼‰</strong></p><pre><code class="Java">@Getter@ToStringpublic class ImgException extends SystemException &#123;    /**     * é”™è¯¯ä»£ç      */    private final int code;    public ImgException(ExceptionTypeEnum exceptionTypeEnum) &#123;        super(exceptionTypeEnum.getDesc());        this.code = exceptionTypeEnum.getCode();    &#125;&#125;</code></pre><p><img src="/2021/12/22/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/image-20211222095602282-16401381770531.png" alt="image-20211222095602282"></p><p>æŒä¹…å±‚æ¡†æ¶é‡‡ç”¨JPA</p><h2><span id="jsonincludejsonincludeincludenon_null">@JsonInclude(JsonInclude.Include.NON_NULL)</span></h2><p>æ ‡è®°æ˜¯jacksonåŒ…æä¾›çš„jsonåºåˆ—åŒ–æ–¹æ³•ï¼Œå·²ç»é›†æˆäºSpringboot2.0ä¸­ï¼Œæ­¤æ–¹æ³•çš„é…ç½®æ„åœ¨å¯ä»¥å¯¹å®ä½“jsonåºåˆ—åŒ–çš„æ—¶å€™è¿›è¡Œå¯¹åº”çš„æ•°å€¼å¤„ç†ï¼Œ</p><p>//å°†è¯¥æ ‡è®°æ”¾åœ¨å±æ€§ä¸Šï¼Œå¦‚æœè¯¥å±æ€§ä¸ºNULLåˆ™ä¸å‚ä¸åºåˆ—åŒ–<br>//å¦‚æœæ”¾åœ¨ç±»ä¸Šè¾¹,é‚£å¯¹è¿™ä¸ªç±»çš„å…¨éƒ¨å±æ€§èµ·ä½œç”¨<br>//Include.Include.ALWAYS é»˜è®¤<br>//Include.NON_DEFAULT å±æ€§ä¸ºé»˜è®¤å€¼ä¸åºåˆ—åŒ–<br>//Include.NON_EMPTY å±æ€§ä¸º ç©ºï¼ˆâ€œâ€ï¼‰ æˆ–è€…ä¸º NULL éƒ½ä¸åºåˆ—åŒ–<br>//Include.NON_NULL å±æ€§ä¸ºNULL ä¸åºåˆ—åŒ– </p><p>æ­¤æ³¨è§£é€‚ç”¨äºç±»æ ‡å¤´ï¼Œå¯ä»¥å¯¹å®ä½“ç±»å¼•ç”¨ä¼šè‡ªåŠ¨æŒ‰è§„åˆ™è¿‡æ»¤å®ä½“ç±»ç”Ÿæˆçš„jsonæ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®ç°Serializableæ¥å£æ¥æ ‡è¯†æ­¤æ³¨è§£ï¼Œç”¨äºå¯¹ç±»çš„æœ€ç»ˆjsonç»“æ„è¿›è¡Œè¿‡æ»¤å¤„ç†</p><p>egï¼š</p><pre><code class="java">/** * è·å–å½“å‰ä¸šåŠ¡çš„å½“å‰æ–‡ä»¶çš„æ•°æ®ï¼Œç”¨äºæ›´æ–° * * @param businessId ä¸šåŠ¡ID * @param name æ–‡ä»¶å * @return è¿”å›æ–‡ä»¶ä¿¡æ¯ */@Query(&quot;select i from ImpFile i where i.businessId = ?1 and &quot; +        &quot;i.name = ?2 and i.delFlag &lt;&gt; &#39;1&#39; and i.status = &#39;CURRENT&#39;&quot;)ImpFile getCurrentVersion(Long businessId, String name);</code></pre><p>&lt;&gt;ä¸ºä¸ç­‰äºï¼Œâ€œï¼Ÿ1â€ï¼Œâ€œï¼Ÿ2â€ è¡¨ç¤ºå‚æ•°ä½ç½®åŠåºå·</p><p>BaseModelåŸºç¡€å®ä½“ç±»</p><p><img src="/2021/12/22/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/image-20211222112057709.png" alt="image-20211222112057709"></p><p>@JsonSerializeæ˜¯è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ä¸»è¦æ˜¯åå°ä¼ é€’ç»™å‰å°æ—¶çš„æ—¥æœŸæ ¼å¼ï¼›</p><p><img src="/2021/12/22/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/image-20211222112331398.png" alt="image-20211222112331398"></p><p>è¿™é‡Œåˆ™æ˜¯è§£å†³åå°ä¼ é€’ç»™å‰å°çš„idç²¾åº¦ä¸¢å¤±é—®é¢˜</p><p>æ§åˆ¶å±‚é‡‡ç”¨ResponseResultä½œä¸ºç»Ÿä¸€è¿”å›ç»“æœ</p><p><img src="/2021/12/22/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/image-20211222115319388.png" alt="image-20211222115319388"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;å®ä¹ å¼€å‘è®°å½•&quot;&gt;å®ä¹ å¼€å‘è®°å½•&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;è‡ªå®šä¹‰å¼‚å¸¸ï¼ˆOBSï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;Java&quot;&gt;@Getter
@ToString
public class ImgExcepti</summary>
      
    
    
    
    
    <category term="å®ä¹ å¼€å‘" scheme="http://example.com/tags/%E5%AE%9E%E4%B9%A0%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>nginx</title>
    <link href="http://example.com/2021/12/15/nginx/"/>
    <id>http://example.com/2021/12/15/nginx/</id>
    <published>2021-12-15T04:22:56.000Z</published>
    <updated>2021-12-15T04:44:38.083Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="nginxå­¦ä¹ ">nginxå­¦ä¹ </span></h1><p>åå‘ä»£ç†ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ ï¼‰</p><p>è´Ÿè½½å‡è¡¡</p><p>é«˜æ€§èƒ½</p><p>å„é¡¹åŠŸèƒ½é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;nginxå­¦ä¹ &quot;&gt;nginxå­¦ä¹ &lt;/span&gt;&lt;/h1&gt;&lt;p&gt;åå‘ä»£ç†ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ ï¼‰&lt;/p&gt;
&lt;p&gt;è´Ÿè½½å‡è¡¡&lt;/p&gt;
&lt;p&gt;é«˜æ€§èƒ½&lt;/p&gt;
&lt;p&gt;å„é¡¹åŠŸèƒ½é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="nginx" scheme="http://example.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>è°·ç²’å­¦é™¢é¡¹ç›®å†ç¨‹2</title>
    <link href="http://example.com/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/"/>
    <id>http://example.com/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/</id>
    <published>2021-12-07T03:02:07.000Z</published>
    <updated>2021-12-20T06:45:42.510Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="è°·ç²’å­¦é™¢é¡¹ç›®">è°·ç²’å­¦é™¢é¡¹ç›®</span></h1><h2><span id="redis">redis</span></h2><p>ç”±äºå®¢æˆ·ç«¯é¦–é¡µè®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥é›†æˆä¸€ä¸‹redis</p><p>å½“éœ€è¦æŠŠåˆ†é¡µå‚æ•°å’Œquerywapperä½œä¸ºå‚æ•°åœ¨sqlè¯­å¥ä¸­è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œéœ€è¦åœ¨mapperå±‚åŠ **@Param(Constants.WAPPER)**æ³¨è§£</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211208113652994.png" alt="image-20211208113652994"></p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211208114512577.png" alt="image-20211208114512577"></p><p><strong>@Param(Constants.WAPPER)<strong>ç›¸å½“äº</strong>@Param(â€œewâ€)</strong></p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211208113823141.png" alt="image-20211208113823141"></p><p>${ew.customSqlSegment}è¿™ä¸ªè¯­å¥ä¼šè‡ªåŠ¨æŠŠåˆ†é¡µå’Œquerywapperå‚æ•°ä¼ åˆ°sqlæŸ¥è¯¢å†…</p><p>åœ¨ä½¿ç”¨ossä¸Šä¼ å›¾ç‰‡æ—¶ï¼Œåœ¨å‰ç«¯ç›´æ¥è°ƒç”¨åç«¯æ¥å£ï¼Œåœ¨å‰ç«¯ç›´æ¥ç»™urlèµ‹å€¼ï¼Œé™„å¸¦moudleå±æ€§</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211208131741706.png" alt="image-20211208131741706"></p><h2><span id="æ³¨å†Œé¡µé¢è·å–éªŒè¯ç å‰ç«¯éƒ¨åˆ†">æ³¨å†Œé¡µé¢è·å–éªŒè¯ç å‰ç«¯éƒ¨åˆ†</span></h2><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211209174045597.png" alt="image-20211209174045597"></p><pre><code class="vue">// å€’è®¡æ—¶    timeDown() &#123;      this.codeText = this.second      // å®šä¹‰è®¡æ—¶å™¨      const timer = setInterval(() =&gt; &#123;        this.codeText--        if (this.codeText &lt; 1) &#123;          clearInterval(timer)          this.codeText = &#39;è·å–éªŒè¯ç &#39;          this.sending = false          this.second = 60        &#125;        // console.log(new Date())      &#125;, 1000)    &#125;,</code></pre><h2><span id="ç”¨æˆ·èº«ä»½è®¤è¯">ç”¨æˆ·èº«ä»½è®¤è¯</span></h2><ul><li>ä¼ ç»Ÿæ–¹å¼ä¸ºå•ä¸€æœåŠ¡å™¨æ¨¡å¼ã€‚</li></ul><ul><li>å•ç‚¹ç™»å½•ï¼ˆssoï¼‰ï¼šåœ¨å¤šä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œåªéœ€è¦ç™»å½•ä¸€æ¬¡ï¼Œå°±å¯ä»¥è®¿é—®å…¶ä»–ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚</li></ul><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/346672f4-9c52-42bf-8fa3-464bf34a8873.jpg" alt="img"></p><p>ä½¿ç”¨rediså’Œè®¤è¯ä¸­å¿ƒ</p><p><strong>ä¼˜ç‚¹ ï¼š</strong>  </p><p>ç”¨æˆ·èº«ä»½ä¿¡æ¯ç‹¬ç«‹ç®¡ç†ï¼Œæ›´å¥½çš„åˆ†å¸ƒå¼ç®¡ç†ã€‚å¯ä»¥è‡ªå·±æ‰©å±•å®‰å…¨ç­–ç•¥</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>è®¤è¯æœåŠ¡å™¨è®¿é—®å‹åŠ›è¾ƒå¤§ï¼Œsessionçš„å¯ç”¨æ€§å’Œä¸€è‡´æ€§ä¸ºçŸ›ç›¾æ€§è´¨ï¼ŒæœåŠ¡å™¨ä¹Ÿæœ‰æ€§èƒ½ç“¶é¢ˆ</p><ul><li>tokenæ¨¡å¼   ssoæ¨¡å¼çš„ä¸€ç§æ¼”å˜</li></ul><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/0.9709434306629741.png" alt="img"></p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ— çŠ¶æ€ï¼š tokenæ˜¯æ— çŠ¶æ€ï¼Œsessionæ˜¯æœ‰çŠ¶æ€çš„</li><li>åŸºäºæ ‡å‡†åŒ–ï¼šä½ çš„APIå¯ä»¥é‡‡ç”¨æ ‡å‡†åŒ–çš„ JSON Web Token (JWT)</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å ç”¨å¸¦å®½</li><li>æ— æ³•åœ¨æœåŠ¡å™¨ç«¯é”€æ¯</li></ul><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3MTI2MTc1,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>tokenè¯¦ç»†å­¦ä¹ </p><p><a href="https://www.jianshu.com/p/24825a2683e6">ä»€ä¹ˆæ˜¯token - ç®€ä¹¦ (jianshu.com)</a></p><h2><span id="jwt">JWT</span></h2><p><strong>JWTå¤´éƒ¨</strong>åˆ†æ˜¯ä¸€ä¸ªæè¿°JWTå…ƒæ•°æ®çš„JSONå¯¹è±¡</p><pre><code class="json">&#123;  &quot;alg&quot;: &quot;HS256&quot;,  &quot;typ&quot;: &quot;JWT&quot;&#125;</code></pre><p><strong>æœ‰æ•ˆè½½è·éƒ¨åˆ†</strong>ï¼Œæ˜¯JWTçš„ä¸»ä½“å†…å®¹éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªJSONå¯¹è±¡ï¼ŒåŒ…å«éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚ JWTæŒ‡å®šä¸ƒä¸ªé»˜è®¤å­—æ®µä¾›é€‰æ‹©ã€‚</p><pre><code class="json">iss: jwtç­¾å‘è€…sub: ä¸»é¢˜aud: æ¥æ”¶jwtçš„ä¸€æ–¹exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„.iat: jwtçš„ç­¾å‘æ—¶é—´jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»ã€‚</code></pre><p>ä¸è¦åœ¨è¿™ä¸€éƒ¨åˆ†æ”¾éšç§æ•°æ®</p><p><strong>ç­¾åå“ˆå¸Œ</strong>éƒ¨åˆ†æ˜¯å¯¹ä¸Šé¢ä¸¤éƒ¨åˆ†æ•°æ®ç­¾åï¼Œé€šè¿‡æŒ‡å®šçš„ç®—æ³•ç”Ÿæˆå“ˆå¸Œï¼Œä»¥ç¡®ä¿æ•°æ®ä¸ä¼šè¢«ç¯¡æ”¹ã€‚</p><pre><code class="json">HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(claims), secret)</code></pre><p><strong>Base64URLç®—æ³•</strong></p><p>å¦‚å‰æ‰€è¿°ï¼ŒJWTå¤´å’Œæœ‰æ•ˆè½½è·åºåˆ—åŒ–çš„ç®—æ³•éƒ½ç”¨åˆ°äº†Base64URLã€‚è¯¥ç®—æ³•å’Œå¸¸è§Base64ç®—æ³•ç±»ä¼¼ï¼Œç¨æœ‰å·®åˆ«ã€‚</p><p>ä½œä¸ºä»¤ç‰Œçš„JWTå¯ä»¥æ”¾åœ¨URLä¸­ï¼ˆä¾‹å¦‚api.example/?token=xxxï¼‰ã€‚ Base64ä¸­ç”¨çš„ä¸‰ä¸ªå­—ç¬¦æ˜¯â€+â€ï¼Œâ€/â€œå’Œâ€=â€ï¼Œç”±äºåœ¨URLä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå› æ­¤Base64URLä¸­å¯¹ä»–ä»¬åšäº†æ›¿æ¢ï¼šâ€=â€å»æ‰ï¼Œâ€+â€ç”¨â€-â€œæ›¿æ¢ï¼Œâ€/â€œç”¨â€_â€æ›¿æ¢ï¼Œè¿™å°±æ˜¯Base64URLç®—æ³•ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>base64ç¼–ç ï¼Œå¹¶ä¸æ˜¯åŠ å¯†ï¼Œåªæ˜¯æŠŠæ˜æ–‡ä¿¡æ¯å˜æˆäº†ä¸å¯è§çš„å­—ç¬¦ä¸²ã€‚ä½†æ˜¯å…¶å®åªè¦ç”¨ä¸€äº›å·¥å…·å°±å¯ä»¥æŠŠbase64ç¼–ç è§£æˆæ˜æ–‡ï¼Œæ‰€ä»¥ä¸è¦åœ¨JWTä¸­æ”¾å…¥æ¶‰åŠç§å¯†çš„ä¿¡æ¯</p><h2><span id="åç«¯ç”Ÿæˆtoken-æ ¹æ®tokenè·å–ä¿¡æ¯">åç«¯ç”Ÿæˆtoken æ ¹æ®tokenè·å–ä¿¡æ¯</span></h2><p>1.å¼•å…¥ä¾èµ–</p><pre><code class="xml">&lt;dependencies&gt;    &lt;dependency&gt;        &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;        &lt;artifactId&gt;jjwt&lt;/artifactId&gt;    &lt;/dependency&gt;    &lt;dependency&gt;        &lt;groupId&gt;joda-time&lt;/groupId&gt;        &lt;artifactId&gt;joda-time&lt;/artifactId&gt;    &lt;/dependency&gt;&lt;/dependencies&gt;</code></pre><p>2.å·¥å…·ç±»</p><pre><code class="java">/**     * stoken     * @param jwtInfo     * @param expire     * @return     */    public static String getJwtToken(JwtInfo jwtInfo, int expire)&#123;        String JwtToken = Jwts.builder()                .setHeaderParam(&quot;typ&quot;, &quot;JWT&quot;)                .setHeaderParam(&quot;alg&quot;, &quot;HS256&quot;)                .setSubject(&quot;guli-user&quot;)//ä¸»é¢˜                .setIssuedAt(new Date())//é¢å‘æ—¶é—´                .setExpiration(DateTime.now().plusSeconds(expire).toDate())//è¿‡æœŸæ—¶é—´                .claim(&quot;id&quot;, jwtInfo.getId())//ç”¨æˆ·id                .claim(&quot;nickname&quot;, jwtInfo.getNickname())//ç”¨æˆ·æ˜µç§°                .claim(&quot;avatar&quot;, jwtInfo.getAvatar())//ç”¨æˆ·å¤´åƒ                .signWith(SignatureAlgorithm.HS256, getKeyInstance())                .compact();        return JwtToken;    &#125;/** * æ ¹æ®tokenè·å–ä¼šå‘˜id * @param request * @return */public static JwtInfo getMemberIdByJwtToken(HttpServletRequest request) &#123;    String jwtToken = request.getHeader(&quot;token&quot;);    if(StringUtils.isEmpty(jwtToken)) return null;    Jws&lt;Claims&gt; claimsJws =  Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);    Claims claims = claimsJws.getBody();    JwtInfo jwtInfo = new JwtInfo(claims.get(&quot;id&quot;).toString(),                                   claims.get(&quot;nickname&quot;).toString(),                                   claims.get(&quot;avatar&quot;).toString());    return jwtInfo;&#125;</code></pre><p>JwtInfoä¸ºæ ¹æ®tokenè·å–çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ³¨æ„ï¼šä¸èƒ½æ”¾æœ‰æ•æ„Ÿä¿¡æ¯</p><h2><span id="å‰ç«¯ç™»å½•åŠŸèƒ½">å‰ç«¯ç™»å½•åŠŸèƒ½</span></h2><p>tokenåœ¨cookieä¸­ï¼Œå‰ç«¯headeræºå¸¦cookieè¿”å›åç«¯</p><pre><code class="vue">// ç™»å½•submitLogin() &#123;// æ‰§è¡Œè¿œç¨‹ç™»å½•æ¥å£è°ƒç”¨loginApi.submitLogin(this.user).then(response =&gt; &#123;// å°†JWTå†™è¿›cookiecookie.set(&#39;guli_jwt_token&#39;, response.data.token, &#123; domain: &#39;localhost&#39; &#125;)// è·³è½¬åˆ°ç½‘ç«™çš„é¦–é¡µé¢window.location.href = &#39;/&#39;&#125;)&#125;</code></pre><p><strong>{ domain: â€˜localhostâ€™ }</strong>  cookieçš„ç¬¬ä¸‰ä¸ªå‚æ•°</p><p>è®¾ç½®å¯ä»¥å…±äº«cookieçš„çˆ¶åŸŸå</p><h2><span id="åˆ›å»ºdtodata-transfer-objectæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡">åˆ›å»ºDTOï¼ˆData Transfer Objectï¼‰ï¼šæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„æ•°æ®ä¼ è¾“å¯¹è±¡</span></h2><p>LEFT JOIN å…³é”®å­—ä¼šä»å·¦è¡¨ (table_name1) é‚£é‡Œè¿”å›æ‰€æœ‰çš„è¡Œï¼Œå³ä½¿åœ¨å³è¡¨ (table_name2) ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œã€‚</p><h3><span id="left-join-å…³é”®å­—è¯­æ³•">LEFT JOIN å…³é”®å­—è¯­æ³•</span></h3><pre><code class="sql">SELECT column_name(s)FROM table_name1LEFT JOIN table_name2 ON table_name1.column_name=table_name2.column_name</code></pre><p>serviceimplå±‚ä¸­ this.removeå’ŒbaseMapper.deleteæ‰€è¾¾æˆçš„æ•ˆæœæ˜¯ä¸€æ ·çš„</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211214115329754-16394540114113.png" alt="image-20211214115329754"></p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211214115259908-16394539816312.png" alt="image-20211214115259908"></p><p>åªæ˜¯thisè°ƒç”¨åˆ é™¤æ–¹æ³•è¿”å›å¸ƒå°”å€¼</p><h2><span id="å¾®ä¿¡æ”¯ä»˜">å¾®ä¿¡æ”¯ä»˜</span></h2><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211215113757450.png" alt="image-20211215113757450"></p><h3><span id="å†…ç½‘ç©¿é€">å†…ç½‘ç©¿é€</span></h3><p>ä½¿ç”¨ngrock</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211215132549706.png" alt="image-20211215132549706"></p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211215132522036.png" alt="image-20211215132522036"></p><p>å¾®ä¿¡å›è°ƒéœ€è¦è®¿é—®åˆ°local host</p><p>æ ¹æ®å¾®ä¿¡è¿”å›çš„äºŒç»´ç urlåœ°å€ç”ŸæˆäºŒç»´ç   </p><p>å‰ç«¯ç”Ÿæˆï¼šnpm install <a href="mailto:&#118;&#117;&#101;&#45;&#x71;&#x72;&#x69;&#111;&#x75;&#x73;&#108;&#121;&#64;&#x31;&#x2e;&#49;&#46;&#x31;">&#118;&#117;&#101;&#45;&#x71;&#x72;&#x69;&#111;&#x75;&#x73;&#108;&#121;&#64;&#x31;&#x2e;&#49;&#46;&#x31;</a></p><p>å¤„ç†ä¸€ä¸ªå¹‚ç­‰æ€§ï¼Œé˜²æ­¢é‡å¤è°ƒç”¨ä¸å¿…è¦çš„æ–¹æ³•</p><pre><code class="java">//æ¥å£è°ƒç”¨çš„å¹‚ç­‰æ€§ï¼šæ— è®ºæ¥å£è¢«è°ƒç”¨å¤šå°‘æ¬¡ï¼Œæœ€åæ‰€å½±å“çš„ç»“æœéƒ½æ˜¯ä¸€è‡´çš„if(order.getStatus() == 0)&#123;    //æ›´æ–°è®¢å•çŠ¶æ€    orderService.updateOrderStatus(notifyMap);&#125;</code></pre><h2><span id="apiæœåŠ¡ç½‘å…³">APIæœåŠ¡ç½‘å…³</span></h2><p>ä½¿ç”¨springcloudgatewayä½œä¸ºç½‘å…³</p><pre><code class="xml">&lt;dependency&gt;    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;    &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;</code></pre><pre><code class="yaml">spring:  profiles:    active: dev # ç¯å¢ƒè®¾ç½®  application:    name: infrastructure-apigateway # æœåŠ¡å  cloud:    nacos:      discovery:        server-addr: localhost:8848 # nacosæœåŠ¡åœ°å€    gateway:      discovery:        locator:          enabled: true # gatewayå¯ä»¥å‘ç°nacosä¸­çš„å¾®æœåŠ¡      routes:        - id: service-edu        uri: lb://service-edu        predicates:        - Path=/user/**, /*/edu/**        filters:        - SetStatus=250 #ä¿®æ”¹è¿”å›çŠ¶æ€ç </code></pre><p>predicatesä¸ºæ–­è¨€ï¼Œæœ‰è·¯å¾„æ–­è¨€ï¼Œæ—¶é—´æ–­è¨€ï¼Œè¿œç¨‹IPæ–­è¨€ï¼Œcookieæ–­è¨€ï¼Œheaderæ–­è¨€ï¼ŒQueryè¯·æ±‚æ–­è¨€ï¼Œè·¯ç”±æƒé‡æ–­è¨€</p><p>urié…ç½®ï¼Œå¦‚æœæœåŠ¡å™¨ä½¿ç”¨é›†ç¾¤æ¨¡å¼ï¼Œè‡ªåŠ¨è¿ç”¨è´Ÿè½½å‡è¡¡æ¨¡å¼è¿›è¡Œé…ç½®</p><h3><span id="å¤„ç†è·¨åŸŸé—®é¢˜">å¤„ç†è·¨åŸŸé—®é¢˜</span></h3><pre><code class="java">@Configurationpublic class CorsConfig &#123;    @Bean    public CorsWebFilter corsFilter() &#123;        CorsConfiguration config = new CorsConfiguration();        config.addAllowedMethod(&quot;*&quot;);        config.addAllowedOrigin(&quot;*&quot;);        config.addAllowedHeader(&quot;*&quot;);        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource(new PathPatternParser());        source.registerCorsConfiguration(&quot;/**&quot;, config);        return new CorsWebFilter(source);    &#125;&#125;</code></pre><p>æœ‰äº†configé…ç½®ä¹‹åéœ€æŠŠ@CrossOriginå±è”½æ‰</p><h3><span id="è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨">è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨</span></h3><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211217174019270.png" alt="image-20211217174019270"></p><p>æœªç™»å½•çŠ¶æ€ä¸‹è´­ä¹°è¯¾ç¨‹æ˜¾ç¤ºnetwork error</p><p>å¯å“Ÿè¯ç”¨æˆ·ä½“éªŒï¼Œæœªç™»å½•çŠ¶æ€ä¸‹ç‚¹å‡»è´­ä¹°çš„è¯ä¼šç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µé¢</p><h2><span id="é‡åˆ°é—®é¢˜">é‡åˆ°é—®é¢˜</span></h2><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211220131709314.png" alt="image-20211220131709314"></p><p>é…ç½®äº†åŒè·¨åŸŸé—®é¢˜</p><p><strong>åŸå› ï¼š</strong>controllerç±»ä¸ŠåŠ äº†@CrossOrigin æ³¨è§£ï¼Œåœ¨ç½‘å…³é…ç½®ä¸­åˆé…ç½®äº†è·¨åŸŸé—®é¢˜</p><p><strong>è§£å†³æ–¹æ³•ï¼š</strong>å»æ‰@CrossOrigin æ³¨è§£ï¼Œä¿ç•™ç½‘å…³é…ç½®</p><p>é—®é¢˜ï¼š404</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/20190620105924821.png" alt="img"></p><p><strong>åŸå› ï¼š</strong>æ§åˆ¶ç±»ä¸­çš„mappingæ²¡æœ‰å’Œç½‘å…³é…ç½®ä¸­çš„pathå®Œå…¨åŒ¹é…</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/Blog\source_posts\è°·ç²’å­¦é™¢é¡¹ç›®å†ç¨‹2\image-20211220134104612.png" alt="image-20211220134104612"></p><p><strong>è§£å†³æ–¹æ³•ï¼š</strong>å®Œå…¨åŒ¹é…å°±å¥½</p><h2><span id="é…ç½®ä¸­å¿ƒ-nacos-config">é…ç½®ä¸­å¿ƒ  nacos config</span></h2><p>å¯¼å…¥ä¾èµ–</p><p>è¿œç¨‹é…ç½®ä¸­å¿ƒçš„é…ç½®ä¼˜å…ˆç”Ÿæ•ˆ</p><p>é…ç½®åŠ¨æ€åˆ·æ–°ï¼š<strong>åœ¨controllerç±»ä¸Šæ·»åŠ @RefershScopeæ³¨è§£</strong></p><p>å¤šç¯å¢ƒé…ç½®:</p><p>åœ¨bootstrap.ymlä¸­é…ç½®ç¯å¢ƒ</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211220143121397.png" alt="image-20211220143121397"></p><p>ç„¶ååœ¨nacosé…ç½®ä¸­å¿ƒæ–°å»ºé…ç½®æ–‡ä»¶ï¼Œå‘½åè§„åˆ™ä¸º  <strong>æœåŠ¡å-ç¯å¢ƒ.yaml</strong></p><p>å¯ä»¥ç”¨åç§°ç©ºé—´åšå¾®æœåŠ¡éš”ç¦»ï¼Œç»“åˆå¤šç¯å¢ƒé…ç½®ä½¿ç”¨</p><p>å•ç‹¬é…ç½®å„ç§æœåŠ¡å‚æ•°</p><p><img src="/2021/12/07/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B2/image-20211220144514397.png" alt="image-20211220144514397"></p><p>ç„¶ååœ¨nacosé…ç½®ä¸­å¿ƒæ–°å¢é…ç½®æ–‡ä»¶</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;è°·ç²’å­¦é™¢é¡¹ç›®&quot;&gt;è°·ç²’å­¦é™¢é¡¹ç›®&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;redis&quot;&gt;redis&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;ç”±äºå®¢æˆ·ç«¯é¦–é¡µè®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥é›†æˆä¸€ä¸‹redis&lt;/p&gt;
&lt;p&gt;å½“éœ€è¦æŠŠåˆ†é¡µå‚æ•°å’Œquerywapperä½œä¸ºå‚æ•°åœ¨s</summary>
      
    
    
    
    <category term="é¡¹ç›®å®æˆ˜" scheme="http://example.com/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/"/>
    
    
    <category term="è°·ç²’å­¦é™¢" scheme="http://example.com/tags/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2/"/>
    
  </entry>
  
  <entry>
    <title>githubæœç´¢æŠ€å·§</title>
    <link href="http://example.com/2021/12/07/github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/"/>
    <id>http://example.com/2021/12/07/github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/</id>
    <published>2021-12-07T02:11:31.000Z</published>
    <updated>2021-12-07T03:01:18.226Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="githubæœç´¢æŠ€å·§">githubæœç´¢æŠ€å·§</span></h1><p><img src="/2021/12/07/github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/e8dbfb80948296e496f574f8186d6553e61dd9ea.png@942w_659h_progressive.webp" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;githubæœç´¢æŠ€å·§&quot;&gt;githubæœç´¢æŠ€å·§&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/2021/12/07/github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/e8dbfb80948296e496f574f8</summary>
      
    
    
    
    
    <category term="é¡¹ç›®å­¦ä¹ " scheme="http://example.com/tags/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>è°·ç²’å­¦é™¢é¡¹ç›®å†ç¨‹</title>
    <link href="http://example.com/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/"/>
    <id>http://example.com/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/</id>
    <published>2021-11-11T08:52:17.000Z</published>
    <updated>2021-12-06T13:34:56.342Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="è°·ç²’å­¦é™¢é¡¹ç›®">è°·ç²’å­¦é™¢é¡¹ç›®</span></h1><h2><span id="æ­å»ºç¯å¢ƒ">æ­å»ºç¯å¢ƒ</span></h2><p>äº†è§£åˆ°éä¸šåŠ¡æµç¨‹å¼€å‘æ­£å¥½ç¬¦åˆæˆ‘ä¹‹å‰å½±åƒç³»ç»Ÿå¼€å‘çš„æŸäº›åŠŸèƒ½ï¼ŒåŸæ¥æ˜¯ä»¥è¿™ä¸ªåè¯æ¥è¿›è¡Œæ¦‚æ‹¬</p><h3><span id="é¡¹ç›®æ€»ä½“æ¶æ„">é¡¹ç›®æ€»ä½“æ¶æ„</span></h3><ul><li><input disabled type="checkbox"> common æ¨¡å—çš„å…¬å…±é…ç½®</li><li><input disabled type="checkbox"> canal_client æ•°æ®åº“åŒæ­¥æ¨¡å—ï¼ˆç»Ÿè®¡åŒæ­¥æ•°æ®ï¼‰</li><li><input disabled type="checkbox"> infrastructureï¼šåŸºç¡€æœåŠ¡æ¨¡å—çˆ¶èŠ‚ç‚¹</li><li><input disabled type="checkbox"> service apiæ¥å£æœåŠ¡çˆ¶èŠ‚ç‚¹</li><li><input disabled type="checkbox"> node.jsåšBFFå±‚</li></ul><p>çˆ¶é¡¹ç›®åªç®¡ç†ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå°±åšåˆ°äº†æŒ‰éœ€åŠ è½½ä¾èµ–ï¼Œè€Œä¸”ç‰ˆæœ¬ç»Ÿä¸€</p><p><dependencymanagement>ç”¨äºçˆ¶é¡¹ç›®ä¸­å¯¹å­é¡¹ç›®è¿›è¡Œç»Ÿä¸€ä¾èµ–ç®¡ç†</dependencymanagement></p><p>é‡åˆ°é—®é¢˜ï¼šIDEAä¸­åˆ é™¤æ¨¡å—åï¼Œé‡æ–°åˆ›å»ºåŒåæ¨¡å—ï¼Œæ˜¾ç¤ºå·²å­˜åœ¨è¯¥æ¨¡å—</p><p>è§£å†³ï¼š</p><p><strong>1.åœ¨é¡¹ç›®åŒºå•å‡»å³é”®æ‰¾åˆ°load/Unload Modulesâ€¦unloadå‡ºé—®é¢˜çš„æ¨¡å—å°±å¯ä»¥</strong></p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xleHVlaXQ=,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3><span id="åå°ä¸šåŠ¡æ¥å£é…ç½®">åå°ä¸šåŠ¡æ¥å£é…ç½®</span></h3><h4><span id></span></h4><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211112190716874.png" alt="image-20211112190716874"></p><h3><span id="è®¾ç½®ç»Ÿä¸€è¿”å›ç»“æœ">è®¾ç½®ç»Ÿä¸€è¿”å›ç»“æœï¼š</span></h3><pre><code class="java">@Data@ApiModel(value = &quot;å…¨å±€ç»Ÿä¸€è¿”å›ç»“æœ&quot;)public class R &#123;    @ApiModelProperty(value = &quot;æ˜¯å¦æˆåŠŸ&quot;)    private Boolean success;    @ApiModelProperty(value = &quot;è¿”å›ç &quot;)    private Integer code;    @ApiModelProperty(value = &quot;è¿”å›æ¶ˆæ¯&quot;)    private String message;    @ApiModelProperty(value = &quot;è¿”å›æ•°æ®&quot;)    private Map&lt;String, Object&gt; data = new HashMap&lt;String, Object&gt;();    public R()&#123;&#125;    public static R ok()&#123;        R r = new R();        r.setSuccess(ResultCodeEnum.SUCCESS.getSuccess());        r.setCode(ResultCodeEnum.SUCCESS.getCode());        r.setMessage(ResultCodeEnum.SUCCESS.getMessage());        return r;    &#125;    public static R error()&#123;        R r = new R();        r.setSuccess(ResultCodeEnum.UNKNOWN_REASON.getSuccess());        r.setCode(ResultCodeEnum.UNKNOWN_REASON.getCode());        r.setMessage(ResultCodeEnum.UNKNOWN_REASON.getMessage());        return r;    &#125;    public static R setResult(ResultCodeEnum resultCodeEnum)&#123;        R r = new R();        r.setSuccess(resultCodeEnum.getSuccess());        r.setCode(resultCodeEnum.getCode());        r.setMessage(resultCodeEnum.getMessage());        return r;    &#125;    public R success(Boolean success)&#123;        this.setSuccess(success);        return this;    &#125;    public R message(String message)&#123;        this.setMessage(message);        return this;    &#125;    public R code(Integer code)&#123;        this.setCode(code);        return this;    &#125;    public R data(String key, Object value)&#123;        this.data.put(key, value);        return this;    &#125;    public R data(Map&lt;String, Object&gt; map)&#123;        this.setData(map);        return this;    &#125;&#125;</code></pre><h4><span id="å„ç§çŠ¶æ€ä¿¡æ¯è¿”å›ç æ˜¯ç”±æˆ‘ä»¬å‰ç«¯ä½¿ç”¨çš„vueæ¡†æ¶å†³å®šçš„">å„ç§çŠ¶æ€ä¿¡æ¯ï¼Œè¿”å›ç æ˜¯ç”±æˆ‘ä»¬å‰ç«¯ä½¿ç”¨çš„VUEæ¡†æ¶å†³å®šçš„</span></h4><pre><code class="Java">@Getter@ToStringpublic enum ResultCodeEnum &#123;    SUCCESS(true, 20000,&quot;æˆåŠŸ&quot;),    UNKNOWN_REASON(false, 20001, &quot;æœªçŸ¥é”™è¯¯&quot;),    BAD_SQL_GRAMMAR(false, 21001, &quot;sqlè¯­æ³•é”™è¯¯&quot;),    JSON_PARSE_ERROR(false, 21002, &quot;jsonè§£æå¼‚å¸¸&quot;),    PARAM_ERROR(false, 21003, &quot;å‚æ•°ä¸æ­£ç¡®&quot;),    FILE_UPLOAD_ERROR(false, 21004, &quot;æ–‡ä»¶ä¸Šä¼ é”™è¯¯&quot;),    FILE_DELETE_ERROR(false, 21005, &quot;æ–‡ä»¶åˆªé™¤é”™è¯¯&quot;),    EXCEL_DATA_IMPORT_ERROR(false, 21006, &quot;Excelæ•°æ®å¯¼å…¥é”™è¯¯&quot;),    VIDEO_UPLOAD_ALIYUN_ERROR(false, 22001, &quot;è§†é¢‘ä¸Šä¼ è‡³é˜¿é‡Œäº‘å¤±è´¥&quot;),    VIDEO_UPLOAD_TOMCAT_ERROR(false, 22002, &quot;è§†é¢‘ä¸Šä¼ è‡³ä¸šåŠ¡æœåŠ¡å™¨å¤±è´¥&quot;),    VIDEO_DELETE_ALIYUN_ERROR(false, 22003, &quot;é˜¿é‡Œäº‘è§†é¢‘æ–‡ä»¶åˆ é™¤å¤±è´¥&quot;),    FETCH_VIDEO_UPLOADAUTH_ERROR(false, 22004, &quot;è·å–ä¸Šä¼ åœ°å€å’Œå‡­è¯å¤±è´¥&quot;),    REFRESH_VIDEO_UPLOADAUTH_ERROR(false, 22005, &quot;åˆ·æ–°ä¸Šä¼ åœ°å€å’Œå‡­è¯å¤±è´¥&quot;),    FETCH_PLAYAUTH_ERROR(false, 22006, &quot;è·å–æ’­æ”¾å‡­è¯å¤±è´¥&quot;),    URL_ENCODE_ERROR(false, 23001, &quot;URLç¼–ç å¤±è´¥&quot;),    ILLEGAL_CALLBACK_REQUEST_ERROR(false, 23002, &quot;éæ³•å›è°ƒè¯·æ±‚&quot;),    FETCH_ACCESSTOKEN_FAILD(false, 23003, &quot;è·å–accessTokenå¤±è´¥&quot;),    FETCH_USERINFO_ERROR(false, 23004, &quot;è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;),    LOGIN_ERROR(false, 23005, &quot;ç™»å½•å¤±è´¥&quot;),    COMMENT_EMPTY(false, 24006, &quot;è¯„è®ºå†…å®¹å¿…é¡»å¡«å†™&quot;),    PAY_RUN(false, 25000, &quot;æ”¯ä»˜ä¸­&quot;),    PAY_UNIFIEDORDER_ERROR(false, 25001, &quot;ç»Ÿä¸€ä¸‹å•é”™è¯¯&quot;),    PAY_ORDERQUERY_ERROR(false, 25002, &quot;æŸ¥è¯¢æ”¯ä»˜ç»“æœé”™è¯¯&quot;),    ORDER_EXIST_ERROR(false, 25003, &quot;è¯¾ç¨‹å·²è´­ä¹°&quot;),    GATEWAY_ERROR(false, 26000, &quot;æœåŠ¡ä¸èƒ½è®¿é—®&quot;),    CODE_ERROR(false, 28000, &quot;éªŒè¯ç é”™è¯¯&quot;),    LOGIN_PHONE_ERROR(false, 28009, &quot;æ‰‹æœºå·ç ä¸æ­£ç¡®&quot;),    LOGIN_MOBILE_ERROR(false, 28001, &quot;è´¦å·ä¸æ­£ç¡®&quot;),    LOGIN_PASSWORD_ERROR(false, 28008, &quot;å¯†ç ä¸æ­£ç¡®&quot;),    LOGIN_DISABLED_ERROR(false, 28002, &quot;è¯¥ç”¨æˆ·å·²è¢«ç¦ç”¨&quot;),    REGISTER_MOBLE_ERROR(false, 28003, &quot;æ‰‹æœºå·å·²è¢«æ³¨å†Œ&quot;),    LOGIN_AUTH(false, 28004, &quot;éœ€è¦ç™»å½•&quot;),    LOGIN_ACL(false, 28005, &quot;æ²¡æœ‰æƒé™&quot;),    SMS_SEND_ERROR(false, 28006, &quot;çŸ­ä¿¡å‘é€å¤±è´¥&quot;),    SMS_SEND_ERROR_BUSINESS_LIMIT_CONTROL(false, 28007, &quot;çŸ­ä¿¡å‘é€è¿‡äºé¢‘ç¹&quot;);    private Boolean success;    private Integer code;    private String message;    ResultCodeEnum(Boolean success, Integer code, String message) &#123;        this.success = success;        this.code = code;        this.message = message;    &#125;&#125;</code></pre><p>é‡åˆ°é—®é¢˜ï¼š<strong>pomæ–‡ä»¶å˜æ©˜çº¢</strong>ï¼šideaæ²¡æœ‰è¯†åˆ«ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å³é”®pom.xmlæ–‡ä»¶é€‰æ‹©Add as Maven Poject æ¥è§£å†³</p><p>â€‹                    <strong>pomæ–‡ä»¶å˜ç°</strong>ï¼šæ‰“å¼€settingï¼Œæœç´¢ignored<img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211112212242759.png" alt="image-20211112212242759"></p><h3><span id="å®šä¹‰å‰ç«¯æŸ¥è¯¢çš„å¯¹è±¡">å®šä¹‰å‰ç«¯æŸ¥è¯¢çš„å¯¹è±¡</span></h3><p>è®²å¸ˆï¼š</p><pre><code class="java">public class TeacherQueryVo implements Serializable &#123;    private static final long serialVersionUID = 1L;    @ApiModelProperty(value = &quot;è®²å¸ˆå§“å&quot;)    private String name;    @ApiModelProperty(value = &quot;è®²å¸ˆçº§åˆ«&quot;)    private Integer level;    @ApiModelProperty(value = &quot;å¼€å§‹æ—¶é—´&quot;)    private String joinDateBegin;    @ApiModelProperty(value = &quot;ç»“æŸæ—¶é—´&quot;)    private String joinDateEnd;&#125;</code></pre><p>å…³äºè®¾ç½®è‡ªåŠ¨å¡«å……ç±»</p><p>å¦‚æœæ²¡æœ‰è®¾ç½®çš„è¯ï¼Œsaveæ–¹æ³•å‰ç«¯ä»¥jsonå½¢å¼è¿”å›åå°æ•°æ®ä¸­æ²¡æœ‰åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´ï¼Œä½†æ˜¯æ•°æ®åº“ä¸­ä¸¤å­—æ®µä¸ºå¿…å¡«å­—æ®µï¼Œç¨‹åºå°±ä¼šæŠ¥é”™</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211113135408082.png" alt="image-20211113135408082"></p><p>æ‰€ä»¥å°±è¦è®¾ç½®è‡ªåŠ¨é…ç½®handlerç±»</p><pre><code class="Java">@Componentpublic class CommonMetaObjectHandler implements MetaObjectHandler &#123;    @Override    public void insertFill(MetaObject metaObject) &#123;        this.setFieldValByName(&quot;gmtCreate&quot;, new Date(), metaObject);        this.setFieldValByName(&quot;gmtModified&quot;, new Date(), metaObject);    &#125;    @Override    public void updateFill(MetaObject metaObject) &#123;        this.setFieldValByName(&quot;gmtModified&quot;, new Date(), metaObject);    &#125;&#125;</code></pre><h3><span id="å®šä¹‰ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨">å®šä¹‰ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨</span></h3><p>å› ä¸ºè¦è¿”å›å‰å°ï¼Œæ‰€ä»¥è¦ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå¹¶ä»¥jsonæ ¼å¼è¿”å›</p><pre><code class="Java">@ControllerAdvice@Slf4jpublic class GlobalExceptionHandler &#123;    @ExceptionHandler(Exception.class)    @ResponseBody    public R error(Exception e)&#123;//        e.printStackTrace();        log.error(ExceptionUtils.getMessage(e));        return R.error();    &#125;    @ExceptionHandler(BadSqlGrammarException.class)    @ResponseBody    public R error(BadSqlGrammarException e)&#123;        log.error(ExceptionUtils.getMessage(e));        return R.setResult(ResultCodeEnum.BAD_SQL_GRAMMAR);    &#125;    @ExceptionHandler(HttpMessageNotReadableException.class)    @ResponseBody    public R error(HttpMessageNotReadableException e)&#123;        log.error(ExceptionUtils.getMessage(e));        return R.setResult(ResultCodeEnum.JSON_PARSE_ERROR);    &#125;&#125;</code></pre><h2><span id="å‰ç«¯">å‰ç«¯</span></h2><p>vue axios</p><p>è·¨åŸŸé—®é¢˜ï¼š@crossOrigin</p><p>npm</p><p><strong>å®‰è£…ç”Ÿäº§ç¯å¢ƒä¾èµ–</strong>ï¼šnpm install â€“save-dev  ***</p><p>æˆ–è€… npm i -D ***</p><p>å®‰è£…å…¨å±€ä¾èµ–ï¼šnpm install â€“global ***</p><p>webpackè¿›è¡Œé¡¹ç›®æ‰“åŒ… ï¼Œåˆ›å»ºwebpack.config.jsæ–‡ä»¶ï¼š</p><pre><code class="js">const path = require(&quot;path&quot;) //Node.jså†…ç½®æ¨¡å—module.exports = &#123;    entry: &#39;./src/main.js&#39;, //é…ç½®å…¥å£æ–‡ä»¶    output: &#123;        path: path.resolve(__dirname, &#39;./dist&#39;), //è¾“å‡ºè·¯å¾„ï¼Œ__dirnameï¼šå½“å‰æ–‡ä»¶æ‰€åœ¨è·¯å¾„        filename: &#39;bundle.js&#39; //è¾“å‡ºæ–‡ä»¶    &#125;,    module: &#123;        rules: [              &#123;                  test: /\.css$/,    //æ‰“åŒ…è§„åˆ™åº”ç”¨åˆ°ä»¥cssç»“å°¾çš„æ–‡ä»¶ä¸Š                use: [&#39;style-loader&#39;, &#39;css-loader&#39;]            &#125;          ]      &#125;&#125;</code></pre><p>ç„¶åæ‰§è¡Œwebpack â€“mode=developmentå‘½ä»¤</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211116160418094.png" alt="image-20211116160418094"></p><p>webpackå‹ç¼©</p><p>æ‰§è¡Œwebpack â€“mode=productionå‘½ä»¤</p><p>ä¹‹åè¿™äº›å‘½ä»¤éƒ½ä¼šé›†æˆåœ¨è„šæœ¬é‡Œï¼Œç›´æ¥æ‰§è¡Œè„šæœ¬å°±å¯ä»¥äº†</p><p>webpackæ‰“åŒ…css</p><p>å®‰è£…ä¸¤ä¸ªä¾èµ–</p><pre><code class="js">&quot;devDependencies&quot;: &#123;  &quot;css-loader&quot;: &quot;^3.5.2&quot;,  &quot;style-loader&quot;: &quot;^1.1.3&quot;&#125;</code></pre><p>ç„¶ååœ¨webpak.config.jsæ–‡ä»¶ä¸­åŠ ä¸Šä»¥ä¸‹é…ç½®</p><pre><code class="js">module: &#123;        rules: [              &#123;                  test: /\.css$/,    //æ‰“åŒ…è§„åˆ™åº”ç”¨åˆ°ä»¥cssç»“å°¾çš„æ–‡ä»¶ä¸Š                use: [&#39;style-loader&#39;, &#39;css-loader&#39;]            &#125;          ]      &#125;</code></pre><p>é¡µé¢æ¸²æŸ“æµç¨‹ï¼šåˆ›å»ºè·¯ç”±â€“åˆ›å»ºAPIâ€“åˆ›å»ºé¡µé¢ç»„ä»¶</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211118111357610.png" alt="image-20211118111357610"></p><p>é‡åˆ°é—®é¢˜ï¼š<br>å›æ˜¾é¡µåˆ‡åˆ°æ–°å¢é¡µè¡¨å•æ²¡æœ‰æ›´æ–°ï¼Œä¸¤ä¸ªé¡µé¢é€šç”¨ä¸€ä¸ªè¡¨å•ï¼Œä¸¤ä¸ªé¡µé¢åˆ‡æ¢æ²¡æœ‰æ›´æ–°ï¼Œå› ä¸ºvueä¼šç»„ä»¶å¤ç”¨</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211118113144519.png" alt="image-20211118113144519"></p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211118113800410.png" alt="image-20211118113800410"></p><p>éœ€è¦åœ¨appmainä¸­è¿›è¡Œé…ç½®</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211118114000851.png" alt="image-20211118114000851"></p><pre><code class="vue">&lt;template&gt;  &lt;section class=&quot;app-main&quot;&gt;    &lt;transition name=&quot;fade-transform&quot; mode=&quot;out-in&quot;&gt;      &lt;!-- or name=&quot;fade&quot; --&gt;      &lt;!-- å¦‚æœä¸ºè·¯ç”±å‡ºå£å®šä¹‰ä¸€ä¸ªå”¯ä¸€keyå€¼ï¼Œé‚£ä¹ˆç»„ä»¶ä¼šè¢«å¼ºåˆ¶é‡æ–°æ¸²æŸ“ --&gt;      &lt;router-view :key=&quot;key&quot;/&gt;      &lt;!-- å¦‚æœè·¯ç”±æŒ‡å‘çš„é¡µé¢ç»„ä»¶æ˜¯åŒä¸€ä¸ªï¼Œé‚£ä¹ˆè·¯ç”±å‡ºå£æ˜¾ç¤ºçš„é¡µé¢ç»„ä»¶ä¸ä¼šé‡æ–°è¢«æ¸²æŸ“ --&gt;      &lt;!--      &lt;router-view/&gt;--&gt;    &lt;/transition&gt;  &lt;/section&gt;&lt;/template&gt;&lt;script&gt;export default &#123;  name: &#39;AppMain&#39;,  // è®¡ç®—å±æ€§  computed: &#123;    key() &#123;      return this.$route.name !== undefined ? this.$route.name + +new Date() : this.$route + +new Date()    &#125;  &#125;&#125;&lt;/script&gt;</code></pre><p>è®¡ç®—å±æ€§æ•ˆç‡å¾ˆé«˜</p><h2><span id="è‡ªå®šä¹‰å¼‚å¸¸">è‡ªå®šä¹‰å¼‚å¸¸</span></h2><p>æ›´ä¸ºçµæ´»</p><p>ä¸€èˆ¬æƒ…å†µä¸‹è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹éƒ½ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œç»§æ‰¿RuntimeException</p><h2><span id="æ³¨å†Œä¸­å¿ƒå’ŒæœåŠ¡å®¹é”™">æ³¨å†Œä¸­å¿ƒå’ŒæœåŠ¡å®¹é”™</span></h2><h3><span id="nacos">nacos</span></h3><p>ä½¿ç”¨å®ƒå……å½“æ³¨å†Œä¸­å¿ƒ</p><h3><span id="ä½¿ç”¨jmeteræµ‹è¯•å¹¶å‘">ä½¿ç”¨JMeteræµ‹è¯•å¹¶å‘</span></h3><p>æœåŠ¡ä¹‹é—´çš„é›ªå´©æ•ˆåº”</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211124224106908.png" alt="image-20211124224106908"></p><h3><span id="å®¹é”™æ–¹æ¡ˆ">å®¹é”™æ–¹æ¡ˆ</span></h3><p>éš”ç¦»ï¼Œè¶…æ—¶ï¼Œé™æµï¼Œç†”æ–­ï¼Œé™çº§        ç»å…¸å®¹é”™ç»„ä»¶ï¼šSpring Cloud Hystrixã€Sentinelã€‚</p><h4><span id="éš”ç¦»">éš”ç¦»</span></h4><p>çº¿ç¨‹æ± éš”ç¦»å’Œä¿¡å·é‡éš”ç¦»</p><h4><span id="è¶…æ—¶">è¶…æ—¶</span></h4><p>æ‰€æœ‰çš„æ¥å£è°ƒç”¨å¿…é¡»è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä¸è®¾ç½®è¶…æ—¶æ—¶é—´è¯·æ±‚æœ‰å¯èƒ½é™·å…¥é•¿æœŸç­‰å¾…ï¼Œç”šè‡³æœ‰å¯èƒ½å¯¼è‡´æ•´ä¸ªæœåŠ¡ä¸å¯ç”¨</p><h4><span id="é™æµ"><strong>é™æµ</strong></span></h4><p>é™æµå³æµé‡é™åˆ¶ï¼Œæˆ–è€…é«˜å¤§ä¸Šä¸€ç‚¹ï¼Œå«åšæµé‡æ•´å½¢ï¼Œé™æµçš„ç›®çš„æ˜¯åœ¨é‡åˆ°æµé‡é«˜å³°æœŸæˆ–è€…æµé‡çªå¢ï¼ˆæµé‡å°–åˆºï¼‰æ—¶ï¼ŒæŠŠæµé‡é€Ÿç‡é™åˆ¶åœ¨ç³»ç»Ÿæ‰€èƒ½æ¥å—çš„åˆç†èŒƒå›´ä¹‹å†…ï¼Œä¸è‡³äºè®©ç³»ç»Ÿè¢«é«˜æµé‡å‡»å®ã€‚é™æµå¯ä»¥ä¿è¯ç³»ç»Ÿåœ¨è°ƒç”¨é‡çŒ›å¢æ—¶çš„åŸºæœ¬å¯ç”¨æ€§ï¼Œç›®å‰æœ‰å‡ ç§å¸¸è§çš„é™æµæ–¹å¼ï¼š</p><p>1ï¼‰é€šè¿‡é™åˆ¶å•ä½æ—¶é—´æ®µå†…è°ƒç”¨é‡æ¥é™æµ</p><p>2ï¼‰é€šè¿‡é™åˆ¶ç³»ç»Ÿçš„å¹¶å‘è°ƒç”¨ç¨‹åº¦æ¥é™æµ</p><p>3ï¼‰ä½¿ç”¨æ¼æ¡¶ï¼ˆLeaky Bucketï¼‰ç®—æ³•æ¥è¿›è¡Œé™æµ</p><p>4ï¼‰ä½¿ç”¨ä»¤ç‰Œæ¡¶ï¼ˆToken Bucketï¼‰ç®—æ³•æ¥è¿›è¡Œé™æµ</p><h4><span id="ç†”æ–­">ç†”æ–­</span></h4><p>å½“ä¸‹æ¸¸æœåŠ¡å› è®¿é—®å‹åŠ›è¿‡å¤§è€Œå“åº”å˜æ…¢æˆ–å¤±è´¥ï¼Œä¸Šæ¸¸æœåŠ¡ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿæ•´ä½“å¯ç”¨æ€§ï¼Œå¯ä»¥æš‚æ—¶åˆ‡æ–­å¯¹ä¸‹æ¸¸æœåŠ¡çš„è°ƒç”¨ï¼Œè¿™ç§ç‰ºç‰²å±€éƒ¨ï¼Œä¿å…¨æ•´ä½“çš„æªæ–½å°±å«åšç†”æ–­</p><h4><span id="é™çº§">é™çº§</span></h4><p>ä¸ºæœåŠ¡æä¾›ä¸€ä¸ªæ‰˜åº•æ–¹æ¡ˆï¼Œä¸€æ—¦æœåŠ¡æ— æ³•æ­£å¸¸è°ƒç”¨ï¼Œå°±ä½¿ç”¨æ‰˜åº•æ–¹æ¡ˆ</p><h3><span id="sentinel">sentinel</span></h3><p>æ–°å¢æµæ§è§„åˆ™</p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211125222458818.png" alt="image-20211125222458818" style="zoom:150%;"><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211125222525377.png" alt="image-20211125222525377"></p><p>åœ¨swaagerä¸­å¿«é€Ÿç‚¹å‡»tryï¼Œä¸€ç§’è¶…è¿‡ä¸¤æ¬¡çš„è¯å°±ä¼šå‡ºç°ä¸‹é¢çš„æƒ…å†µ</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211125222651777.png" alt="image-20211125222651777"></p><p><strong>æµé‡æ§åˆ¶</strong></p><p><strong>ä¿è¯è‡ªå·±ä¸è¢«ä¸Šæ¸¸æœåŠ¡å‹å®</strong></p><p>æµé‡æ§åˆ¶åœ¨ç½‘ç»œä¼ è¾“ä¸­æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ¦‚å¿µï¼Œå®ƒç”¨äºè°ƒæ•´ç½‘ç»œåŒ…çš„å‘é€æ•°æ®ã€‚ç„¶è€Œï¼Œä»ç³»ç»Ÿç¨³å®šæ€§è§’åº¦è€ƒè™‘ï¼Œåœ¨å¤„ç†è¯·æ±‚çš„é€Ÿåº¦ä¸Šï¼Œä¹Ÿæœ‰éå¸¸å¤šçš„è®²ç©¶ã€‚ä»»æ„æ—¶é—´åˆ°æ¥çš„è¯·æ±‚å¾€å¾€æ˜¯éšæœºä¸å¯æ§çš„ï¼Œè€Œç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›æ˜¯æœ‰é™çš„ã€‚æˆ‘ä»¬éœ€è¦æ ¹æ®ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›å¯¹æµé‡è¿›è¡Œæ§åˆ¶ã€‚Sentinel ä½œä¸ºä¸€ä¸ªè°ƒé…å™¨ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æŠŠéšæœºçš„è¯·æ±‚è°ƒæ•´æˆåˆé€‚çš„å½¢çŠ¶ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯Sentinelå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚æ¥å¯¹ä¸åŒçš„è¯·æ±‚å®šä¹‰ä¸åŒçš„æ§åˆ¶ç­–ç•¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Nob25nYmFvemhvbmc=,size_16,color_FFFFFF,t_70#pic_center" alt="img"></p><p>Sentinel çš„è®¾è®¡ç†å¿µæ˜¯è®©æ‚¨è‡ªç”±é€‰æ‹©æ§åˆ¶çš„è§’åº¦ï¼Œå¹¶è¿›è¡Œçµæ´»ç»„åˆï¼Œä»è€Œè¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚ä¸»è¦çš„æ§åˆ¶æ–¹å‘å¦‚ä¸‹ï¼š</p><ul><li><p>èµ„æºçš„è°ƒç”¨å…³ç³»ï¼Œä¾‹å¦‚èµ„æºçš„è°ƒç”¨é“¾è·¯ï¼Œèµ„æºå’Œèµ„æºä¹‹é—´çš„å…³ç³»ï¼›</p></li><li><p>è¿è¡ŒæŒ‡æ ‡ï¼Œä¾‹å¦‚ QPSã€çº¿ç¨‹æ± ã€ç³»ç»Ÿè´Ÿè½½ç­‰ï¼›</p></li><li><p>æ§åˆ¶çš„æ•ˆæœï¼Œä¾‹å¦‚ç›´æ¥é™æµã€å†·å¯åŠ¨ã€æ’é˜Ÿç­‰ã€‚</p></li></ul><p><strong>ç†”æ–­é™çº§</strong></p><p><strong>ä¿è¯è‡ªå·±ä¸è¢«ä¸‹æ¸¸æœåŠ¡å‹å®</strong></p><p> ä»€ä¹ˆæ˜¯ç†”æ–­é™çº§<br> ç®€å•æ¥è¯´å°±æ˜¯è´Ÿè½½ä¿æŠ¤ï¼Œä¸è®©æœåŠ¡å™¨å› ä¸ºè¿‡å¤šçš„å¹¶å‘è€Œç˜«ç—ªã€‚é™¤äº†æµé‡æ§åˆ¶ä»¥å¤–ï¼Œé™ä½è°ƒç”¨é“¾è·¯ä¸­çš„ä¸ç¨³å®šèµ„æºä¹Ÿæ˜¯ Sentinel çš„ä½¿å‘½ä¹‹ä¸€ã€‚ç”±äºè°ƒç”¨å…³ç³»çš„å¤æ‚æ€§ï¼Œå¦‚æœè°ƒç”¨é“¾è·¯ä¸­çš„æŸä¸ªèµ„æºå‡ºç°äº†ä¸ç¨³å®šï¼Œæœ€ç»ˆä¼šå¯¼è‡´è¯·æ±‚å‘ç”Ÿå †ç§¯ã€‚è¿™ä¸ªé—®é¢˜å’Œ Hystrix é‡Œé¢æè¿°çš„é—®é¢˜æ˜¯ä¸€æ ·çš„ã€‚</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2Nob25nYmFvemhvbmc=,size_16,color_FFFFFF,t_70#pic_center-16378508600642" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>Sentinel å’Œ Hystrix çš„åŸåˆ™æ˜¯ä¸€è‡´çš„: å½“è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šï¼Œä¾‹å¦‚ï¼Œè¡¨ç°ä¸º timeoutï¼Œå¼‚å¸¸æ¯”ä¾‹å‡é«˜çš„æ—¶å€™ï¼Œåˆ™å¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œå¹¶è®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶å®ƒçš„èµ„æºï¼Œæœ€ç»ˆäº§ç”Ÿé›ªå´©çš„æ•ˆæœã€‚</p><p><strong>Sentinelç†”æ–­é™çº§è®¾è®¡ç†å¿µ</strong><br>åœ¨é™åˆ¶çš„æ‰‹æ®µä¸Šï¼ŒSentinel å’Œ Hystrix é‡‡å–äº†å®Œå…¨ä¸ä¸€æ ·çš„æ–¹æ³•ã€‚<br>Hystrix é€šè¿‡çº¿ç¨‹æ± çš„æ–¹å¼ï¼Œæ¥å¯¹ä¾èµ–(åœ¨æˆ‘ä»¬çš„æ¦‚å¿µä¸­å¯¹åº”èµ„æº)è¿›è¡Œäº†éš”ç¦»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯èµ„æºå’Œèµ„æºä¹‹é—´åšåˆ°äº†æœ€å½»åº•çš„éš”ç¦»ã€‚ç¼ºç‚¹æ˜¯é™¤äº†å¢åŠ äº†çº¿ç¨‹åˆ‡æ¢çš„æˆæœ¬ï¼Œè¿˜éœ€è¦é¢„å…ˆç»™å„ä¸ªèµ„æºåšçº¿ç¨‹æ± å¤§å°çš„åˆ†é…ã€‚<br>Sentinel å¯¹è¿™ä¸ªé—®é¢˜é‡‡å–äº†ä¸¤ç§æ‰‹æ®µ:</p><p>1.<strong>é€šè¿‡å¹¶å‘çº¿ç¨‹æ•°è¿›è¡Œé™åˆ¶</strong><br>å’Œèµ„æºæ± éš”ç¦»çš„æ–¹æ³•ä¸åŒï¼ŒSentinel é€šè¿‡é™åˆ¶èµ„æºå¹¶å‘çº¿ç¨‹çš„æ•°é‡ï¼Œæ¥å‡å°‘ä¸ç¨³å®šèµ„æºå¯¹å…¶å®ƒèµ„æºçš„å½±å“ã€‚è¿™æ ·ä¸ä½†æ²¡æœ‰çº¿ç¨‹åˆ‡æ¢çš„æŸè€—ï¼Œä¹Ÿä¸éœ€è¦æ‚¨é¢„å…ˆåˆ†é…çº¿ç¨‹æ± çš„å¤§å°ã€‚å½“æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçš„æƒ…å†µä¸‹ï¼Œä¾‹å¦‚å“åº”æ—¶é—´å˜é•¿ï¼Œå¯¹èµ„æºçš„ç›´æ¥å½±å“å°±æ˜¯ä¼šé€ æˆçº¿ç¨‹æ•°çš„é€æ­¥å †ç§¯ã€‚å½“çº¿ç¨‹æ•°åœ¨ç‰¹å®šèµ„æºä¸Šå †ç§¯åˆ°ä¸€å®šçš„æ•°é‡ä¹‹åï¼Œå¯¹è¯¥èµ„æºçš„æ–°è¯·æ±‚å°±ä¼šè¢«æ‹’ç»ã€‚å †ç§¯çš„çº¿ç¨‹å®Œæˆä»»åŠ¡åæ‰å¼€å§‹ç»§ç»­æ¥æ”¶è¯·æ±‚ã€‚</p><p>2.<strong>é€šè¿‡å“åº”æ—¶é—´å¯¹èµ„æºè¿›è¡Œé™çº§</strong><br>é™¤äº†å¯¹å¹¶å‘çº¿ç¨‹æ•°è¿›è¡Œæ§åˆ¶ä»¥å¤–ï¼ŒSentinel è¿˜å¯ä»¥é€šè¿‡å“åº”æ—¶é—´æ¥å¿«é€Ÿé™çº§ä¸ç¨³å®šçš„èµ„æºã€‚å½“ä¾èµ–çš„èµ„æºå‡ºç°å“åº”æ—¶é—´è¿‡é•¿åï¼Œæ‰€æœ‰å¯¹è¯¥èµ„æºçš„è®¿é—®éƒ½ä¼šè¢«ç›´æ¥æ‹’ç»ï¼Œç›´åˆ°è¿‡äº†æŒ‡å®šçš„æ—¶é—´çª—å£ä¹‹åæ‰é‡æ–°æ¢å¤ã€‚</p><p><strong>è´Ÿè½½ä¿æŠ¤</strong><br>Sentinel åŒæ—¶æä¾›ç³»ç»Ÿç»´åº¦çš„è‡ªé€‚åº”ä¿æŠ¤èƒ½åŠ›ã€‚é˜²æ­¢é›ªå´©ï¼Œæ˜¯ç³»ç»Ÿé˜²æŠ¤ä¸­é‡è¦çš„ä¸€ç¯ã€‚å½“ç³»ç»Ÿè´Ÿè½½è¾ƒé«˜çš„æ—¶å€™ï¼Œå¦‚æœè¿˜æŒç»­è®©è¯·æ±‚è¿›å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œæ— æ³•å“åº”ã€‚åœ¨é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œç½‘ç»œè´Ÿè½½å‡è¡¡ä¼šæŠŠæœ¬åº”è¿™å°æœºå™¨æ‰¿è½½çš„æµé‡è½¬å‘åˆ°å…¶å®ƒçš„æœºå™¨ä¸Šå»ã€‚å¦‚æœè¿™ä¸ªæ—¶å€™å…¶å®ƒçš„æœºå™¨ä¹Ÿå¤„åœ¨ä¸€ä¸ªè¾¹ç¼˜çŠ¶æ€çš„æ—¶å€™ï¼Œè¿™ä¸ªå¢åŠ çš„æµé‡å°±ä¼šå¯¼è‡´è¿™å°æœºå™¨ä¹Ÿå´©æºƒï¼Œæœ€åå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨ã€‚<br>é’ˆå¯¹è¿™ä¸ªæƒ…å†µï¼ŒSentinel æä¾›äº†å¯¹åº”çš„ä¿æŠ¤æœºåˆ¶ï¼Œè®©ç³»ç»Ÿçš„å…¥å£æµé‡å’Œç³»ç»Ÿçš„è´Ÿè½½è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ï¼Œä¿è¯ç³»ç»Ÿåœ¨èƒ½åŠ›èŒƒå›´ä¹‹å†…å¤„ç†æœ€å¤šçš„è¯·æ±‚ã€‚</p><h2><span id="é‡åˆ°é—®é¢˜">é‡åˆ°é—®é¢˜ï¼š</span></h2><p>é¡¹ç›®è¿›è¡Œæ‰“åŒ…æ—¶æ²¡æœ‰æŠŠxmlæ–‡ä»¶æ‰“åŒ…è¿›å»ï¼Œå¯¼è‡´è¿è¡Œsqlè¯­å¥æ—¶æŠ¥é”™</p><p>è§£å†³æ–¹æ¡ˆï¼š<br>pom.xmlæ–‡ä»¶ä¸­é…ç½®</p><pre><code class="xml">&lt;build&gt;    &lt;resources&gt;        &lt;resource&gt;            &lt;directory&gt;src/main/java&lt;/directory&gt;            &lt;includes&gt;                &lt;include&gt;**/*.xml&lt;/include&gt;            &lt;/includes&gt;            &lt;filtering&gt;false&lt;/filtering&gt;        &lt;/resource&gt;    &lt;/resources&gt;&lt;/build&gt;</code></pre><p>ç„¶åå†åœ¨application.ymlæ–‡ä»¶ä¸­é…ç½®ï¼š</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211127215103746.png" alt="image-20211127215103746"></p><p><strong>com.aliyun.oss.ClientException: UnknownHost</strong></p><p>æ²¡è”ç½‘ï¼ï¼ï¼ğŸ¤ğŸ¤ğŸ¤</p><h2><span id="æ•°æ®åº“ä¼˜åŒ–è¯¾ç¨‹ç®¡ç†">æ•°æ®åº“ä¼˜åŒ–ï¼ˆè¯¾ç¨‹ç®¡ç†ï¼‰</span></h2><p>çºµå‘æ‹†è¡¨</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211128195950279.png" alt="image-20211128195950279"></p><p>ç”±äºæœ‰ä¸€åˆ—é•¿æ–‡æœ¬å­—æ®µæ•°æ®è¿‡å¤šï¼Œå±•ç¤ºè¯¾ç¨‹åˆ—è¡¨æ—¶å¹¶ä¸éœ€è¦è¿™ç§åºæ‚ç¹å¤šçš„ä¿¡æ¯ï¼Œæ‰€ä»¥æ‹†è¡¨å¯ä¼˜åŒ–æ€§èƒ½ã€‚</p><p>å› ä¸ºedu_course_descriptionå’Œedu_courseä¸ºä¸€å¯¹ä¸€å…³ç³»ï¼Œæ‰€ä»¥edu_course_descriptionçš„ä¸»é”®ç”Ÿæˆç­–ç•¥åº”è¯¥è·Ÿéšedu_courseçš„ä¸»é”®ç”Ÿæˆç­–ç•¥ã€‚</p><pre><code class="Java">@ApiModelProperty(value = &quot;è®²å¸ˆID&quot;)@TableId(value = &quot;id&quot;, type = IdType.NONE)private String id;</code></pre><pre><code class="java">private BigDecimal price;</code></pre><p>ä½¿ç”¨bigdecimalå®šä¹‰ä»·æ ¼ï¼Œé¿å…ç²¾åº¦ä¸¢å¤±</p><p>å¿«é€Ÿèµ‹äºˆå€¼</p><pre><code class="Java">BeanUtils.copyProperties( ç»™äºˆ=&gt;courseInfoForm, æ¥å—=&gt;course);</code></pre><p>å‰æ®µè¯¾ç¨‹ç±»åˆ«</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211128212211788.png" alt="image-20211128212211788"></p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211128212227154.png" alt="image-20211128212227154"></p><p>å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹å¼åŠ è½½èµ„æº</p><p>ä¸€æ¬¡æ€§åŠ è½½ï¼ˆé€‚åˆæ•°æ®é‡ä¸å¤§ï¼‰</p><p>å»¶è¿ŸåŠ è½½ï¼ˆé€‚åˆæ•°æ®é‡å¤§ï¼Œç§»åŠ¨ç«¯è€ƒè™‘åˆ°æµé‡é—®é¢˜ï¼‰</p><h2><span id="å¤šè¡¨è”æŸ¥">å¤šè¡¨è”æŸ¥</span></h2><p>ä½¿ç”¨å¤–è”æŸ¥è¯¢ï¼Œå› ä¸ºä¸éœ€æŸ¥è¯¢å‡ºæ‰€æœ‰åˆ—</p><pre><code class="xml">&lt;sql id=&quot;columns&quot;&gt;    c.id,  c.title,  c.lesson_num AS lessonNum,  CONVERT(c.price, DECIMAL(8,2)) AS price,  c.cover,  c.buy_count AS buyCount,  c.view_count AS viewCount,  c.status,  c.gmt_create AS gmtCreate,  t.name AS teacherName,  s1.title AS subjectParentTitle,  s2.title AS subjectTitle&lt;/sql&gt;&lt;sql id=&quot;tables&quot;&gt;    edu_course c    LEFT JOIN edu_teacher t ON c.teacher_id = t.id    LEFT JOIN edu_subject s1 ON c.subject_parent_id = s1.id    LEFT JOIN edu_subject s2 ON c.subject_id = s2.id&lt;/sql&gt;&lt;select id=&quot;selectPageByCourseQueryVo&quot; resultType=&quot;com.atguigu.guli.service.edu.entity.vo.CourseVo&quot;&gt;    SELECT &lt;include refid=&quot;columns&quot; /&gt;    FROM &lt;include refid=&quot;tables&quot; /&gt;    $&#123;ew.customSqlSegment&#125; &lt;/select&gt;</code></pre><p>å½“æˆ‘ä»¬éœ€è¦æŠŠç»„è£…çš„querywapperä¼ åˆ°mapperè®©mybatisè‡ªåŠ¨æŸ¥è¯¢æ—¶</p><p>1.<img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211129204210637.png" alt="image-20211129204210637"></p><p>2.<img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211129204255198.png" alt="image-20211129204255198"></p><h4><span id="åˆ é™¤ä¸šåŠ¡">åˆ é™¤ä¸šåŠ¡ï¼š</span></h4><pre><code class="java"> æ•°æ®åº“ä¸­å¤–é”®çº¦æŸçš„è®¾ç½®ï¼š äº’è”ç½‘åˆ†å¸ƒå¼é¡¹ç›®ä¸­ä¸å…è®¸ä½¿ç”¨å¤–é”®ä¸çº§è”æ›´æ–°ï¼Œä¸€åˆ‡è®¾è®¡çº§è”çš„æ“ä½œä¸è¦ä¾èµ–æ•°æ®åº“å±‚ï¼Œè¦åœ¨ä¸šåŠ¡å±‚è§£å†³ &lt;p&gt; å¦‚æœä¸šåŠ¡å±‚è§£å†³çº§è”åˆ é™¤åŠŸèƒ½ é‚£ä¹ˆå…ˆåˆ é™¤å­è¡¨æ•°æ®ï¼Œå†åˆ é™¤çˆ¶è¡¨æ•°æ®</code></pre><h2><span id="ç« èŠ‚ç®¡ç†éƒ¨åˆ†">ç« èŠ‚ç®¡ç†éƒ¨åˆ†</span></h2><p>ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢å›æ˜¾åµŒå¥—åˆ—è¡¨</p><p>ä¼˜åŒ–sqlè¯­å¥</p><p>æ–¹æ¡ˆ1ä¸ºæ˜¾ç¤ºè¯¾ç¨‹åˆ†ç±»åˆ—è¡¨æ—¶ä½¿ç”¨çš„sqlæŸ¥è¯¢æ–¹æ³•ï¼ŒæŸ¥è¯¢æ•ˆç‡ä½</p><p>æ–¹æ¡ˆ2ä¸ºåœ¨ä¸šåŠ¡å±‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥sqlæŸ¥è¯¢ä¸¤æ¬¡å¾—å‡ºå…¨éƒ¨çš„æ•°æ®ç„¶ååœ¨è¿›è¡Œç»„è£… </p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/image-20211202142759148.png" alt="image-20211202142759148"></p><h2><span id="è§†é¢‘ä¸Šä¼ æœåŠ¡">è§†é¢‘ä¸Šä¼ æœåŠ¡</span></h2><p>æœ¬åœ°ä»“åº“å¯¼å…¥jaråŒ…</p><pre><code class="cmd">mvn install:install-file -DgroupId=com.aliyun -DartifactId=aliyun-sdk-vod-upload -Dversion=1.4.11 -Dpackaging=jar -Dfile=aliyun-java-vod-upload-1.4.11.jar</code></pre><h2><span id="å‰ç«¯æ¸²æŸ“å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“">å‰ç«¯æ¸²æŸ“å’ŒæœåŠ¡å™¨ç«¯æ¸²æŸ“</span></h2><h3><span id="1-ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“">1ã€ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“</span></h3><p>æœåŠ¡ç«¯æ¸²æŸ“åˆç§°SSR (Server Side Render)æ˜¯åœ¨æœåŠ¡ç«¯å®Œæˆé¡µé¢çš„å†…å®¹æ¸²æŸ“ï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·ç«¯å®Œæˆé¡µé¢å†…å®¹çš„æ¸²æŸ“ã€‚</p><p>SSRå¹¶ä¸æ˜¯å‰ç«¯ç‰¹æœ‰çš„æŠ€æœ¯ï¼Œæˆ‘ä»¬å­¦ä¹ è¿‡çš„JSPæŠ€æœ¯å’ŒThymeleafæŠ€æœ¯å°±æ˜¯å…¸å‹çš„SSR</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/a9b7b10a8fbfe2d36ee20f807a174a75.png" alt="img"></p><p>æœåŠ¡ç«¯æ¸²æŸ“çš„ç‰¹ç‚¹ï¼š</p><ul><li>åœ¨æœåŠ¡ç«¯ç”Ÿæˆhtmlç½‘é¡µçš„domå…ƒç´ </li><li>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰åªè´Ÿè´£æ˜¾ç¤ºdomå…ƒç´ å†…å®¹</li></ul><h3><span id="2-ä»€ä¹ˆæ˜¯å®¢æˆ·ç«¯æ¸²æŸ“">2ã€ä»€ä¹ˆæ˜¯å®¢æˆ·ç«¯æ¸²æŸ“</span></h3><p>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ ä½¿ç”¨AJAXå‘æœåŠ¡ç«¯å‘èµ·httpè¯· æ±‚ï¼Œè·å–åˆ°äº†æƒ³è¦çš„æ•°æ®ï¼Œå¼€å§‹æ¸²æŸ“htmlç½‘é¡µï¼Œç”Ÿæˆdomå…ƒç´ ï¼Œå¹¶æœ€ç»ˆå°†ç½‘é¡µå†…å®¹å±•ç¤ºç»™ç”¨æˆ·ã€‚</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/aa49e5a9caa4641002d5608cd5acd136.png" alt="img"></p><p>å®¢æˆ·ç«¯æ¸²æŸ“çš„ç‰¹ç‚¹ï¼š</p><ul><li>åœ¨æœåŠ¡ç«¯åªæ˜¯ç»™å®¢æˆ·ç«¯å“åº”çš„äº†æ•°æ®ï¼Œè€Œä¸æ˜¯htmlç½‘é¡µ</li><li>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰è´Ÿè´£è·å–æœåŠ¡ç«¯çš„æ•°æ®ç”Ÿæˆdomå…ƒç´ </li></ul><h2><span id="3-ä¸¤ç§æ–¹å¼å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹">3ã€ä¸¤ç§æ–¹å¼å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</span></h2><p><strong>å®¢æˆ·ç«¯æ¸²æŸ“ï¼š</strong> </p><ol><li><p>ç¼ºç‚¹ï¼šä¸åˆ©äºç½‘ç«™è¿›è¡ŒSEOï¼Œå› ä¸ºç½‘ç«™å¤§é‡ä½¿ç”¨javascriptæŠ€æœ¯ï¼Œä¸åˆ©äºæœç´¢å¼•æ“æŠ“å–ç½‘é¡µã€‚ </p></li><li><p>ä¼˜ç‚¹ï¼šå®¢æˆ·ç«¯è´Ÿè´£æ¸²æŸ“ï¼Œç”¨æˆ·ä½“éªŒæ€§å¥½ï¼ŒæœåŠ¡ç«¯åªæä¾›æ•°æ®ä¸ç”¨å…³å¿ƒç”¨æˆ·ç•Œé¢çš„å†…å®¹ï¼Œæœ‰åˆ©äºæé«˜æœåŠ¡ç«¯çš„å¼€å‘æ•ˆç‡ã€‚ </p></li><li><p>é€‚ç”¨åœºæ™¯ï¼šå¯¹SEOæ²¡æœ‰è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¯”å¦‚åå°ç®¡ç†ç±»çš„ç³»ç»Ÿï¼Œå¦‚ç”µå•†åå°ç®¡ç†ï¼Œç”¨æˆ·ç®¡ç†ç­‰ã€‚</p></li></ol><p> <strong>æœåŠ¡ç«¯æ¸²æŸ“ï¼š</strong> </p><ol><li><p>ä¼˜ç‚¹ï¼šæœ‰åˆ©äºSEOï¼Œç½‘ç«™é€šè¿‡hrefçš„urlå°†æœç´¢å¼•æ“ç›´æ¥å¼•åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æä¾›ä¼˜è´¨çš„ç½‘é¡µå†…å®¹ç»™æœç´¢å¼•æ“ã€‚</p></li><li><p>ç¼ºç‚¹ï¼šæœåŠ¡ç«¯å®Œæˆä¸€éƒ¨åˆ†å®¢æˆ·ç«¯çš„å·¥ä½œï¼Œé€šå¸¸å®Œæˆä¸€ä¸ªéœ€æ±‚éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„ä»£ç ï¼Œå¼€å‘æ•ˆç‡ä½ï¼Œä¸åˆ©äºç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</p></li><li><p>é€‚ç”¨åœºæ™¯ï¼šå¯¹SEOæœ‰è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¯”å¦‚ï¼šé—¨æˆ·é¦–é¡µã€å•†å“è¯¦æƒ…é¡µé¢ç­‰ã€‚</p></li></ol><p><a href="https://cloud.tencent.com/developer/article/1046667">æµ…æå‰ç«¯æ¸²æŸ“ä¸æœåŠ¡ç«¯æ¸²æŸ“ - äº‘+ç¤¾åŒº - è…¾è®¯äº‘ (tencent.com)</a></p><p>é‚£å°±éœ€è¦ä¸€ä¸ªç»„ä»¶æ¥æ—¢åˆ©äºseoï¼Œåˆåˆ©äºç”¨æˆ·ä½“éªŒ</p><h2><span id="nuxtjs">Nuxt.js</span></h2><p>åœ¨è¿™é‡ŒæŒ‡çš„æœåŠ¡å™¨ç«¯æ˜¯å‰ç«¯æœåŠ¡å™¨</p><p>Nuxt.js æ˜¯ä¸€ä¸ªåŸºäº Vue.js çš„è½»é‡çº§åº”ç”¨æ¡†æ¶,å¯ä»¥ç”¨æ¥åˆ›å»ºæœåŠ¡ç«¯æ¸²æŸ“ (SSR) åº”ç”¨ï¼Œä¹Ÿå¯å……å½“é™æ€ç«™ç‚¹å¼•æ“ç”Ÿæˆé™æ€ç«™ç‚¹åº”ç”¨,å…·æœ‰ä¼˜é›…çš„ä»£ç ç»“æ„åˆ†å±‚å’Œçƒ­åŠ è½½ç­‰ç‰¹æ€§</p><p>å…·ä½“ä»£ç å®ä¾‹ï¼š</p><pre><code class="vue">  // æœåŠ¡å™¨ç«¯æ¸²æŸ“æ–¹æ¡ˆï¼š  // å¼‚æ­¥æ•°æ®è·å–ï¼šåœ¨å‰ç«¯æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼Œçˆ¬è™«ç›´æ¥åœ¨é¡µé¢å°±å¯ä»¥çˆ¬åˆ°å…·ä½“å…³é”®å­—ä¿¡æ¯  asyncData() &#123;    return teacherApi.getList().then(response =&gt; &#123;      return &#123;        items: response.data.items      &#125;    &#125;)  &#125;// å®¢æˆ·ç«¯æ¸²æŸ“æ–¹æ¡ˆ//   data() &#123;//     return &#123;//       items: []//     &#125;//   &#125;,//   created() &#123;//     teacherApi.getList().then(response =&gt; &#123;//       this.items = response.data.items//     &#125;)//   &#125;</code></pre><h2><span id="å‰ç«¯urlç»„è£…å‚æ•°">å‰ç«¯urlç»„è£…å‚æ•°</span></h2><p>ä½¿ç”¨queryStringç»„ä»¶ç»„è£…</p><p><img src="/2021/11/11/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2%E9%A1%B9%E7%9B%AE%E5%8E%86%E7%A8%8B/Blog\source_posts\è°·ç²’å­¦é™¢é¡¹ç›®å†ç¨‹\image-20211206213423909.png" alt="image-20211206213423909"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;è°·ç²’å­¦é™¢é¡¹ç›®&quot;&gt;è°·ç²’å­¦é™¢é¡¹ç›®&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;æ­å»ºç¯å¢ƒ&quot;&gt;æ­å»ºç¯å¢ƒ&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;äº†è§£åˆ°éä¸šåŠ¡æµç¨‹å¼€å‘æ­£å¥½ç¬¦åˆæˆ‘ä¹‹å‰å½±åƒç³»ç»Ÿå¼€å‘çš„æŸäº›åŠŸèƒ½ï¼ŒåŸæ¥æ˜¯ä»¥è¿™ä¸ªåè¯æ¥è¿›è¡Œæ¦‚æ‹¬&lt;/p&gt;
&lt;h3&gt;&lt;span id=&quot;</summary>
      
    
    
    
    <category term="é¡¹ç›®å®æˆ˜" scheme="http://example.com/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/"/>
    
    
    <category term="è°·ç²’å­¦é™¢" scheme="http://example.com/tags/%E8%B0%B7%E7%B2%92%E5%AD%A6%E9%99%A2/"/>
    
  </entry>
  
  <entry>
    <title>æ¶ˆæ¯ä¸­é—´ä»¶</title>
    <link href="http://example.com/2021/11/08/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    <id>http://example.com/2021/11/08/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/</id>
    <published>2021-11-08T14:14:29.000Z</published>
    <updated>2021-11-09T04:44:08.292Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="åŸºäºæ¶ˆæ¯ä¸­é—´ä»¶çš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¶æ„">åŸºäºæ¶ˆæ¯ä¸­é—´ä»¶çš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¶æ„</span></h1><h2><span id="æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨çš„åœºæ™¯">æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨çš„åœºæ™¯</span></h2><p>1:è·¨ç³»ç»Ÿæ•°æ®ä¼ é€’<br>2:é«˜å¹¶å‘çš„æµé‡å‰Šå³°<br>3:æ•°æ®çš„åˆ†å‘å’Œå¼‚æ­¥å¤„ç†<br>4:å¤§æ•°æ®åˆ†æä¸ä¼ é€’<br>5:åˆ†å¸ƒå¼äº‹åŠ¡<br>æ¯”å¦‚ä½ æœ‰ä¸€ä¸ªæ•°æ®è¦è¿›è¡Œè¿ç§»æˆ–è€…è¯·æ±‚å¹¶å‘è¿‡å¤šçš„æ—¶å€™ï¼Œæ¯”å¦‚ä½ æœ‰10Wçš„å¹¶å‘è¯·æ±‚ä¸‹è®¢å•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›è®¢å•å…¥åº“ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè®¢å•è¯·æ±‚å †ç§¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè®©å®ƒç¨³å¥å¯é çš„å…¥åº“å’Œæ‰§è¡Œã€‚</p><h2><span id="å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶">å¸¸è§çš„æ¶ˆæ¯ä¸­é—´ä»¶</span></h2><p>ActiveMQã€RabbitMQã€Kafkaã€RocketMQç­‰ã€‚</p><p>MQæ¶ˆæ¯é˜Ÿåˆ—ï¼šè´Ÿè´£æ•°æ®çš„ä¼ æ¥å—ï¼Œå­˜å‚¨å’Œä¼ é€’ï¼Œæ‰€ä»¥æ€§èƒ½è¦è¿‡äºæ™®é€šæœåŠ¡å’ŒæŠ€æœ¯ã€‚</p><h2><span id="æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†">æ¶ˆæ¯ä¸­é—´ä»¶çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†</span></h2><p>1ï¼šæ¶ˆæ¯çš„åè®®<br>2ï¼šæ¶ˆæ¯çš„æŒä¹…åŒ–æœºåˆ¶<br>3ï¼šæ¶ˆæ¯çš„åˆ†å‘ç­–ç•¥<br>4ï¼šæ¶ˆæ¯çš„é«˜å¯ç”¨ï¼Œé«˜å¯é <br>5ï¼šæ¶ˆæ¯çš„å®¹é”™æœºåˆ¶</p><h2><span id="æ¶ˆæ¯é˜Ÿåˆ—åè®®">æ¶ˆæ¯é˜Ÿåˆ—åè®®</span></h2><p><strong>é¢è¯•é¢˜ï¼šä¸ºä»€ä¹ˆæ¶ˆæ¯ä¸­é—´ä»¶ä¸ç›´æ¥ä½¿ç”¨httpåè®®å‘¢ï¼Ÿ</strong><br>1: å› ä¸ºhttpè¯·æ±‚æŠ¥æ–‡å¤´å’Œå“åº”æŠ¥æ–‡å¤´æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒåŒ…å«äº†cookieï¼Œæ•°æ®çš„åŠ å¯†è§£å¯†ï¼ŒçŠ¶æ€ç ï¼Œå“åº”ç ç­‰é™„åŠ çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªæ¶ˆæ¯è€Œè¨€ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¹ˆå¤æ‚ï¼Œä¹Ÿæ²¡æœ‰è¿™ä¸ªå¿…è¦æ€§ï¼Œå®ƒå…¶å®å°±æ˜¯è´Ÿè´£æ•°æ®ä¼ é€’ï¼Œå­˜å‚¨ï¼Œåˆ†å‘å°±è¡Œï¼Œä¸€å®šè¦è¿½æ±‚çš„æ˜¯é«˜æ€§èƒ½ã€‚å°½é‡ç®€æ´ï¼Œå¿«é€Ÿã€‚<br>2:å¤§éƒ¨åˆ†æƒ…å†µä¸‹httpå¤§éƒ¨åˆ†éƒ½æ˜¯çŸ­é“¾æ¥ï¼Œåœ¨å®é™…çš„äº¤äº’è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚åˆ°å“åº”å¾ˆæœ‰å¯èƒ½ä¼šä¸­æ–­ï¼Œä¸­æ–­ä»¥åå°±ä¸ä¼šå°±è¡ŒæŒä¹…åŒ–ï¼Œå°±ä¼šé€ æˆè¯·æ±‚çš„ä¸¢å¤±ã€‚è¿™æ ·å°±ä¸åˆ©äºæ¶ˆæ¯ä¸­é—´ä»¶çš„ä¸šåŠ¡åœºæ™¯ï¼Œå› ä¸ºæ¶ˆæ¯ä¸­é—´ä»¶å¯èƒ½æ˜¯ä¸€ä¸ªé•¿æœŸçš„è·å–æ¶ˆæ¯çš„è¿‡ç¨‹ï¼Œå‡ºç°é—®é¢˜å’Œæ•…éšœè¦å¯¹æ•°æ®æˆ–æ¶ˆæ¯å°±è¡ŒæŒä¹…åŒ–ç­‰ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¿è¯æ¶ˆæ¯å’Œæ•°æ®çš„é«˜å¯é å’Œç¨³å¥çš„è¿è¡Œã€‚</p><h3><span id="å¸¸è§çš„æŒä¹…åŒ–æ–¹å¼">å¸¸è§çš„æŒä¹…åŒ–æ–¹å¼</span></h3><table><thead><tr><th></th><th>ActiveMQ</th><th>RabbitMQ</th><th><strong>Kafka</strong></th><th>RocketMQ</th></tr></thead><tbody><tr><td>æ–‡ä»¶å­˜å‚¨</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>æ•°æ®åº“</td><td>æ”¯æŒ</td><td>/</td><td>/</td><td>/</td></tr></tbody></table><h2><span id="æ¶ˆæ¯åˆ†å‘ç­–ç•¥çš„æœºåˆ¶å’Œå¯¹æ¯”">æ¶ˆæ¯åˆ†å‘ç­–ç•¥çš„æœºåˆ¶å’Œå¯¹æ¯”</span></h2><table><thead><tr><th></th><th>ActiveMQ</th><th>RabbitMQ</th><th>Kafka</th><th>RocketMQ</th></tr></thead><tbody><tr><td>å‘å¸ƒè®¢é˜…</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>è½®è¯¢åˆ†å‘</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>/</td></tr><tr><td>å…¬å¹³åˆ†å‘</td><td>/</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>/</td></tr><tr><td>é‡å‘</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>/</td><td>æ”¯æŒ</td></tr><tr><td>æ¶ˆæ¯æ‹‰å–</td><td>/</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;åŸºäºæ¶ˆæ¯ä¸­é—´ä»¶çš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¶æ„&quot;&gt;åŸºäºæ¶ˆæ¯ä¸­é—´ä»¶çš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¶æ„&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨çš„åœºæ™¯&quot;&gt;æ¶ˆæ¯ä¸­é—´ä»¶åº”ç”¨çš„åœºæ™¯&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;1:è·¨ç³»ç»Ÿæ•°æ®ä¼ é€’&lt;br&gt;2:é«˜å¹¶å‘çš„æµé‡å‰Šå³°&lt;br&gt;3:</summary>
      
    
    
    
    
    <category term="æ¶ˆæ¯ä¸­é—´ä»¶" scheme="http://example.com/tags/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>Redis</title>
    <link href="http://example.com/2021/11/04/Redis/"/>
    <id>http://example.com/2021/11/04/Redis/</id>
    <published>2021-11-04T03:37:46.000Z</published>
    <updated>2021-11-08T06:24:16.082Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="redis">Redis</span></h1><p><img src="/2021/11/04/Redis/image-20211104130443874.png" alt="image-20211104130443874"></p><p>å› ä¸ºæ²¡æœ‰æŒ‡å®šé…ç½®æ–‡ä»¶</p><p>éœ€é…ç½®</p><pre><code>redis-server redis.windows.conf</code></pre><p>ä¹‹åè‡ªåŠ¨å¯åŠ¨</p><h2><span id="æµ‹è¯•æ€§èƒ½"><strong>æµ‹è¯•æ€§èƒ½</strong></span></h2><pre><code class="bash">redis-benchmark -p 6379 -c 100 -n 10000</code></pre><p><img src="/2021/11/04/Redis/image-20211104140217226.png" alt="image-20211104140217226"></p><p><img src="/2021/11/04/Redis/image-20211104140647780.png" alt="image-20211104140647780"></p><h2><span id="åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µï¼š</span></h2><p><img src="/2021/11/04/Redis/image-20211104141011197.png" alt="image-20211104141011197"></p><p><img src="/2021/11/04/Redis/image-20211104141230255.png" alt="image-20211104141230255"></p><p>æ¸…ç©ºå½“å‰æ•°æ®åº“ï¼šflushdb</p><p>æ¸…ç©ºå…¨éƒ¨æ•°æ®åº“ï¼šflushall</p><blockquote><p>redisæ˜¯å•çº¿ç¨‹çš„</p></blockquote><p>redisçš„ç“¶é¢ˆæ˜¯æœºå™¨çš„å†…å­˜å’Œç½‘ç»œçš„å¸¦å®½ï¼Œç”¨å•çº¿ç¨‹æ—¢ç„¶å¯ä»¥å®ç°ï¼Œå°±ç”¨å•çº¿ç¨‹äº†</p><blockquote><p>ä¸ºä»€ä¹ˆå•çº¿ç¨‹è¿˜è¿™ä¹ˆå¿«å‘¢</p></blockquote><p>redisæ˜¯å°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥è¯´ç”¨å•çº¿ç¨‹æ“ä½œæ•ˆç‡æœ€é«˜ï¼Œå¤šçº¿ç¨‹ï¼ˆcpuä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼šè€—æ—¶çš„æ“ä½œï¼‰ï¼Œå¯¹äºå†…å­˜ç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢æ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼å¤šæ¬¡è¯»å†™éƒ½æ˜¯åœ¨ä¸€ä¸ªcpuä¸Šï¼Œåœ¨å†…å­˜æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå°±æ˜¯æœ€ä½³çš„é€‰æ‹©ã€‚</p><h1><span id="äº”å¤§æ•°æ®ç±»å‹">äº”å¤§æ•°æ®ç±»å‹</span></h1><h3><span id="redis-key">redis-key</span></h3><pre><code class="bash">#ç§»é™¤name keymove name 1</code></pre><p><img src="/2021/11/04/Redis/image-20211104143325041.png" alt="image-20211104143325041"></p><pre><code class="bash">#è®¾ç½®è¿‡æœŸæ—¶é—´expire name 10 </code></pre><p><img src="/2021/11/04/Redis/image-20211104143636111.png" alt="image-20211104143636111"></p><p>æŸ¥çœ‹å‰©ä½™è¿‡æœŸæ—¶é—´ï¼šttl name;</p><pre><code class="bash">#æŸ¥çœ‹é”®çš„ç±»å‹type name</code></pre><p><img src="/2021/11/04/Redis/image-20211104143922548.png" alt="image-20211104143922548"></p><h3><span id="string">String</span></h3><p><img src="/2021/11/04/Redis/image-20211104144412464.png" alt="image-20211104144412464"></p><p>å¦‚æœappendåçš„é”®ä¸å­˜åœ¨å°±åˆ›å»ºä¸€ä¸ªï¼Œç›¸å½“äºset</p><p><img src="/2021/11/04/Redis/image-20211104145142401.png" alt="image-20211104145142401"></p><blockquote><p>è·å–ä¸€éƒ¨åˆ†å€¼</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104145422840.png" alt="image-20211104145422840"></p><blockquote><p>è·å–å…¨éƒ¨çš„å€¼ </p></blockquote><p><img src="/2021/11/04/Redis/image-20211104145501629.png" alt="image-20211104145501629"></p><blockquote><p>æ›¿æ¢å€¼</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104145749240.png" alt="image-20211104145749240"></p><blockquote><p>setex è®¾ç½®è¿‡æœŸæ—¶é—´</p><p>setnx å¦‚æœæ²¡æœ‰è¿™ä¸ªé”®å°±è®¾ç½®å€¼æˆåŠŸï¼Œå¦‚æœå·²å­˜åœ¨è¿™ä¸ªé”®å°±è®¾ç½®ä¸æˆåŠŸï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­å¸¸åº”ç”¨ ï¼‰</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104150144398.png" alt="image-20211104150144398"></p><blockquote><p>æ‰¹é‡è®¾ç½®é”®å’Œå€¼ï¼Œæ‰¹é‡è·å–å€¼</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104150700175.png" alt="image-20211104150700175"></p><blockquote><p>msetnx å…·æœ‰åŸå­æ€§</p></blockquote><p>è®¾ç½®å¯¹è±¡ï¼Œä»¥jsonå­—ç¬¦ä¸²çš„å½¢å¼</p><p><img src="/2021/11/04/Redis/image-20211104151319002.png" alt="image-20211104151319002"></p><blockquote><p>getset</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104151448797.png" alt="image-20211104151448797"></p><h3><span id="list">List</span></h3><p>åœ¨redisä¸­ï¼Œlistå¯ä»¥è¢«æˆ‘ä»¬ç©æˆæ ˆï¼Œé˜Ÿåˆ—ï¼Œé˜»å¡é˜Ÿåˆ—</p><blockquote><p>lpush æ”¾è¿›åˆ—è¡¨æ•°æ®</p><p>lrange å–å‡ºæŒ‡å®šä½ç½®çš„æ•°æ®ï¼Œå¯ä»¥çœ‹å‡ºä¸‹æ ‡æ˜¯å€’ç€æ¥çš„ã€‚</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104152112654.png" alt="image-20211104152112654"></p><p>è¯´æ˜rpushæŠŠå€¼æ”¾åœ¨äº†é˜Ÿåˆ—çš„æœ€åé¢</p><p><img src="/2021/11/04/Redis/image-20211104152548954.png" alt="image-20211104152548954"></p><blockquote><p>ä»åˆ—è¡¨ä¸­ç§»é™¤å€¼ï¼Œå¯ä»¥åˆ†ä¸ºç§»é™¤å·¦è¾¹çš„å’Œå³è¾¹çš„</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104153013118.png" alt="image-20211104153013118"></p><blockquote><p>é€šè¿‡ä¸‹æ ‡è·å–å€¼</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104153153183.png" alt="image-20211104153153183"></p><blockquote><p>è·å–åˆ—è¡¨é•¿åº¦</p></blockquote><p>llen</p><blockquote><p>ç§»é™¤æŒ‡å®šçš„å€¼,å¯æŒ‡å®šæ•°é‡</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104153655790.png" alt="image-20211104153655790"></p><blockquote><p>é€šè¿‡ä¸‹æ ‡æˆªå–æŒ‡å®šçš„é•¿åº¦</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104154058106.png" alt="image-20211104154058106"></p><blockquote><p>ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°åˆ—è¡¨ä¸­</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104154308321.png" alt="image-20211104154308321"></p><blockquote><p>æ›´æ–°æŒ‡å®šä½ç½®çš„å€¼</p></blockquote><p><img src="/2021/11/04/Redis/image-20211104154722495.png" alt="image-20211104154722495"></p><p><img src="/2021/11/04/Redis/image-20211104155347613.png" alt="image-20211104155347613"></p><h3><span id="set">set</span></h3><p><img src="/2021/11/04/Redis/image-20211104155948255.png" alt="image-20211104155948255"></p><p><img src="/2021/11/04/Redis/image-20211104160159057.png" alt="image-20211104160159057"></p><p><img src="/2021/11/04/Redis/image-20211104160308656.png" alt="image-20211104160308656"></p><p><img src="/2021/11/04/Redis/image-20211104160609153.png" alt="image-20211104160500757"></p><p><img src="/2021/11/04/Redis/image-20211104161114018.png" alt="image-20211104161114018"></p><h3><span id="hash">hash</span></h3><p>Mapé›†åˆï¼Œkey-mapï¼Œé‚£æ—¶å€™è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªmapé›†åˆï¼Œæœ¬è´¨å’ŒStringç±»å‹æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œè¿˜æ˜¯ä¸€ä¸ªç®€å•çš„key-vlaue</p><p><img src="/2021/11/04/Redis/image-20211104162116587.png" alt="image-20211104162116587"></p><p>è·å–hashè¡¨çš„å†…å®¹é•¿åº¦</p><p><img src="/2021/11/04/Redis/image-20211104162829439.png" alt="image-20211104162829439"></p><p>è·å–æ‰€æœ‰çš„fieldå’Œæ‰€æœ‰çš„å€¼</p><p><img src="/2021/11/04/Redis/image-20211104163226493.png" alt="image-20211104163226493"></p><p>hashæ›´é€‚åˆäºå¯¹è±¡çš„å­˜å‚¨</p><h3><span id="zsetæœ‰åºé›†åˆ">Zsetï¼ˆæœ‰åºé›†åˆï¼‰</span></h3><p><strong>æ’åˆ—</strong></p><p><img src="/2021/11/04/Redis/image-20211104170955039.png" alt="image-20211104170955039"></p><p>æ˜¾ç¤ºå·¥èµ„å°äº2000çš„å·¥èµ„æ’åˆ—</p><p><img src="/2021/11/04/Redis/image-20211104171308530.png" alt="image-20211104171308530"></p><p>ç§»é™¤æŒ‡å®šå…ƒç´ </p><p><img src="/2021/11/04/Redis/image-20211104172219379.png" alt="image-20211104172219379"></p><p>è·å–é›†åˆä¸­çš„ä¸ªæ•°</p><pre><code class="bash">zcard salary</code></pre><p>è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡</p><p><img src="/2021/11/04/Redis/image-20211104173454977.png" alt="image-20211104173454977"></p><p>æ€»ç»“ï¼š</p><p><img src="/2021/11/04/Redis/image-20211104175033465.png" alt="image-20211104175033465"></p><h1><span id="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹">ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</span></h1><h2><span id="geospatialåœ°ç†ä½ç½®">Geospatial(åœ°ç†ä½ç½®)</span></h2><blockquote><p>geoadd æ·»åŠ åœ°ç†ä½ç½®</p></blockquote><pre><code class="bash">geoadd key longitude latitude member [longitude latitude member ...]</code></pre><blockquote><p>geoposè·å¾—åœ°ç†ä½ç½®è¯¦ç»†ä¿¡æ¯</p></blockquote><pre><code class="bash">geopos key member [member ...]</code></pre><blockquote><p>geodistè·å¾—ä¸¤ä¸ªåœ°ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå¯åœ¨åé¢è¿½åŠ è·å¾—ç»“æœçš„å•ä½ km m</p></blockquote><pre><code class="bash">geodist key member1 member2 [unit]</code></pre><blockquote><p>georadiusè·å¾—ä»¥æŸä¸€ç‚¹ç»çº¬åº¦ä¸ºåœ†å¿ƒï¼Œä¸€å®šè·ç¦»ä¸ºåŠå¾„ä¹‹å†…çš„å…ƒç´ </p></blockquote><pre><code class="bash">georadius key longitude latitude radius m|km|ft|mi [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC</code></pre><blockquote><p>georadiusbymemberè·å¾—æŸä¸€æˆå‘˜ä¸ºåœ†å¿ƒï¼Œä¸€å®šè·ç¦»ä¸ºåŠå¾„ä¹‹å†…çš„å…ƒç´ </p></blockquote><blockquote><p>geoåº•å±‚çš„å®ç°åŸç†æ˜¯zsetï¼Œå¯ä»¥ä½¿ç”¨zsetå‘½ä»¤æ¥æ“ä½œgeo</p></blockquote><h2><span id="hyperloglog">hyperloglog</span></h2><p>ç»Ÿè®¡åŸºæ•°</p><p>å¯ä»¥ç”¨ä½œç½‘ç«™çš„UVï¼ˆä¸€ä¸ªäººè®¿é—®ç½‘ç«™å¤šæ¬¡ï¼Œä½†æ˜¯è¿˜æ˜¯ç®—ä½œä¸€ä¸ªäººï¼‰</p><p>ä¼ ç»Ÿçš„æ–¹å¼æ˜¯ç”¨setï¼Œå¦‚æœå­˜å‚¨é‡å¤ªå¤§çš„è¯å°±æ¯”è¾ƒéº»çƒ¦</p><blockquote><p>æµ‹è¯•</p></blockquote><p><img src="/2021/11/04/Redis/image-20211105221008371.png" alt="image-20211105221008371"></p><h2><span id="bitmaps">bitmaps</span></h2><blockquote><p>ä½å­˜å‚¨</p></blockquote><p>ä½å›¾ï¼Œæ˜¯æ•°æ®ç»“æ„ï¼Œéƒ½æ˜¯æ“ä½œäºŒè¿›åˆ¶ä¸ºæ¥è¿›è¡Œæ“ä½œï¼Œåªæœ‰0å’Œ1ä¸¤ä¸ªçŠ¶æ€</p><p>ç»Ÿè®¡ä¸€å‘¨çš„æ‰“å¡æƒ…å†µ</p><p><img src="/2021/11/04/Redis/image-20211105221855488.png" alt="image-20211105221855488"></p><p>æŸ¥çœ‹æŸä¸€å¤©çš„æ‰“å¡æƒ…å†µ</p><p><img src="/2021/11/04/Redis/image-20211105222028892.png" alt="image-20211105222028892"></p><p>æŸ¥çœ‹æ‰“å¡äº†å‡ å¤©</p><pre><code class="bash">127.0.0.1:6379&gt; bitcount si(integer) 2</code></pre><h1><span id="äº‹åŠ¡">äº‹åŠ¡</span></h1><p>æœ¬è´¨ï¼šä¸€ç»„å‘½ä»¤çš„é›†åˆï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§é¡ºåºæ‰§è¡Œ</p><p><strong>rediså•æŒ‘å‘½ä»¤ä¿å­˜åŸå­æ€§ï¼Œä½†æ˜¯äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ï¼Œæ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</strong></p><p>æ‰€æœ‰å‘½ä»¤åœ¨äº‹åŠ¡ä¸­ï¼Œå¹¶ä¸è¢«ç›´æ¥æ‰§è¡Œï¼Œåªæœ‰å‘èµ·æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ‰è¢«æ‰§è¡Œ</p><ol><li>å¼€å¯äº‹åŠ¡</li><li>å‘½ä»¤å…¥é˜Ÿ</li><li>æ‰§è¡Œäº‹åŠ¡</li></ol><blockquote><p>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</p></blockquote><pre><code class="bash">127.0.0.1:6379&gt; multi #å¼€å¯äº‹åŠ¡OK127.0.0.1:6379&gt; set k1 v1QUEUED127.0.0.1:6379&gt; set k2 v2QUEUED127.0.0.1:6379&gt; get k2QUEUED127.0.0.1:6379&gt; set k3 v3QUEUED127.0.0.1:6379&gt; exec#æ‰§è¡Œäº‹åŠ¡1) OK2) OK3) &quot;v2&quot;4) OK127.0.0.1:6379&gt;</code></pre><blockquote><p>æ”¾å¼ƒäº‹åŠ¡</p></blockquote><p>discard</p><blockquote><p>ç¼–è¯‘å‹å¼‚å¸¸ï¼ˆä»£ç æœ‰é—®é¢˜ï¼‰ï¼Œäº‹åŠ¡ä¸­æ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œ</p><pre><code class="bash">127.0.0.1:6379&gt; get k1(nil)127.0.0.1:6379&gt; multiOK127.0.0.1:6379&gt; set k1 v1QUEUED127.0.0.1:6379&gt; set k2 v2QUEUED127.0.0.1:6379&gt; getset k3(error) ERR wrong number of arguments for &#39;getset&#39; command127.0.0.1:6379&gt; get k1QUEUED127.0.0.1:6379&gt; exec(error) EXECABORT Transaction discarded because of previous errors.#æ‰€æœ‰äº‹åŠ¡ä¸ä¼šè¢«è¿è¡Œ127.0.0.1:6379&gt;</code></pre></blockquote><blockquote><p>è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆ1/0ï¼‰ï¼Œå…¶ä»–å‘½ä»¤æ­£å¸¸æ‰§è¡Œï¼Œé”™è¯¯å‘½ä»¤æŠ›å‡ºå¼‚å¸¸ </p></blockquote><pre><code class="bash">127.0.0.1:6379&gt; multiOK127.0.0.1:6379&gt; incr k1#å­—ç¬¦ä¸²ä¸ä¼šåŠ 1QUEUED127.0.0.1:6379&gt; get k1QUEUED127.0.0.1:6379&gt; exec1) (error) ERR value is not an integer or out of range#å±äºè¿è¡Œæ—¶å¼‚å¸¸2) &quot;v1&quot; #æ­£å¸¸æ‰§è¡Œ127.0.0.1:6379&gt;</code></pre><h2><span id="ç›‘æ§">ç›‘æ§</span></h2><h4><span id="ä¹è§‚é”">ä¹è§‚é”</span></h4><p>è·å–versionï¼Œæ¯”è¾ƒversion</p><blockquote><p>ç›‘è§†ï¼š</p></blockquote><p>watch key [key â€¦]</p><p>æ‰§è¡Œä¹‹å‰ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¦‚æœä¿®æ”¹äº†æˆ‘ä»¬çš„å€¼ï¼Œäº‹åŠ¡å°±ä¼šæ‰§è¡Œå¤±è´¥ï¼Œå°±è¦æ”¾å¼ƒç›‘è§†ï¼Œç„¶åé‡æ–°ç›‘è§†</p><blockquote><p>æ”¾å¼ƒç›‘è§†</p></blockquote><p>unwatch key</p><h1><span id></span></h1><h1><span id="jedis">Jedis</span></h1><p>é…ç½®ä¾èµ–</p><pre><code class="xml">&lt;dependencies&gt;        &lt;dependency&gt;            &lt;groupId&gt;redis.clients&lt;/groupId&gt;            &lt;artifactId&gt;jedis&lt;/artifactId&gt;            &lt;version&gt;3.2.0&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;            &lt;version&gt;1.2.62&lt;/version&gt;        &lt;/dependency&gt;          &lt;/dependencies&gt;</code></pre><p>åˆ›å»ºè¿æ¥è¿›è¡Œæµ‹è¯•</p><pre><code class="java">Jedis jedis=new Jedis(&quot;127.0.0.1&quot;, 6379);System.out.println(jedis.ping());</code></pre><h1><span id="springbootæ•´åˆ">springbootæ•´åˆ</span></h1><p>åº•å±‚ä¸ºlettuceï¼šé‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±äº«ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼ŒNIOæ¨¡å¼ </p><p>jeidsé‡‡ç”¨ç›´è¿ï¼Œå¤šçº¿ç¨‹ä¸å®‰å…¨ï¼Œå¦‚æƒ³é¿å…ä¸å®‰å…¨ï¼Œå°±ä½¿ç”¨jedis poolè¿æ¥æ± ,BIOæ¨¡å¼</p><p>æ“ä½œå„ç§åŸºæœ¬ç±»å‹</p><p><img src="/2021/11/04/Redis/image-20211106154640957.png" alt="image-20211106154640957"></p><p>è·å¾—é“¾æ¥ï¼Œæ“ä½œæ•°æ®åº“</p><p><img src="/2021/11/04/Redis/image-20211106154840090.png" alt="image-20211106154840090"></p><h2><span id="åºåˆ—åŒ–">åºåˆ—åŒ–</span></h2><p>æ”¾å…¥å¯¹è±¡éœ€åºåˆ—åŒ–</p><pre><code class="java">@Configurationpublic class RedisConfig &#123;    //ç¼–å†™è‡ªå·±çš„redisTemplate    @Bean    @SuppressWarnings(&quot;all&quot;)    public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory redisConnectionFactory)throws UnknownHostException &#123;        RedisTemplate&lt;String,Object&gt; redisTemplate=new RedisTemplate&lt;&gt;();        redisTemplate.setConnectionFactory(redisConnectionFactory);        //Jsonåºåˆ—åŒ–é…ç½®        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer=new Jackson2JsonRedisSerializer(Object.class);        ObjectMapper objectMapper=new ObjectMapper();        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);        //Stringçš„åºåˆ—åŒ–        StringRedisSerializer stringRedisSerializer=new StringRedisSerializer();        //keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼        redisTemplate.setKeySerializer(stringRedisSerializer);        //Hashçš„åºåˆ—åŒ–æ–¹å¼ä¹Ÿé‡‡ç”¨Stringçš„æ–¹å¼        redisTemplate.setHashKeySerializer(stringRedisSerializer);        //valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer);        redisTemplate.afterPropertiesSet();        return redisTemplate;    &#125;&#125;</code></pre><p>â€”â€”â€”â€”â€”â€”â€”â€“å›ºå®šé…ç½®æ¨¡æ¿</p><h1><span id="redisconfè¯¦è§£">Redis.confè¯¦è§£</span></h1><p><img src="/2021/11/04/Redis/image-20211106221030918.png" alt="image-20211106221030918"></p><p>å¯¹å¤§å°å†™ä¸æ•æ„Ÿ</p><blockquote><p>åŒ…å«</p><p><img src="/2021/11/04/Redis/image-20211106221148896.png" alt="image-20211106221148896"></p><p>å¯åŒ…å«å¤šä¸ªé…ç½®æ–‡ä»¶</p></blockquote><blockquote><p>ç½‘ç»œ</p></blockquote><pre><code class="bash">bind 127.0.0.1protected-mode yes #ä¿æŠ¤æ¨¡å¼port 6379 #é»˜è®¤ç«¯å£</code></pre><p>ç»‘å®šçš„IP</p><blockquote><p>é€šç”¨</p></blockquote><pre><code class="bash"># NOT SUPPORTED ON WINDOWS daemonize no #windowç«¯ä¸æ”¯æŒæ­¤é…ç½®ï¼Œé…ç½®æ­¤é¡¹é¡»åœ¨linuxç«¯daemonize yes #ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œé»˜è®¤æ˜¯noï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å¼€å¯ä¸ºyes# NOT SUPPORTED ON WINDOWS pidfile /var/run/redis.pid#å¦‚æœæŒ‡å®šä¸ºåå°æ–¹å¼è¿è¡Œï¼Œåˆ™éœ€æŒ‡å®špidæ–‡ä»¶pidfile /var/run/redis.pid#æ—¥å¿—çº§åˆ«# debug (a lot of information, useful for development/testing)# verbose (many rarely useful info, but not a mess like the debug level)# notice (moderately verbose, what you want in production probably)# warning (only very important / critical messages are logged)loglevel noticelogfile &quot;&quot; #æ—¥å¿—æ–‡ä»¶ä½ç½®databases 16 #é»˜è®¤æ•°æ®åº“æ•°é‡</code></pre><blockquote><p>å¿«ç…§</p></blockquote><p>æŒä¹…åŒ–ï¼šåœ¨è§„å®šæ—¶é—´å†…ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡æ“ä½œåˆ™ä¼šæŒä¹…åŒ–åˆ°æ–‡ä»¶.rdb .aof</p><p>reidsæ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æ–­ç”µå³å¤±ã€‚</p><pre><code class="bash">save 900 1 #å¦‚æœ900så†…ï¼Œæœ‰ä¸€ä¸ªkeyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å°†è¿›è¡ŒæŒä¹…åŒ–æ“ä½œã€‚ä»¥ä¸‹çš†åŒsave 300 10save 60 10000stop-writes-on-bgsave-error yes#æŒä¹…åŒ–å‡ºé”™ï¼Œredisæ˜¯å¦è¿˜ç»§ç»­å·¥ä½œrdbcompression yes#æ˜¯å¦å‹ç¼©rdbæ–‡ä»¶rdbchecksum yes #ä¿å­˜rdbæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿›è¡Œé”™è¯¯çš„æ£€æŸ¥æ ¡éªŒdir ./ #rdbæ–‡ä»¶çš„ä¿å­˜ç›®å½•</code></pre><blockquote><p>å®‰å…¨</p></blockquote><pre><code class="bash">127.0.0.1:6379&gt; pingPONG127.0.0.1:6379&gt; config set requirepass 1234 #è®¾ç½®å¯†ç OK127.0.0.1:6379&gt; config get requirepass(error) NOAUTH Authentication required.127.0.0.1:6379&gt; auth 1234 #ç™»å½•OK127.0.0.1:6379&gt; config get requirepass1) &quot;requirepass&quot;2) &quot;1234&quot;127.0.0.1:6379&gt;</code></pre><p><img src="/2021/11/04/Redis/image-20211107174514097.png" alt="image-20211107174514097"></p><blockquote><p>å®¢æˆ·ç«¯è¿æ¥ç›¸å…³</p></blockquote><pre><code class="bash"># maxclients 10000a æœ€å¤§å®¢æˆ·ç«¯æ•°é‡# maxmemory &lt;bytes&gt; æœ€å¤§å†…å­˜é™åˆ¶# maxmemory-policy noeviction å†…å­˜åˆ°è¾¾æé™å€¼çš„å¤„ç†ç­–ç•¥</code></pre><h4><span id="maxmemory-policy-å…­ç§æ–¹å¼"><strong>maxmemory-policy å…­ç§æ–¹å¼</strong></span></h4><p><strong>1ã€volatile-lruï¼š</strong>åªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¿›è¡ŒLRUï¼ˆé»˜è®¤å€¼ï¼‰</p><p><strong>2ã€allkeys-lru ï¼š</strong> åˆ é™¤lruç®—æ³•çš„key</p><p><strong>3ã€volatile-randomï¼š</strong>éšæœºåˆ é™¤å³å°†è¿‡æœŸkey</p><p><strong>4ã€allkeys-randomï¼š</strong>éšæœºåˆ é™¤</p><p><strong>5ã€volatile-ttl ï¼š</strong> åˆ é™¤å³å°†è¿‡æœŸçš„</p><p><strong>6ã€noeviction ï¼š</strong> æ°¸ä¸è¿‡æœŸï¼Œè¿”å›é”™è¯¯</p><h1><span id="redisæŒä¹…åŒ–">RedisæŒä¹…åŒ–</span></h1><p><strong>RDBï¼šRedis Databases</strong></p><h2><span id="ä»€ä¹ˆæ˜¯rdb">ä»€ä¹ˆæ˜¯RDB</span></h2><hr><p>åœ¨æŒ‡å®šæ—¶é—´é—´éš”åï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥æ•°æ®åº“ ï¼›åœ¨æ¢å¤æ—¶å€™ï¼Œç›´æ¥è¯»å–å¿«ç…§æ–‡ä»¶ï¼Œè¿›è¡Œæ•°æ®çš„æ¢å¤ ï¼›</p><p><img src="/2021/11/04/Redis/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg3MzIyNw==,size_16,color_FFFFFF,t_70-16362795898172" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ Redis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdbçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚æ–‡ä»¶åå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œè‡ªå®šä¹‰ã€‚</p><h3><span id="å·¥ä½œåŸç†">å·¥ä½œåŸç†</span></h3><hr><p>åœ¨è¿›è¡Œ <strong><code>RDB</code></strong> çš„æ—¶å€™ï¼Œ**<code>redis</code>** çš„ä¸»çº¿ç¨‹æ˜¯ä¸ä¼šåš <strong><code>io</code></strong> æ“ä½œçš„ï¼Œä¸»çº¿ç¨‹ä¼š <strong><code>fork</code></strong> ä¸€ä¸ªå­çº¿ç¨‹æ¥å®Œæˆè¯¥æ“ä½œï¼›</p><ol><li>Redis è°ƒç”¨forksã€‚åŒæ—¶æ‹¥æœ‰çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚</li><li>å­è¿›ç¨‹å°†æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚</li><li>å½“å­è¿›ç¨‹å®Œæˆå¯¹æ–° RDB æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚</li></ol><p>è¿™ç§å·¥ä½œæ–¹å¼ä½¿å¾— Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Š(å› ä¸ºæ˜¯ä½¿ç”¨å­è¿›ç¨‹è¿›è¡Œå†™æ“ä½œï¼Œè€Œçˆ¶è¿›ç¨‹ä¾ç„¶å¯ä»¥æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚)</p><p><img src="/2021/11/04/Redis/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg3MzIyNw==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3><span id="è§¦å‘æœºåˆ¶">è§¦å‘æœºåˆ¶</span></h3><hr><ol><li>saveçš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbåŸåˆ™</li><li>æ‰§è¡Œflushallå‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘æˆ‘ä»¬çš„rdbåŸåˆ™</li><li>é€€å‡ºredisï¼Œä¹Ÿä¼šè‡ªåŠ¨äº§ç”Ÿrdbæ–‡ä»¶</li></ol><h3><span id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</span></h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ol><li>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤</li><li>å¯¹æ•°æ®çš„å®Œæ•´æ€§è¦æ±‚ä¸é«˜</li></ol><p><strong>ç¼ºç‚¹ï¼š</strong></p><ol><li>éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›è¡Œæ“ä½œï¼Œå¦‚æœredisæ„å¤–å®•æœºäº†ï¼Œè¿™ä¸ªæœ€åä¸€æ¬¡ä¿®æ”¹çš„æ•°æ®å°±æ²¡æœ‰äº†ã€‚</li><li>forkè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå ç”¨ä¸€å®šçš„å†…å®¹ç©ºé—´ã€‚</li></ol><h2><span id="aof">AOF</span></h2><p><strong>Append Only File</strong></p><p>å°†æˆ‘ä»¬æ‰€æœ‰çš„å‘½ä»¤éƒ½è®°å½•ä¸‹æ¥ï¼Œhistoryï¼Œæ¢å¤çš„æ—¶å€™å°±æŠŠè¿™ä¸ªæ–‡ä»¶å…¨éƒ¨å†æ‰§è¡Œä¸€é</p><blockquote><p>ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™çš„æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œã€‚</p></blockquote><h3><span id="ä»€ä¹ˆæ˜¯aof">ä»€ä¹ˆæ˜¯AOF</span></h3><p>å¿«ç…§åŠŸèƒ½ï¼ˆRDBï¼‰å¹¶ä¸æ˜¯éå¸¸è€ä¹…ï¼ˆdurableï¼‰ï¼š å¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ã€ä»¥åŠæœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®ã€‚ ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼Œ Redis å¢åŠ äº†ä¸€ç§å®Œå…¨è€ä¹…çš„æŒä¹…åŒ–æ–¹å¼ï¼š AOF æŒä¹…åŒ–ã€‚</p><p>å¦‚æœè¦ä½¿ç”¨AOFï¼Œéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</p><p><img src="/2021/11/04/Redis/20200513215247113.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><code>appendonly no yes</code>åˆ™è¡¨ç¤ºå¯ç”¨AOF</p><p>é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨é…ç½®ï¼Œç„¶åé‡å¯redisï¼Œå°±å¯ä»¥ç”Ÿæ•ˆäº†ï¼</p><p>å¦‚æœè¿™ä¸ªaofæ–‡ä»¶æœ‰é”™ä½ï¼Œè¿™æ—¶å€™redisæ˜¯å¯åŠ¨ä¸èµ·æ¥çš„ï¼Œæˆ‘éœ€è¦ä¿®æ”¹è¿™ä¸ªaofæ–‡ä»¶</p><p>redisç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå·¥å…·<code>redis-check-aof --fix</code></p><blockquote><p>ä¼˜ç‚¹å’Œç¼ºç‚¹</p></blockquote><pre><code class="bash">123456appendonly yes  # é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œrdbå®Œå…¨å¤Ÿç”¨appendfilename &quot;appendonly.aof&quot;# appendfsync always # æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsync æ¶ˆè€—æ€§èƒ½appendfsync everysec # æ¯ç§’æ‰§è¡Œä¸€æ¬¡ sync å¯èƒ½ä¼šä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®# appendfsync no # ä¸æ‰§è¡Œ sync ,è¿™æ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«</code></pre><p><strong>ä¼˜ç‚¹</strong></p><ol><li>æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½ä¼šåŒæ­¥ï¼Œæ–‡ä»¶çš„å®Œæ•´æ€§ä¼šæ›´åŠ å¥½</li><li>æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’çš„æ•°æ®</li><li>ä»ä¸åŒæ­¥ï¼Œæ•ˆç‡æœ€é«˜</li></ol><p><strong>ç¼ºç‚¹</strong></p><ol><li>ç›¸å¯¹äºæ•°æ®æ–‡ä»¶æ¥è¯´ï¼Œaofè¿œè¿œå¤§äºrdbï¼Œä¿®å¤é€Ÿåº¦æ¯”rdbæ…¢ï¼</li><li>Aofè¿è¡Œæ•ˆç‡ä¹Ÿè¦æ¯”rdbæ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬redisé»˜è®¤çš„é…ç½®å°±æ˜¯rdbæŒä¹…åŒ–</li></ol><h2><span id="rdbå’Œaopé€‰æ‹©">RDBå’ŒAOPé€‰æ‹©</span></h2><h3><span id="rdbä¼˜åŠ¿ä¸åŠ£åŠ¿">RDBä¼˜åŠ¿ä¸åŠ£åŠ¿</span></h3><h4><span id="ä¼˜åŠ¿">ä¼˜åŠ¿</span></h4><ul><li>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤</li><li>å¯¹æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§è¦æ±‚ä¸é«˜</li></ul><h4><span id="åŠ£åŠ¿">åŠ£åŠ¿</span></h4><ul><li><p>åœ¨ä¸€å®šé—´éš”æ—¶é—´åšä¸€æ¬¡å¤‡ä»½ï¼Œæ‰€ä»¥å¦‚æœredisæ„å¤–downæ‰çš„è¯ï¼Œå°±ä¼šä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§åçš„æ‰€æœ‰ä¿®æ”¹ã€‚</p></li><li><p>Forkçš„æ—¶å€™ï¼Œå†…å­˜ä¸­çš„æ•°æ®è¢«<code>å…‹éš†</code>äº†ä¸€ä»½ï¼Œ<code>å¤§è‡´2å€</code>çš„è†¨èƒ€æ€§èƒ½éœ€è¦è€ƒè™‘</p></li></ul><h3><span id="aofä¼˜åŠ¿åŠ£åŠ¿">AOFä¼˜åŠ¿/åŠ£åŠ¿</span></h3><h4><span id="ä¼˜åŠ¿">ä¼˜åŠ¿</span></h4><ul><li>æ¯æ¬¡ä¿®æ”¹åŒæ­¥ï¼šappendfsync alwaysåŒæ­¥æŒä¹…åŒ–ï¼Œæ¯æ¬¡å‘ç”Ÿæ•°æ®å˜æ›´ä¼šè¢«ç«‹å³è®°å½•åˆ°ç£ç›˜ï¼Œæ€§èƒ½è¾ƒå·®ä½†æ•°æ®å®Œæ•´æ€§æ¯”è¾ƒå¥½</li><li>æ¯ç§’åŒæ­¥ï¼šappendfsync everysecå¼‚æ­¥æ“ä½œï¼Œæ¯ç§’è®°å½•ï¼Œå¦‚æœä¸€ç§’å†…å®•æœºï¼Œä»…ä¸€ç§’å†…çš„æ•°æ®ä¸¢å¤±</li></ul><h4><span id="åŠ£åŠ¿">åŠ£åŠ¿</span></h4><ul><li>ç›¸åŒæ•°æ®é›†çš„æ•°æ®è€Œè¨€aofæ–‡ä»¶è¦è¿œå¤§äºrdbæ–‡ä»¶ï¼Œæ¢å¤é€Ÿåº¦æ…¢äºrdb</li><li>Aofè¿è¡Œæ•ˆç‡è¦æ…¢äºrdb,æ¯ç§’åŒæ­¥ç­–ç•¥æ•ˆç‡è¾ƒå¥½ï¼Œä¸åŒæ­¥æ•ˆç‡å’Œrdbç›¸åŒ</li></ul><h3><span id="å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªç§æŒä¹…åŒ–æ–¹å¼">å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</span></h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾ PostgreSQL çš„æ•°æ®å®‰å…¨æ€§ï¼Œ ä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚</p><p>å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®ï¼Œ ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œ é‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨ RDB æŒä¹…åŒ–ã€‚</p><p>æœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨ AOF æŒä¹…åŒ–ï¼Œ ä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼š å› ä¸ºå®šæ—¶ç”Ÿæˆ RDB å¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯” AOF æ¢å¤çš„é€Ÿåº¦è¦å¿«ã€‚</p><h1><span id="rediså‘å¸ƒè®¢é˜…">Rediså‘å¸ƒè®¢é˜…</span></h1><blockquote><p>è®¢é˜…</p></blockquote><pre><code class="bash">subscribe hongdouReading messages... (press Ctrl-C to quit)1) &quot;subscribe&quot;2) &quot;hongdou&quot;3) (integer) 1</code></pre><blockquote><p>å‘å¸ƒ</p><pre><code class="bash">127.0.0.1:6379&gt; publish hongdou hahaha(integer) 1</code></pre><p>ç»“æœï¼š</p><pre><code class="åŸç†">1) &quot;message&quot;2) &quot;hongdou&quot;3) &quot;hahaha&quot;</code></pre></blockquote><h3><span id="åŸç†">åŸç†</span></h3><p>æ¯ä¸ª Redis æœåŠ¡å™¨è¿›ç¨‹éƒ½ç»´æŒç€ä¸€ä¸ªè¡¨ç¤ºæœåŠ¡å™¨çŠ¶æ€çš„ redis.h/redisServer ç»“æ„ï¼Œ ç»“æ„çš„ pubsub_channels å±æ€§æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œ è¿™ä¸ªå­—å…¸å°±ç”¨äºä¿å­˜è®¢é˜…é¢‘é“çš„ä¿¡æ¯ï¼Œå…¶ä¸­ï¼Œå­—å…¸çš„é”®ä¸ºæ­£åœ¨è¢«è®¢é˜…çš„é¢‘é“ï¼Œ è€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œ é“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ªé¢‘é“çš„å®¢æˆ·ç«¯ã€‚</p><p><img src="/2021/11/04/Redis/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg3MzIyNw==,size_16,color_FFFFFF,t_70-16362932182646" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å®¢æˆ·ç«¯è®¢é˜…ï¼Œå°±è¢«é“¾æ¥åˆ°å¯¹åº”é¢‘é“çš„é“¾è¡¨çš„å°¾éƒ¨ï¼Œé€€è®¢åˆ™å°±æ˜¯å°†å®¢æˆ·ç«¯èŠ‚ç‚¹ä»é“¾è¡¨ä¸­ç§»é™¤ã€‚</p><h3><span id="ç¼ºç‚¹">ç¼ºç‚¹</span></h3><ol><li>å¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯è®¢é˜…äº†é¢‘é“ï¼Œä½†è‡ªå·±è¯»å–æ¶ˆæ¯çš„é€Ÿåº¦å´ä¸å¤Ÿå¿«çš„è¯ï¼Œé‚£ä¹ˆä¸æ–­ç§¯å‹çš„æ¶ˆæ¯ä¼šä½¿redisè¾“å‡ºç¼“å†²åŒºçš„ä½“ç§¯å˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œè¿™å¯èƒ½ä½¿å¾—redisæœ¬èº«çš„é€Ÿåº¦å˜æ…¢ï¼Œç”šè‡³ç›´æ¥å´©æºƒã€‚</li><li>è¿™å’Œæ•°æ®ä¼ è¾“å¯é æ€§æœ‰å…³ï¼Œå¦‚æœåœ¨è®¢é˜…æ–¹æ–­çº¿ï¼Œé‚£ä¹ˆä»–å°†ä¼šä¸¢å¤±æ‰€æœ‰åœ¨çŸ­çº¿æœŸé—´å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ã€‚</li></ol><h3><span id="åº”ç”¨">åº”ç”¨</span></h3><ol><li>æ¶ˆæ¯è®¢é˜…ï¼šå…¬ä¼—å·è®¢é˜…ï¼Œå¾®åšå…³æ³¨ç­‰ç­‰ï¼ˆèµ·å§‹æ›´å¤šæ˜¯ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥è¿›è¡Œå®ç°ï¼‰</li><li>å¤šäººåœ¨çº¿èŠå¤©å®¤ã€‚</li></ol><p>ç¨å¾®å¤æ‚çš„åœºæ™¯ï¼Œæˆ‘ä»¬å°±ä¼šä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶MQå¤„ç†ã€‚</p><h1><span id="redisä¸»ä»å¤åˆ¶">Redisä¸»ä»å¤åˆ¶</span></h1><h3><span id="æ¦‚å¿µ">æ¦‚å¿µ</span></h3><p> ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹ï¼ˆMaster/Leaderï¼‰,åè€…ç§°ä¸ºä»èŠ‚ç‚¹ï¼ˆSlave/Followerï¼‰ï¼Œ æ•°æ®çš„å¤åˆ¶æ˜¯<strong>å•å‘</strong>çš„ï¼åªèƒ½ç”±ä¸»èŠ‚ç‚¹å¤åˆ¶åˆ°ä»èŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ä»¥å†™ä¸ºä¸»ã€ä»èŠ‚ç‚¹ä»¥è¯»ä¸ºä¸»ï¼‰ã€‚</p><p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹</strong>ï¼Œ<strong>ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰0ä¸ªæˆ–è€…å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä½†æ¯ä¸ªä»èŠ‚ç‚¹åªèƒ½ç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</strong></p><h3><span id="ä½œç”¨">ä½œç”¨</span></h3><ol><li>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™çš„æ–¹å¼ã€‚</li><li>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹æ•…éšœæ—¶ï¼Œä»èŠ‚ç‚¹å¯ä»¥æš‚æ—¶æ›¿ä»£ä¸»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œæ˜¯ä¸€ç§æœåŠ¡å†—ä½™çš„æ–¹å¼</li><li>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œç”±ä¸»èŠ‚ç‚¹è¿›è¡Œå†™æ“ä½œï¼Œä»èŠ‚ç‚¹è¿›è¡Œè¯»æ“ä½œï¼Œåˆ†æ‹…æœåŠ¡å™¨çš„è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å¤šè¯»å°‘å†™çš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è´Ÿè½½ï¼Œæé«˜å¹¶å‘é‡ã€‚</li><li>é«˜å¯ç”¨åŸºçŸ³ï¼šä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ã€‚</li></ol><h3><span id="ä¸ºä»€ä¹ˆä½¿ç”¨é›†ç¾¤">ä¸ºä»€ä¹ˆä½¿ç”¨é›†ç¾¤</span></h3><ol><li>å•å°æœåŠ¡å™¨éš¾ä»¥è´Ÿè½½å¤§é‡çš„è¯·æ±‚</li><li>å•å°æœåŠ¡å™¨æ•…éšœç‡é«˜ï¼Œç³»ç»Ÿå´©åæ¦‚ç‡å¤§</li><li>å•å°æœåŠ¡å™¨å†…å­˜å®¹é‡æœ‰é™ã€‚</li></ol><h3><span id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</span></h3><p>æˆ‘ä»¬åœ¨è®²è§£é…ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œæ³¨æ„åˆ°æœ‰ä¸€ä¸ª<code>replication</code>æ¨¡å— (è§Redis.confä¸­ç¬¬8æ¡)</p><p>æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯ï¼š<code>info replication</code></p><pre><code class="bash">123456789101112127.0.0.1:6379&gt; info replication# Replicationrole:master # è§’è‰²connected_slaves:0 # ä»æœºæ•°é‡master_replid:3b54deef5b7b7b7f7dd8acefa23be48879b4fcffmaster_replid2:0000000000000000000000000000000000000000master_repl_offset:0second_repl_offset:-1repl_backlog_active:0repl_backlog_size:1048576repl_backlog_first_byte_offset:0repl_backlog_histlen:0</code></pre><p>æ—¢ç„¶éœ€è¦å¯åŠ¨å¤šä¸ªæœåŠ¡ï¼Œå°±éœ€è¦å¤šä¸ªé…ç½®æ–‡ä»¶ã€‚æ¯ä¸ªé…ç½®æ–‡ä»¶å¯¹åº”ä¿®æ”¹ä»¥ä¸‹ä¿¡æ¯ï¼š</p><ul><li><p>ç«¯å£å·</p></li><li><p>pidæ–‡ä»¶å</p></li><li><p>æ—¥å¿—æ–‡ä»¶å</p></li><li><p>rdbæ–‡ä»¶å</p></li></ul><h5><span id="æ³¨æ„windowé…ç½®æ–¹æ³•">æ³¨æ„ï¼šwindowé…ç½®æ–¹æ³•ï¼š</span></h5><p>å¼€å¯å¤šä¸ªç«¯å£æœåŠ¡å™¨<br>1.é…ç½®æ–‡ä»¶<br>å°†redis.windows-service.confå¤åˆ¶ä¸€ä»½ï¼Œæ”¹åä¸ºç›¸åº”æ–‡ä»¶ï¼Œå¹¶æ›´æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£ä¸ºæŒ‡å®šç«¯å£ï¼Œä»¥6380ä¸ºä¾‹</p><p>port 6380</p><p>2.å®‰è£…æœåŠ¡<br><strong>redis-server â€“service-install â€“service-name redis_6380 redis.windows-service-6380.conf</strong><br>3.å¯åŠ¨æœåŠ¡<br><strong>redis-server â€“service-start â€“service-name redis_6380</strong><br>4.åœæ­¢æœåŠ¡<br><strong>redis-server â€“service-stop â€“service-name redis_6380</strong><br>5.å¸è½½æœåŠ¡<br><strong>redis-server â€“service-uninstall â€“service-name redis_6380</strong></p><p>æŒ‡å®šç«¯å£å¯åŠ¨å®¢æˆ·ç«¯ï¼š<br><strong>redis.cli -p ç«¯å£å·</strong></p><p><img src="/2021/11/04/Redis/image-20211108113934528.png" alt="image-20211108113934528"></p><p><strong>å¯åŠ¨å•æœºå¤šæœåŠ¡é›†ç¾¤ï¼š</strong></p><p><img src="/2021/11/04/Redis/20200513215610163.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3><span id="ä¸€ä¸»äºŒä»é…ç½®">ä¸€ä¸»äºŒä»é…ç½®</span></h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼›ä¸€èˆ¬æƒ…å†µä¸‹åªç”¨é…ç½®ä»æœºå°±å¥½äº†ï¼</p><p>è®¤è€å¤§ï¼ä¸€ä¸»ï¼ˆ79ï¼‰äºŒä»ï¼ˆ80ï¼Œ81ï¼‰</p><p>ä½¿ç”¨<code>SLAVEOF host port</code>å°±å¯ä»¥ä¸ºä»æœºé…ç½®ä¸»æœºäº†ã€‚</p><p><img src="/2021/11/04/Redis/image-20211108114239188.png" alt="image-20211108114239188"></p><p><img src="/2021/11/04/Redis/image-20211108114323436.png" alt="image-20211108114323436"></p><p>ä¸»æœºæˆªå›¾ï¼š</p><p><img src="/2021/11/04/Redis/image-20211108114407873.png" alt="image-20211108114407873"></p><p>ä½¿ç”¨å‘½ä»¤æ­å»ºæ˜¯æš‚æ—¶çš„ï¼ŒçœŸå®å¼€å‘ä¸­åº”è¯¥åœ¨ä»æœºçš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼Œè¿™æ ·çš„è¯æ˜¯æ°¸ä¹…çš„ã€‚</p><p><img src="/2021/11/04/Redis/image-20211108114911108.png" alt="image-20211108114911108"></p><h4><span id="è§„åˆ™">è§„åˆ™</span></h4><p>ä»æœºåªèƒ½è¯»ï¼Œä¸èƒ½å†™ï¼Œä¸»æœºå¯è¯»å¯å†™ä½†æ˜¯å¤šç”¨äºå†™ã€‚</p><p>å½“ä¸»æœºæ–­ç”µå®•æœºåï¼Œé»˜è®¤æƒ…å†µä¸‹ä»æœºçš„è§’è‰²ä¸ä¼šå‘ç”Ÿå˜åŒ– ï¼Œé›†ç¾¤ä¸­åªæ˜¯å¤±å»äº†å†™æ“ä½œï¼Œå½“ä¸»æœºæ¢å¤ä»¥åï¼Œåˆä¼šè¿æ¥ä¸Šä»æœºæ¢å¤åŸçŠ¶ã€‚</p><p>å½“ä»æœºæ–­ç”µå®•æœºåï¼Œè‹¥ä¸æ˜¯ä½¿ç”¨é…ç½®æ–‡ä»¶é…ç½®çš„ä»æœºï¼Œå†æ¬¡å¯åŠ¨åä½œä¸ºä¸»æœºæ˜¯æ— æ³•è·å–ä¹‹å‰ä¸»æœºçš„æ•°æ®çš„ï¼Œè‹¥æ­¤æ—¶é‡æ–°é…ç½®ç§°ä¸ºä»æœºï¼Œåˆå¯ä»¥è·å–åˆ°ä¸»æœºçš„æ‰€æœ‰æ•°æ®ã€‚è¿™é‡Œå°±è¦æåˆ°ä¸€ä¸ªåŒæ­¥åŸç†</p><blockquote><p>å¤åˆ¶åŸç†</p></blockquote><p>ä»æœºæˆåŠŸè¿æ¥åˆ°ä¸»æœºåä¼šå‘é€ä¸€ä¸ªåŒæ­¥å‘½ä»¤</p><p>ä¸»æœºæ¥åˆ°å‘½ä»¤ï¼Œå¯åŠ¨åå°å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰çš„æ”¶åˆ°ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¸»æœºå°†æ•´ä¸ªæ•°æ®æ–‡ä»¶ä¼ é€åˆ°ä»æœºï¼Œå®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥</p><p><strong>å…¨é‡å¤åˆ¶</strong>ï¼šç¬¬ä¸€æ¬¡è¿æ¥æ—¶ï¼Œè·å–ä¸»æœºçš„å…¨éƒ¨æ•°æ®</p><p><strong>å¢é‡å¤åˆ¶</strong>ï¼šæ¯æ¬¡æ›´æ–°æ•°æ®åŒæ­¥åˆ°ä»æœº</p><h3><span id="å±‚å±‚é“¾è·¯">å±‚å±‚é“¾è·¯</span></h3><p>ä¸»æœºä»æœºæˆé“¾è·¯å¼è¿æ¥</p><p>å¦‚æœä¸»æœºæ–­å¼€äº†è¿æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>SLAVEOF no one</code>è®©è‡ªå·±å˜æˆä¸»æœºï¼å…¶ä»–çš„èŠ‚ç‚¹å°±å¯ä»¥æ‰‹åŠ¨è¿æ¥åˆ°æœ€æ–°çš„ä¸»èŠ‚ç‚¹</p><blockquote><p>å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®</p></blockquote><p>å®Œæ•´çš„å“¨å…µæ¨¡å¼é…ç½®æ–‡ä»¶ sentinel.conf</p><pre><code class="bash">12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970# Example sentinel.conf # å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379port 26379 # å“¨å…µsentinelçš„å·¥ä½œç›®å½•dir /tmp # å“¨å…µsentinelç›‘æ§çš„redisä¸»èŠ‚ç‚¹çš„ ip port # master-name  å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€è¿™ä¸‰ä¸ªå­—ç¬¦&quot;.-_&quot;ç»„æˆã€‚# quorum å½“è¿™äº›quorumä¸ªæ•°sentinelå“¨å…µè®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆè¿™æ—¶ å®¢è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹å¤±è”äº†# sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;sentinel monitor mymaster 127.0.0.1 6379 1 # å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„å®¢æˆ·ç«¯éƒ½è¦æä¾›å¯†ç # è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç # sentinel auth-pass &lt;master-name&gt; &lt;password&gt;sentinel auth-pass mymaster MySUPER--secret-0123passw0rd  # æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel æ­¤æ—¶ å“¨å…µä¸»è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿ é»˜è®¤30ç§’# sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;sentinel down-after-milliseconds mymaster 30000 # è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„masterè¿›è¡Œ åŒæ­¥ï¼Œè¿™ä¸ªæ•°å­—è¶Šå°ï¼Œå®Œæˆfailoveræ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œå°±æ„å‘³ç€è¶Š å¤šçš„slaveå› ä¸ºreplicationè€Œä¸å¯ç”¨ã€‚å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªslave å¤„äºä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚# sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;sentinel parallel-syncs mymaster 1   # æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š #1. åŒä¸€ä¸ªsentinelå¯¹åŒä¸€ä¸ªmasterä¸¤æ¬¡failoverä¹‹é—´çš„é—´éš”æ—¶é—´ã€‚#2. å½“ä¸€ä¸ªslaveä»ä¸€ä¸ªé”™è¯¯çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®å¼€å§‹è®¡ç®—æ—¶é—´ã€‚ç›´åˆ°slaveè¢«çº æ­£ä¸ºå‘æ­£ç¡®çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®æ—¶ã€‚#3.å½“æƒ³è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„failoveræ‰€éœ€è¦çš„æ—¶é—´ã€‚  #4.å½“è¿›è¡Œfailoveræ—¶ï¼Œé…ç½®æ‰€æœ‰slavesæŒ‡å‘æ–°çš„masteræ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚ä¸è¿‡ï¼Œå³ä½¿è¿‡äº†è¿™ä¸ªè¶…æ—¶ï¼Œslavesä¾ç„¶ä¼šè¢«æ­£ç¡®é…ç½®ä¸ºæŒ‡å‘masterï¼Œä½†æ˜¯å°±ä¸æŒ‰parallel-syncsæ‰€é…ç½®çš„è§„åˆ™æ¥äº†# é»˜è®¤ä¸‰åˆ†é’Ÿ# sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;sentinel failover-timeout mymaster 180000 # SCRIPTS EXECUTION #é…ç½®å½“æŸä¸€äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æ¥é€šçŸ¥ç®¡ç†å‘˜ï¼Œä¾‹å¦‚å½“ç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸æ—¶å‘é‚®ä»¶é€šçŸ¥ç›¸å…³äººå‘˜ã€‚#å¯¹äºè„šæœ¬çš„è¿è¡Œç»“æœæœ‰ä»¥ä¸‹è§„åˆ™ï¼š#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›1ï¼Œé‚£ä¹ˆè¯¥è„šæœ¬ç¨åå°†ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œé‡å¤æ¬¡æ•°ç›®å‰é»˜è®¤ä¸º10#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›2ï¼Œæˆ–è€…æ¯”2æ›´é«˜çš„ä¸€ä¸ªè¿”å›å€¼ï¼Œè„šæœ¬å°†ä¸ä¼šé‡å¤æ‰§è¡Œã€‚#å¦‚æœè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºæ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·è¢«ç»ˆæ­¢äº†ï¼Œåˆ™åŒè¿”å›å€¼ä¸º1æ—¶çš„è¡Œä¸ºç›¸åŒã€‚#ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º60sï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè„šæœ¬å°†ä¼šè¢«ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢ï¼Œä¹‹åé‡æ–°æ‰§è¡Œã€‚ #é€šçŸ¥å‹è„šæœ¬:å½“sentinelæœ‰ä»»ä½•è­¦å‘Šçº§åˆ«çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯´rediså®ä¾‹çš„ä¸»è§‚å¤±æ•ˆå’Œå®¢è§‚å¤±æ•ˆç­‰ç­‰ï¼‰ï¼Œå°†ä¼šå»è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œ#è¿™æ—¶è¿™ä¸ªè„šæœ¬åº”è¯¥é€šè¿‡é‚®ä»¶ï¼ŒSMSç­‰æ–¹å¼å»é€šçŸ¥ç³»ç»Ÿç®¡ç†å‘˜å…³äºç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„ä¿¡æ¯ã€‚è°ƒç”¨è¯¥è„šæœ¬æ—¶ï¼Œå°†ä¼ ç»™è„šæœ¬ä¸¤ä¸ªå‚æ•°ï¼Œ#ä¸€ä¸ªæ˜¯äº‹ä»¶çš„ç±»å‹ï¼Œ#ä¸€ä¸ªæ˜¯äº‹ä»¶çš„æè¿°ã€‚#å¦‚æœsentinel.confé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿™ä¸ªè„šæœ¬è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»ä¿è¯è¿™ä¸ªè„šæœ¬å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ï¼Œå¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¦åˆ™sentinelæ— æ³•æ­£å¸¸å¯åŠ¨æˆåŠŸã€‚#é€šçŸ¥è„šæœ¬# sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;  sentinel notification-script mymaster /var/redis/notify.sh # å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬# å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯å…³äºmasteråœ°å€å·²ç»å‘ç”Ÿæ”¹å˜çš„ä¿¡æ¯ã€‚# ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:# &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;# ç›®å‰&lt;state&gt;æ€»æ˜¯â€œfailoverâ€,# &lt;role&gt;æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚ # å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§çš„slave)é€šä¿¡çš„# è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚# sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;sentinel client-reconfig-script mymaster /var/redis/reconfig.sh</code></pre><h2><span id="ç¼“å­˜ç©¿é€ä¸é›ªå´©">ç¼“å­˜ç©¿é€ä¸é›ªå´©</span></h2><h3><span id="ç¼“å­˜ç©¿é€æŸ¥ä¸åˆ°">ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰</span></h3><blockquote><p>æ¦‚å¿µ</p></blockquote><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨æˆ·è¯·æ±‚æ•°æ®æ—¶ï¼Œä¼šå…ˆåœ¨ç¼“å­˜(Redis)ä¸­æŸ¥æ‰¾ï¼Œè‹¥æ²¡æ‰¾åˆ°å³ç¼“å­˜æœªå‘½ä¸­ï¼Œå†åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ•°é‡å°‘å¯èƒ½é—®é¢˜ä¸å¤§ï¼Œå¯æ˜¯ä¸€æ—¦å¤§é‡çš„è¯·æ±‚æ•°æ®ï¼ˆä¾‹å¦‚ç§’æ€åœºæ™¯ï¼‰ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­çš„è¯ï¼Œå°±ä¼šå…¨éƒ¨è½¬ç§»åˆ°æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“æå¤§çš„å‹åŠ›ï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´æ•°æ®åº“å´©æºƒã€‚ç½‘ç»œå®‰å…¨ä¸­ä¹Ÿæœ‰äººæ¶æ„ä½¿ç”¨è¿™ç§æ‰‹æ®µè¿›è¡Œæ”»å‡»è¢«ç§°ä¸ºæ´ªæ°´æ”»å‡»ã€‚</p><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><p><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong></p><p>å¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥Hashçš„å½¢å¼å­˜å‚¨ï¼Œä»¥ä¾¿å¿«é€Ÿç¡®å®šæ˜¯å¦å­˜åœ¨è¿™ä¸ªå€¼ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ‹¦æˆªæ ¡éªŒï¼Œæ ¡éªŒä¸é€šè¿‡ç›´æ¥æ‰“å›ï¼Œå‡è½»äº†å­˜å‚¨ç³»ç»Ÿçš„å‹åŠ›ã€‚</p><p><img src="/2021/11/04/Redis/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg3MzIyNw==,size_16,color_FFFFFF,t_70-16363526192282" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>ç¼“å­˜ç©ºå¯¹è±¡</strong></p><p>ä¸€æ¬¡è¯·æ±‚è‹¥åœ¨ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æ‰¾åˆ°ï¼Œå°±åœ¨ç¼“å­˜ä¸­æ–¹ä¸€ä¸ªç©ºå¯¹è±¡ç”¨äºå¤„ç†åç»­è¿™ä¸ªè¯·æ±‚ã€‚</p><p><img src="/2021/11/04/Redis/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg3MzIyNw==,size_16,color_FFFFFF,t_70-16363526320984" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p> è¿™æ ·åšæœ‰ä¸€ä¸ªç¼ºé™·ï¼šå­˜å‚¨ç©ºå¯¹è±¡ä¹Ÿéœ€è¦ç©ºé—´ï¼Œå¤§é‡çš„ç©ºå¯¹è±¡ä¼šè€—è´¹ä¸€å®šçš„ç©ºé—´ï¼Œå­˜å‚¨æ•ˆç‡å¹¶ä¸é«˜ã€‚è§£å†³è¿™ä¸ªç¼ºé™·çš„æ–¹å¼å°±æ˜¯è®¾ç½®è¾ƒçŸ­è¿‡æœŸæ—¶é—´</p><p>å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äºéœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ã€‚</p><h3><span id="ç¼“å­˜å‡»ç©¿é‡å¤ªå¤§ç¼“å­˜è¿‡æœŸ">ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼‰</span></h3><blockquote><p>æ¦‚å¿µ</p></blockquote><p> ç›¸è¾ƒäºç¼“å­˜ç©¿é€ï¼Œç¼“å­˜å‡»ç©¿çš„ç›®çš„æ€§æ›´å¼ºï¼Œä¸€ä¸ªå­˜åœ¨çš„keyï¼Œåœ¨ç¼“å­˜è¿‡æœŸçš„ä¸€åˆ»ï¼ŒåŒæ—¶æœ‰å¤§é‡çš„è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚éƒ½ä¼šå‡»ç©¿åˆ°DBï¼Œé€ æˆç¬æ—¶DBè¯·æ±‚é‡å¤§ã€å‹åŠ›éª¤å¢ã€‚è¿™å°±æ˜¯ç¼“å­˜è¢«å‡»ç©¿ï¼Œåªæ˜¯é’ˆå¯¹å…¶ä¸­æŸä¸ªkeyçš„ç¼“å­˜ä¸å¯ç”¨è€Œå¯¼è‡´å‡»ç©¿ï¼Œä½†æ˜¯å…¶ä»–çš„keyä¾ç„¶å¯ä»¥ä½¿ç”¨ç¼“å­˜å“åº”ã€‚</p><p> æ¯”å¦‚çƒ­æœæ’è¡Œä¸Šï¼Œä¸€ä¸ªçƒ­ç‚¹æ–°é—»è¢«åŒæ—¶å¤§é‡è®¿é—®å°±å¯èƒ½å¯¼è‡´ç¼“å­˜å‡»ç©¿ã€‚</p><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><ol><li><p><strong>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ</strong></p><p>è¿™æ ·å°±ä¸ä¼šå‡ºç°çƒ­ç‚¹æ•°æ®è¿‡æœŸçš„æƒ…å†µï¼Œä½†æ˜¯å½“Rediså†…å­˜ç©ºé—´æ»¡çš„æ—¶å€™ä¹Ÿä¼šæ¸…ç†éƒ¨åˆ†æ•°æ®ï¼Œè€Œä¸”æ­¤ç§æ–¹æ¡ˆä¼šå ç”¨ç©ºé—´ï¼Œä¸€æ—¦çƒ­ç‚¹æ•°æ®å¤šäº†èµ·æ¥ï¼Œå°±ä¼šå ç”¨éƒ¨åˆ†ç©ºé—´ã€‚</p></li><li><p><strong>åŠ äº’æ–¥é”(åˆ†å¸ƒå¼é”)</strong></p><p>åœ¨è®¿é—®keyä¹‹å‰ï¼Œé‡‡ç”¨SETNXï¼ˆset if not existsï¼‰æ¥è®¾ç½®å¦ä¸€ä¸ªçŸ­æœŸkeyæ¥é”ä½å½“å‰keyçš„è®¿é—®ï¼Œè®¿é—®ç»“æŸå†åˆ é™¤è¯¥çŸ­æœŸkeyã€‚ä¿è¯åŒæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚è¿™æ ·å¯¹é”çš„è¦æ±‚å°±ååˆ†é«˜ã€‚</p></li></ol><h3><span id="ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</span></h3><blockquote><p>æ¦‚å¿µ</p></blockquote><p>å¤§é‡çš„keyè®¾ç½®äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œå¯¼è‡´åœ¨ç¼“å­˜åœ¨åŒä¸€æ—¶åˆ»å…¨éƒ¨å¤±æ•ˆï¼Œé€ æˆç¬æ—¶DBè¯·æ±‚é‡å¤§ã€å‹åŠ›éª¤å¢ï¼Œå¼•èµ·é›ªå´©ã€‚</p><p><img src="/2021/11/04/Redis/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg3MzIyNw==,size_16,color_FFFFFF,t_70-16363526462886" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><ul><li><p>redisé«˜å¯ç”¨</p><p>è¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤</p></li><li><p>é™æµé™çº§</p><p>è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</p></li><li><p>æ•°æ®é¢„çƒ­</p><p>æ•°æ®åŠ çƒ­çš„å«ä¹‰å°±æ˜¯åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½çš„æ•°æ®å…ˆé¢„å…ˆè®¿é—®ä¸€éï¼Œè¿™æ ·éƒ¨åˆ†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®å°±ä¼šåŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;redis&quot;&gt;Redis&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/2021/11/04/Redis/image-20211104130443874.png&quot; alt=&quot;image-20211104130443874&quot;&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºæ²¡æœ‰</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>dubbo</title>
    <link href="http://example.com/2021/11/02/dubbo/"/>
    <id>http://example.com/2021/11/02/dubbo/</id>
    <published>2021-11-02T08:19:06.000Z</published>
    <updated>2021-11-04T03:36:13.773Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="dubbo">Dubbo</span></h1><h2><span id="rpcæ¡†æ¶">RPCæ¡†æ¶</span></h2><p>RPCã€Remote Procedure Callã€‘æ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚</p><p>Apache Dubbo (incubating) æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava RPCæ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°</p><h2><span id="æ³¨å†Œä¸­å¿ƒ-zookeeperregistry">æ³¨å†Œä¸­å¿ƒ zookeeper(Registry)</span></h2><p><img src="/2021/11/02/dubbo/image-20211102170838813.png" alt="image-20211102170838813"></p><p><strong>æœåŠ¡æä¾›è€…</strong>ï¼ˆ<strong>Provider</strong>ï¼‰ï¼šæš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</p><p><strong>æœåŠ¡æ¶ˆè´¹è€…</strong>ï¼ˆ<strong>Consumer</strong>ï¼‰: è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</p><p><strong>æ³¨å†Œä¸­å¿ƒ</strong>ï¼ˆ<strong>Registry</strong>ï¼‰ï¼šæ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…</p><p><strong>ç›‘æ§ä¸­å¿ƒ</strong>ï¼ˆ<strong>Monitor</strong>ï¼‰ï¼šæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒ</p><h1><span id="dubboé…ç½®">dubboé…ç½®</span></h1><h2><span id="1-é…ç½®åŸåˆ™">1ã€é…ç½®åŸåˆ™</span></h2><p><img src="/2021/11/02/dubbo/wpsBCDE.tmp.png" alt="img"> </p><p>JVM å¯åŠ¨ -D å‚æ•°ä¼˜å…ˆï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨æˆ·åœ¨éƒ¨ç½²å’Œå¯åŠ¨æ—¶è¿›è¡Œå‚æ•°é‡å†™ï¼Œæ¯”å¦‚åœ¨å¯åŠ¨æ—¶éœ€æ”¹å˜åè®®çš„ç«¯å£ã€‚</p><p>XML æ¬¡ä¹‹ï¼Œå¦‚æœåœ¨ XML ä¸­æœ‰é…ç½®ï¼Œåˆ™ dubbo.properties ä¸­çš„ç›¸åº”é…ç½®é¡¹æ— æ•ˆã€‚</p><p>Properties æœ€åï¼Œç›¸å½“äºç¼ºçœå€¼ï¼Œåªæœ‰ XML æ²¡æœ‰é…ç½®æ—¶ï¼Œdubbo.properties çš„ç›¸åº”é…ç½®é¡¹æ‰ä¼šç”Ÿæ•ˆï¼Œé€šå¸¸ç”¨äºå…±äº«å…¬å…±é…ç½®ï¼Œæ¯”å¦‚åº”ç”¨åã€‚</p><h2><span id="2-é‡è¯•æ¬¡æ•°">2ã€é‡è¯•æ¬¡æ•°</span></h2><p>å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=â€2â€ æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚</p><p>é‡è¯•æ¬¡æ•°é…ç½®å¦‚ä¸‹</p><pre><code class="xml">&lt;dubbo:service retries=&quot;2&quot; /&gt;æˆ–&lt;dubbo:reference retries=&quot;2&quot; /&gt;æˆ–&lt;dubbo:reference&gt;&lt;dubbo:method name=&quot;findFoo&quot; retries=&quot;2&quot; /&gt;&lt;/dubbo:reference&gt;</code></pre><h2><span id="3-è¶…æ—¶æ—¶é—´">3ã€è¶…æ—¶æ—¶é—´</span></h2><p>ç”±äºç½‘ç»œæˆ–æœåŠ¡ç«¯ä¸å¯é ï¼Œä¼šå¯¼è‡´è°ƒç”¨å‡ºç°ä¸€ç§ä¸ç¡®å®šçš„ä¸­é—´çŠ¶æ€ï¼ˆè¶…æ—¶ï¼‰ã€‚ä¸ºäº†é¿å…è¶…æ—¶å¯¼è‡´å®¢æˆ·ç«¯èµ„æºï¼ˆçº¿ç¨‹ï¼‰æŒ‚èµ·è€—å°½ï¼Œå¿…é¡»è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚</p><h3><span id="1-dubboæ¶ˆè´¹ç«¯">1ã€Dubboæ¶ˆè´¹ç«¯</span></h3><pre><code class="xml">å…¨å±€è¶…æ—¶é…ç½®&lt;dubbo:consumer timeout=&quot;5000&quot; /&gt; æŒ‡å®šæ¥å£ä»¥åŠç‰¹å®šæ–¹æ³•è¶…æ—¶é…ç½®&lt;dubbo:reference interface=&quot;com.foo.BarService&quot; timeout=&quot;2000&quot;&gt;      &lt;dubbo:method name=&quot;sayHello&quot; timeout=&quot;3000&quot; /&gt;&lt;/dubbo:reference&gt;</code></pre><h3><span id="2-dubboæœåŠ¡ç«¯">2ã€DubboæœåŠ¡ç«¯</span></h3><pre><code class="xml">å…¨å±€è¶…æ—¶é…ç½®&lt;dubbo:provider timeout=&quot;5000&quot; /&gt; æŒ‡å®šæ¥å£ä»¥åŠç‰¹å®šæ–¹æ³•è¶…æ—¶é…ç½®&lt;dubbo:provider interface=&quot;com.foo.BarService&quot; timeout=&quot;2000&quot;&gt;  &lt;dubbo:method name=&quot;sayHello&quot; timeout=&quot;3000&quot; /&gt;&lt;/dubbo:provider&gt;</code></pre><h3><span id="3-é…ç½®åŸåˆ™">3ã€é…ç½®åŸåˆ™</span></h3><p>dubboæ¨èåœ¨Providerä¸Šå°½é‡å¤šé…ç½®Consumerç«¯å±æ€§ï¼š</p><p>1ã€ä½œæœåŠ¡çš„æä¾›è€…ï¼Œæ¯”æœåŠ¡ä½¿ç”¨æ–¹æ›´æ¸…æ¥šæœåŠ¡æ€§èƒ½å‚æ•°ï¼Œå¦‚è°ƒç”¨çš„è¶…æ—¶æ—¶é—´ï¼Œåˆç†çš„é‡è¯•æ¬¡æ•°ï¼Œç­‰ç­‰2ã€åœ¨Provideré…ç½®åï¼ŒConsumerä¸é…ç½®åˆ™ä¼šä½¿ç”¨Providerçš„é…ç½®å€¼ï¼Œå³Provideré…ç½®å¯ä»¥ä½œä¸ºConsumerçš„ç¼ºçœå€¼ã€‚å¦åˆ™ï¼ŒConsumerä¼šä½¿ç”¨Consumerç«¯çš„å…¨å±€è®¾ç½®ï¼Œè¿™å¯¹äºProviderä¸å¯æ§çš„ï¼Œå¹¶ä¸”å¾€å¾€æ˜¯ä¸åˆç†çš„</p><p>é…ç½®çš„è¦†ç›–è§„åˆ™ï¼š</p><p>\1) æ–¹æ³•çº§é…ç½®åˆ«ä¼˜äºæ¥å£çº§åˆ«ï¼Œå³å°Scopeä¼˜å…ˆ </p><p>\2) Consumerç«¯é…ç½® ä¼˜äº Provideré…ç½® ä¼˜äº å…¨å±€é…ç½®ï¼Œ</p><p>\3) æœ€åæ˜¯Dubbo Hard Codeçš„é…ç½®å€¼ï¼ˆè§é…ç½®æ–‡æ¡£ï¼‰</p><p><img src="/2021/11/02/dubbo/wpsBCDF.tmp.png" alt="img"> </p><h2><span id="4-ç‰ˆæœ¬å·">4ã€ç‰ˆæœ¬å·</span></h2><p>å½“ä¸€ä¸ªæ¥å£å®ç°ï¼Œå‡ºç°ä¸å…¼å®¹å‡çº§æ—¶ï¼Œå¯ä»¥ç”¨ç‰ˆæœ¬å·è¿‡æ¸¡ï¼Œç‰ˆæœ¬å·ä¸åŒçš„æœåŠ¡ç›¸äº’é—´ä¸å¼•ç”¨ã€‚</p><p>å¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œç‰ˆæœ¬è¿ç§»ï¼š</p><p>åœ¨ä½å‹åŠ›æ—¶é—´æ®µï¼Œå…ˆå‡çº§ä¸€åŠæä¾›è€…ä¸ºæ–°ç‰ˆæœ¬</p><p>å†å°†æ‰€æœ‰æ¶ˆè´¹è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬</p><p>ç„¶åå°†å‰©ä¸‹çš„ä¸€åŠæä¾›è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬</p><pre><code class="xml">è€ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š&lt;dubbo:service interface=&quot;com.foo.BarService&quot; version=&quot;1.0.0&quot; /&gt;æ–°ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š&lt;dubbo:service interface=&quot;com.foo.BarService&quot; version=&quot;2.0.0&quot; /&gt; è€ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š&lt;dubbo:reference id=&quot;barService&quot; interface=&quot;com.foo.BarService&quot; version=&quot;1.0.0&quot; /&gt; æ–°ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š&lt;dubbo:reference id=&quot;barService&quot; interface=&quot;com.foo.BarService&quot; version=&quot;2.0.0&quot; /&gt; å¦‚æœä¸éœ€è¦åŒºåˆ†ç‰ˆæœ¬ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼é…ç½®ï¼š&lt;dubbo:reference id=&quot;barService&quot; interface=&quot;com.foo.BarService&quot; version=&quot;*&quot; /&gt;</code></pre><h1><span id="ä¸‰-é«˜å¯ç”¨">ä¸‰ã€é«˜å¯ç”¨</span></h1><h2><span id="1-zookeeperå®•æœºä¸dubboç›´è¿">1ã€zookeeperå®•æœºä¸dubboç›´è¿</span></h2><p>ç°è±¡ï¼šzookeeperæ³¨å†Œä¸­å¿ƒå®•æœºï¼Œè¿˜å¯ä»¥æ¶ˆè´¹dubboæš´éœ²çš„æœåŠ¡ã€‚</p><p>åŸå› ï¼š</p><p>å¥å£®æ€§l ç›‘æ§ä¸­å¿ƒå®•æ‰ä¸å½±å“ä½¿ç”¨ï¼Œåªæ˜¯ä¸¢å¤±éƒ¨åˆ†é‡‡æ ·æ•°æ®l æ•°æ®åº“å®•æ‰åï¼Œæ³¨å†Œä¸­å¿ƒä»èƒ½é€šè¿‡ç¼“å­˜æä¾›æœåŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼Œä½†ä¸èƒ½æ³¨å†Œæ–°æœåŠ¡l æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å°l <strong>æ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯</strong>l æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œä¸å½±å“ä½¿ç”¨l æœåŠ¡æä¾›è€…å…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æ¶ˆè´¹è€…åº”ç”¨å°†æ— æ³•ä½¿ç”¨ï¼Œå¹¶æ— é™æ¬¡é‡è¿ç­‰å¾…æœåŠ¡æä¾›è€…æ¢å¤ </p><p>é«˜å¯ç”¨ï¼šé€šè¿‡è®¾è®¡ï¼Œå‡å°‘ç³»ç»Ÿä¸èƒ½æä¾›æœåŠ¡çš„æ—¶é—´ï¼›</p><h2><span id="2-é›†ç¾¤ä¸‹dubboè´Ÿè½½å‡è¡¡é…ç½®">2ã€é›†ç¾¤ä¸‹dubboè´Ÿè½½å‡è¡¡é…ç½®</span></h2><p>åœ¨é›†ç¾¤è´Ÿè½½å‡è¡¡æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å‡è¡¡ç­–ç•¥ï¼Œç¼ºçœä¸º random éšæœºè°ƒç”¨ã€‚</p><p>è´Ÿè½½å‡è¡¡ç­–ç•¥</p><p><strong>Random LoadBalance</strong>éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚<strong>RoundRobin LoadBalance</strong>è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚</p><p><strong>LeastActive LoadBalance</strong>æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚<strong>ConsistentHash LoadBalance</strong>ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚ç®—æ³•å‚è§ï¼š<a href="http://en.wikipedia.org/wiki/Consistent_hashing%E7%BC%BA%E7%9C%81%E5%8F%AA%E5%AF%B9%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0">http://en.wikipedia.org/wiki/Consistent_hashingç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•°</a> Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® &lt;dubbo:parameter key=â€hash.argumentsâ€ value=â€0,1â€ /&gt;ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® &lt;dubbo:parameter key=â€hash.nodesâ€ value=â€320â€ /&gt;</p><h2><span id="3-æ•´åˆhystrixæœåŠ¡ç†”æ–­ä¸é™çº§å¤„ç†">3ã€æ•´åˆhystrixï¼ŒæœåŠ¡ç†”æ–­ä¸é™çº§å¤„ç†</span></h2><h3><span id="1-æœåŠ¡é™çº§">1ã€æœåŠ¡é™çº§</span></h3><p><strong>ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ï¼Ÿ</strong></p><p><strong>å½“æœåŠ¡å™¨å‹åŠ›å‰§å¢çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µåŠæµé‡ï¼Œå¯¹ä¸€äº›æœåŠ¡å’Œé¡µé¢æœ‰ç­–ç•¥çš„ä¸å¤„ç†æˆ–æ¢ç§ç®€å•çš„æ–¹å¼å¤„ç†ï¼Œä»è€Œé‡Šæ”¾æœåŠ¡å™¨èµ„æºä»¥ä¿è¯æ ¸å¿ƒäº¤æ˜“æ­£å¸¸è¿ä½œæˆ–é«˜æ•ˆè¿ä½œã€‚</strong></p><p>å¯ä»¥é€šè¿‡æœåŠ¡é™çº§åŠŸèƒ½ä¸´æ—¶å±è”½æŸä¸ªå‡ºé”™çš„éå…³é”®æœåŠ¡ï¼Œå¹¶å®šä¹‰é™çº§åçš„è¿”å›ç­–ç•¥ã€‚</p><p>å‘æ³¨å†Œä¸­å¿ƒå†™å…¥åŠ¨æ€é…ç½®è¦†ç›–è§„åˆ™ï¼š</p><pre><code class="java">RegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();Registry registry = registryFactory.getRegistry(URL.valueOf(&quot;zookeeper://10.20.153.10:2181&quot;));registry.register(URL.valueOf(&quot;override://0.0.0.0/com.foo.BarService?category=configurators&amp;dynamic=false&amp;application=foo&amp;mock=force:return+null&quot;)); </code></pre><p>å…¶ä¸­ï¼š</p><p>mock=force:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨éƒ½ç›´æ¥è¿”å› null å€¼ï¼Œä¸å‘èµ·è¿œç¨‹è°ƒç”¨ã€‚ç”¨æ¥å±è”½ä¸é‡è¦æœåŠ¡ä¸å¯ç”¨æ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚</p><p>è¿˜å¯ä»¥æ”¹ä¸º mock=fail:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨åœ¨å¤±è´¥åï¼Œå†è¿”å› null å€¼ï¼Œä¸æŠ›å¼‚å¸¸ã€‚ç”¨æ¥å®¹å¿ä¸é‡è¦æœåŠ¡ä¸ç¨³å®šæ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚</p><h3><span id="2-é›†ç¾¤å®¹é”™">2ã€é›†ç¾¤å®¹é”™</span></h3><p>åœ¨é›†ç¾¤è°ƒç”¨å¤±è´¥æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å®¹é”™æ–¹æ¡ˆï¼Œç¼ºçœä¸º failover é‡è¯•ã€‚</p><p><strong>é›†ç¾¤å®¹é”™æ¨¡å¼</strong></p><p><strong>Failover Cluster</strong>å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=â€2â€ æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚ é‡è¯•æ¬¡æ•°é…ç½®å¦‚ä¸‹ï¼š&lt;dubbo:service retries=â€2â€ /&gt;æˆ–&lt;dubbo:reference retries=â€2â€ /&gt;æˆ–<a href="dubbo:reference">dubbo:reference</a>  &lt;dubbo:method name=â€findFooâ€ retries=â€2â€ /&gt; </p><p><strong>Failfast Cluster</strong>å¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚ </p><p><strong>Failsafe Cluster</strong>å¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚ <strong>Failback Cluster</strong>å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚ <strong>Forking Cluster</strong>å¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks=â€2â€ æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚</p><p> <strong>Broadcast Cluster</strong>å¹¿æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ [2]ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚</p><p> <strong>é›†ç¾¤æ¨¡å¼é…ç½®</strong>æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹åœ¨æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹é…ç½®é›†ç¾¤æ¨¡å¼&lt;dubbo:service cluster=â€failsafeâ€ /&gt;æˆ–&lt;dubbo:reference cluster=â€failsafeâ€ /&gt;</p><h3><span id="3-æ•´åˆhystrix">3ã€æ•´åˆhystrix</span></h3><p>Hystrix æ—¨åœ¨é€šè¿‡æ§åˆ¶é‚£äº›è®¿é—®è¿œç¨‹ç³»ç»Ÿã€æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„èŠ‚ç‚¹ï¼Œä»è€Œå¯¹å»¶è¿Ÿå’Œæ•…éšœæä¾›æ›´å¼ºå¤§çš„å®¹é”™èƒ½åŠ›ã€‚Hystrixå…·å¤‡æ‹¥æœ‰å›é€€æœºåˆ¶å’Œæ–­è·¯å™¨åŠŸèƒ½çš„çº¿ç¨‹å’Œä¿¡å·éš”ç¦»ï¼Œè¯·æ±‚ç¼“å­˜å’Œè¯·æ±‚æ‰“åŒ…ï¼Œä»¥åŠç›‘æ§å’Œé…ç½®ç­‰åŠŸèƒ½</p><h4><span id="1-é…ç½®spring-cloud-starter-netflix-hystrix"><strong>1ã€é…ç½®spring-cloud-starter-netflix-hystrix</strong></span></h4><p>spring bootå®˜æ–¹æä¾›äº†å¯¹hystrixçš„é›†æˆï¼Œç›´æ¥åœ¨pom.xmlé‡ŒåŠ å…¥ä¾èµ–ï¼š</p><pre><code class="xml">    &lt;dependency&gt;              &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;                            &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;              &lt;version&gt;1.4.4.RELEASE&lt;/version&gt;        &lt;/dependency&gt;</code></pre><p>ç„¶ååœ¨Applicationç±»ä¸Šå¢åŠ @EnableHystrixæ¥å¯ç”¨hystrix starterï¼š</p><pre><code class="java">@SpringBootApplication@EnableHystrixpublic class ProviderApplication &#123; </code></pre><h4><span id="2-é…ç½®providerç«¯"><strong>2ã€é…ç½®Providerç«¯</strong></span></h4><p>åœ¨Dubboçš„Providerä¸Šå¢åŠ @HystrixCommandé…ç½®ï¼Œè¿™æ ·å­è°ƒç”¨å°±ä¼šç»è¿‡Hystrixä»£ç†ã€‚</p><pre><code class="java">@Service(version = &quot;1.0.0&quot;)public class HelloServiceImpl implements HelloService &#123;      @HystrixCommand(commandProperties = &#123;       @HystrixProperty(name = &quot;circuitBreaker.requestVolumeThreshold&quot;, value = &quot;10&quot;),       @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;2000&quot;) &#125;)    @Override      public String sayHello(String name) &#123;            // System.out.println(&quot;async provider received: &quot; + name);            // return &quot;annotation: hello, &quot; + name;            throw new RuntimeException(&quot;Exception to show hystrix enabled.&quot;);  &#125;&#125;</code></pre><h4><span id="3-é…ç½®consumerç«¯"><strong>3ã€é…ç½®Consumerç«¯</strong></span></h4><p>å¯¹äºConsumerç«¯ï¼Œåˆ™å¯ä»¥å¢åŠ ä¸€å±‚methodè°ƒç”¨ï¼Œå¹¶åœ¨methodä¸Šé…ç½®@HystrixCommandã€‚å½“è°ƒç”¨å‡ºé”™æ—¶ï¼Œä¼šèµ°åˆ°fallbackMethod = â€œreliableâ€çš„è°ƒç”¨é‡Œã€‚</p><pre><code class="java"> @Reference(version = &quot;1.0.0&quot;)  private HelloService demoService;   @HystrixCommand(fallbackMethod = &quot;reliable&quot;)   public String doSayHello(String name) &#123;         return demoService.sayHello(name);  &#125;   public String reliable(String name) &#123;        return &quot;hystrix fallback value&quot;;  &#125;</code></pre><h1><span id="å››-dubboåŸç†">å››ã€dubboåŸç†</span></h1><h2><span id="1-rpcåŸç†">1ã€RPCåŸç†</span></h2><p><img src="/2021/11/02/dubbo/wpsBCEF.tmp.jpg" alt="img"> </p><p>ä¸€æ¬¡å®Œæ•´çš„RPCè°ƒç”¨æµç¨‹ï¼ˆåŒæ­¥è°ƒç”¨ï¼Œå¼‚æ­¥å¦è¯´ï¼‰å¦‚ä¸‹ï¼š <strong>1ï¼‰æœåŠ¡æ¶ˆè´¹æ–¹ï¼ˆclientï¼‰è°ƒç”¨ä»¥æœ¬åœ°è°ƒç”¨æ–¹å¼è°ƒç”¨æœåŠ¡ï¼›</strong> 2ï¼‰client stubæ¥æ”¶åˆ°è°ƒç”¨åè´Ÿè´£å°†æ–¹æ³•ã€å‚æ•°ç­‰ç»„è£…æˆèƒ½å¤Ÿè¿›è¡Œç½‘ç»œä¼ è¾“çš„æ¶ˆæ¯ä½“ï¼› 3ï¼‰client stubæ‰¾åˆ°æœåŠ¡åœ°å€ï¼Œå¹¶å°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡ç«¯ï¼› 4ï¼‰server stubæ”¶åˆ°æ¶ˆæ¯åè¿›è¡Œè§£ç ï¼› 5ï¼‰server stubæ ¹æ®è§£ç ç»“æœè°ƒç”¨æœ¬åœ°çš„æœåŠ¡ï¼› 6ï¼‰æœ¬åœ°æœåŠ¡æ‰§è¡Œå¹¶å°†ç»“æœè¿”å›ç»™server stubï¼› 7ï¼‰server stubå°†è¿”å›ç»“æœæ‰“åŒ…æˆæ¶ˆæ¯å¹¶å‘é€è‡³æ¶ˆè´¹æ–¹ï¼› 8ï¼‰client stubæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå¹¶è¿›è¡Œè§£ç ï¼› <strong>9ï¼‰æœåŠ¡æ¶ˆè´¹æ–¹å¾—åˆ°æœ€ç»ˆç»“æœã€‚</strong>RPCæ¡†æ¶çš„ç›®æ ‡å°±æ˜¯è¦2~8è¿™äº›æ­¥éª¤éƒ½å°è£…èµ·æ¥ï¼Œè¿™äº›ç»†èŠ‚å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œä¸å¯è§çš„ã€‚</p><h2><span id="2-nettyé€šä¿¡åŸç†">2ã€nettyé€šä¿¡åŸç†</span></h2><p>Nettyæ˜¯ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„ç½‘ç»œåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œ ç”¨äºå¿«é€Ÿå¼€å‘å¯ç»´æŠ¤çš„é«˜æ€§èƒ½åè®®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚å®ƒæå¤§åœ°ç®€åŒ–å¹¶ç®€åŒ–äº†TCPå’ŒUDPå¥—æ¥å­—æœåŠ¡å™¨ç­‰ç½‘ç»œç¼–ç¨‹ã€‚</p><p>BIOï¼š(Blocking IO)</p><p><img src="/2021/11/02/dubbo/wpsBCF0.tmp.jpg" alt="img"> </p><p>NIO (Non-Blocking IO)</p><p><img src="/2021/11/02/dubbo/wpsBCF1.tmp.jpg" alt="img"> </p><p>Selector ä¸€èˆ¬ç§° ä¸º<strong>é€‰æ‹©å™¨</strong> ï¼Œä¹Ÿå¯ä»¥ç¿»è¯‘ä¸º <strong>å¤šè·¯å¤ç”¨å™¨ï¼Œ</strong></p><p>Connectï¼ˆè¿æ¥å°±ç»ªï¼‰ã€Acceptï¼ˆæ¥å—å°±ç»ªï¼‰ã€Readï¼ˆè¯»å°±ç»ªï¼‰ã€Writeï¼ˆå†™å°±ç»ªï¼‰</p><p>NettyåŸºæœ¬åŸç†ï¼š</p><p><img src="/2021/11/02/dubbo/wpsBCF2.tmp.jpg" alt="img"> </p><h2><span id="3-dubboåŸç†">3ã€dubboåŸç†</span></h2><h3><span id="1-dubboåŸç†-æ¡†æ¶è®¾è®¡">1ã€dubboåŸç†    -æ¡†æ¶è®¾è®¡</span></h3><p><img src="/2021/11/02/dubbo/wpsBCF3.tmp.png" alt="img"> </p><p>l config é…ç½®å±‚ï¼šå¯¹å¤–é…ç½®æ¥å£ï¼Œä»¥ ServiceConfig, ReferenceConfig ä¸ºä¸­å¿ƒï¼Œå¯ä»¥ç›´æ¥åˆå§‹åŒ–é…ç½®ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ spring è§£æé…ç½®ç”Ÿæˆé…ç½®ç±»</p><p>l proxy æœåŠ¡ä»£ç†å±‚ï¼šæœåŠ¡æ¥å£é€æ˜ä»£ç†ï¼Œç”ŸæˆæœåŠ¡çš„å®¢æˆ·ç«¯ Stub å’ŒæœåŠ¡å™¨ç«¯ Skeleton, ä»¥ ServiceProxy ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º ProxyFactory</p><p>l registry æ³¨å†Œä¸­å¿ƒå±‚ï¼šå°è£…æœåŠ¡åœ°å€çš„æ³¨å†Œä¸å‘ç°ï¼Œä»¥æœåŠ¡ URL ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º RegistryFactory, Registry, RegistryService</p><p>l cluster è·¯ç”±å±‚ï¼šå°è£…å¤šä¸ªæä¾›è€…çš„è·¯ç”±åŠè´Ÿè½½å‡è¡¡ï¼Œå¹¶æ¡¥æ¥æ³¨å†Œä¸­å¿ƒï¼Œä»¥ Invoker ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Cluster, Directory, Router, LoadBalance</p><p>l monitor ç›‘æ§å±‚ï¼šRPC è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ç›‘æ§ï¼Œä»¥ Statistics ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º MonitorFactory, Monitor, MonitorService</p><p>l protocol è¿œç¨‹è°ƒç”¨å±‚ï¼šå°è£… RPC è°ƒç”¨ï¼Œä»¥ Invocation, Result ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Protocol, Invoker, Exporter</p><p>l exchange ä¿¡æ¯äº¤æ¢å±‚ï¼šå°è£…è¯·æ±‚å“åº”æ¨¡å¼ï¼ŒåŒæ­¥è½¬å¼‚æ­¥ï¼Œä»¥ Request, Response ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Exchanger, ExchangeChannel, ExchangeClient, ExchangeServer</p><p>l transport ç½‘ç»œä¼ è¾“å±‚ï¼šæŠ½è±¡ mina å’Œ netty ä¸ºç»Ÿä¸€æ¥å£ï¼Œä»¥ Message ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Channel, Transporter, Client, Server, Codec</p><p>l serialize æ•°æ®åºåˆ—åŒ–å±‚ï¼šå¯å¤ç”¨çš„ä¸€äº›å·¥å…·ï¼Œæ‰©å±•æ¥å£ä¸º Serialization, ObjectInput, ObjectOutput, ThreadPool</p><h3><span id="2-dubboåŸç†-å¯åŠ¨è§£æ-åŠ è½½é…ç½®ä¿¡æ¯">2ã€dubboåŸç†    -å¯åŠ¨è§£æã€åŠ è½½é…ç½®ä¿¡æ¯</span></h3><p><img src="/2021/11/02/dubbo/wpsBD04.tmp.jpg" alt="img"> </p><h3><span id="3-dubboåŸç†-æœåŠ¡æš´éœ²">3ã€dubboåŸç†    -æœåŠ¡æš´éœ²</span></h3><p><img src="/2021/11/02/dubbo/wpsBD05.tmp.png" alt="img"> </p><h3><span id="4-dubboåŸç†-æœåŠ¡å¼•ç”¨">4ã€dubboåŸç†    -æœåŠ¡å¼•ç”¨</span></h3><p><img src="/2021/11/02/dubbo/wpsBD06.tmp.png" alt="img"> </p><h3><span id="5-dubboåŸç†-æœåŠ¡è°ƒç”¨">5ã€dubboåŸç†    -æœåŠ¡è°ƒç”¨</span></h3><p><img src="/2021/11/02/dubbo/wpsBD07.tmp.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;dubbo&quot;&gt;Dubbo&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;rpcæ¡†æ¶&quot;&gt;RPCæ¡†æ¶&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;RPCã€Remote Procedure Callã€‘æ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒ</summary>
      
    
    
    
    
    <category term="dubbo" scheme="http://example.com/tags/dubbo/"/>
    
  </entry>
  
  <entry>
    <title>å´å©·å„¿çš„å‘¨æœ«é‡‡é£</title>
    <link href="http://example.com/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/"/>
    <id>http://example.com/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/</id>
    <published>2021-10-25T06:53:15.000Z</published>
    <updated>2021-10-25T07:11:29.670Z</updated>
    
    <content type="html"><![CDATA[<h4><span id="2021-10-24">2021-10-24</span></h4><p>å˜¿å˜¿ï¼Œå…ˆæ¥ä¸€å¼ è¯•è¯•æ‰‹ğŸ˜ğŸ˜ğŸ˜</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20211025144914.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20211025144914"></p><p>è¿™å¼ ï¼Œé‚»å®¶å°å¦¹çš„æ„Ÿè§‰ï¼ï¼ï¼ğŸ‘©â€ğŸ¦°</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20211025145201.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20211025145201"></p><p>è¯´å®è¯ï¼Œè¿™ä¸€å¼ è™½ç„¶å¾ˆå¥½çœ‹ï¼Œä½†æ˜¯å±äºåªè®©æˆ‘çœ‹çš„ä¸€ç§ç±»å‹ğŸ¤ğŸ¤ğŸ¤</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449141.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449141"></p><p>å“ˆå“ˆï¼Œè¿™å¼ å°±å¾ˆå¯çˆ±å•¦~ğŸ¤ªğŸ¤ªğŸ¤ª</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449142-16351451102662.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449142"></p><p>å¾ˆæœ‰æ¸¯é£æ–‡è‰ºèŒƒçš„æ„Ÿè§‰</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449143.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449143"></p><p>åŠå¸¦æ‰ä¸‹æ¥äº†ğŸ˜ªğŸ˜ªğŸ˜ª</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449144.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449144"></p><p>å‡è£…è‡ªå·±åœ¨æ‹ç…§ç³»åˆ—ğŸ˜¶ğŸ˜¶ğŸ˜¶ğŸ‘¸ğŸ‘¸ğŸ‘¸</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449145.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449145"></p><p>è¿™ä¸ªä¹Ÿå¾ˆå¥½çœ‹ï¼ï¼ï¼ğŸ¥ğŸ¥ğŸ¥</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449146.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449146"></p><p>å›å½’å¯çˆ±<strong>ç±»å‹å„¿</strong>(âœ¿â—¡â€¿â—¡)</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449147.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449147"></p><p>æ ‡å‡†ç¾ç…§ï¼ï¼ï¼ğŸ¥©</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251449148.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251449148"></p><p>è¿™ä¸ªä¹Ÿæ˜¯ï¼ŒåŒä¸Šã€‚</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251452011.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251452011"></p><p>æ¥ä¸‹æ¥è¿™ä¸¤å¼ å°±æ˜¯æ»¡æ»¡çš„æ¬¢ä¹æ°”æ¯å•¦ï¼ï¼ï¼ğŸ›´ğŸ›´ğŸ›´ğŸ›´</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251452012.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251452012"></p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251452013.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251452013"></p><p>åŒæ ·é‚»å®¶å°å¦¹ç±»å‹å„¿</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251452014.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251452014"></p><p>å“å‘€ï¼Œè¿™ä¸æ˜¯å®è´å’Œå¥¹å§¨å˜›ï¼Œé¢ï¼Œçœ‹é”™äº†çœ‹é”™äº†ï¼Œä¸å¥½æ„æ€ï¼Œæ˜¯å®è´å’Œç¾ä¸½æ¸©æŸ”è¿˜å¸¦æœ‰ä¸€ç‚¹ç‚¹æˆç†Ÿæ°”æ¯çš„å°é™<strong>å„¿</strong>ğŸ¤—ğŸ¤—ğŸ¤—</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251452015.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251452015"></p><p>æ‹äº†ä¸€ä¸‹åˆç…§ï¼Œæ†”æ‚´çš„ç¾ğŸ˜</p><p><img src="/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%A8%E6%9C%AB%E9%87%87%E9%A3%8E/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_202110251452016-16351451102663.jpg" alt="å¾®ä¿¡å›¾ç‰‡_202110251452016"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4&gt;&lt;span id=&quot;2021-10-24&quot;&gt;2021-10-24&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;å˜¿å˜¿ï¼Œå…ˆæ¥ä¸€å¼ è¯•è¯•æ‰‹ğŸ˜ğŸ˜ğŸ˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/10/25/%E5%90%B4%E5%A9%B7%E5%84%BF%E7%9A%84%E5%91%</summary>
      
    
    
    
    <category term="ç”Ÿæ´»å›­åœ°" scheme="http://example.com/categories/%E7%94%9F%E6%B4%BB%E5%9B%AD%E5%9C%B0/"/>
    
    
    <category term="record sweetheart" scheme="http://example.com/tags/record-sweetheart/"/>
    
  </entry>
  
  <entry>
    <title>UML</title>
    <link href="http://example.com/2021/10/23/UML/"/>
    <id>http://example.com/2021/10/23/UML/</id>
    <published>2021-10-23T12:06:56.000Z</published>
    <updated>2021-10-23T12:29:35.476Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="umlå…³ç³»">umlå…³ç³»</span></h1><p><strong>ç±»ä¹‹é—´çš„å…³ç³»ï¼šä¾èµ–ï¼Œæ³›åŒ–ï¼Œå®ç°ï¼Œå…³è”ï¼Œèšåˆä¸ç»„åˆ</strong></p><h2><span id="ä¾èµ–å…³ç³»">ä¾èµ–å…³ç³»</span></h2><p><strong>â€”â€”â€”&gt;</strong>  </p><p><img src="/2021/10/23/UML/image-20211023201026812.png" alt="image-20211023201026812"></p><h2><span id="æ³›åŒ–å…³ç³»">æ³›åŒ–å…³ç³»</span></h2><p>å°±æ˜¯ç»§æ‰¿å…³ç³»</p><p>å®çº¿+ç©ºå¿ƒç®­å¤´</p><h2><span id="å®ç°å…³ç³»">å®ç°å…³ç³»</span></h2><p>ä¸€ä¸ªç±»å®ç°æ¥å£å…³ç³»</p><p>è™šçº¿+ç©ºå¿ƒç®­å¤´</p><h2><span id="å…³è”å…³ç³»">å…³è”å…³ç³»</span></h2><p><img src="/2021/10/23/UML/image-20211023202554822.png" alt="image-20211023202554822"></p><h2><span id="èšåˆå…³ç³»">èšåˆå…³ç³»</span></h2><p><img src="/2021/10/23/UML/image-20211023202721548.png" alt="image-20211023202721548"></p><h2><span id></span></h2><h2><span id="ç»„åˆå…³ç³»">ç»„åˆå…³ç³»</span></h2><p>ä¹Ÿæ˜¯æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œåªä¸è¿‡æ•´ä½“ä¸éƒ¨åˆ†ä¸å¯åˆ†å¼€â€˜</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;umlå…³ç³»&quot;&gt;umlå…³ç³»&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;ç±»ä¹‹é—´çš„å…³ç³»ï¼šä¾èµ–ï¼Œæ³›åŒ–ï¼Œå®ç°ï¼Œå…³è”ï¼Œèšåˆä¸ç»„åˆ&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;ä¾èµ–å…³ç³»&quot;&gt;ä¾èµ–å…³ç³»&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;â€”â€”â€”&amp;gt</summary>
      
    
    
    
    <category term="Java" scheme="http://example.com/categories/Java/"/>
    
    
    <category term="uml" scheme="http://example.com/tags/uml/"/>
    
  </entry>
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼Study-0</title>
    <link href="http://example.com/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/"/>
    <id>http://example.com/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/</id>
    <published>2021-10-21T14:07:05.000Z</published>
    <updated>2021-10-23T11:40:37.366Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™">è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™</span></h1><h3><span id="å•ä¸€èŒè´£åŸåˆ™">å•ä¸€èŒè´£åŸåˆ™</span></h3><p>é€šå¸¸åœ¨ç±»çº§åˆ«å®è¡Œå•ä¸€èŒè´£ï¼Œåªæœ‰åœ¨ç±»ä¸­æ–¹æ³•è¶³å¤Ÿå°‘çš„æƒ…å†µä¸‹ï¼Œæ‰å¯ä»¥åœ¨æ–¹æ³•çº§åˆ«ä¿æŒå•ä¸€èŒè´£åŸåˆ™ã€‚</p><p><strong>ç”¨ç±»æ¥åŒ–è§£åˆ†æ”¯</strong></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022104314536.png" alt="image-20211022104314536"></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022102844895.png" alt="image-20211022102844895"><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022102908817.png" alt="image-20211022102908817"></p><h3><span id="æ¥å£éš”ç¦»åŸåˆ™">æ¥å£éš”ç¦»åŸåˆ™</span></h3><p><strong>ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Š</strong></p><blockquote><p>åˆå§‹ç‰ˆæœ¬</p></blockquote><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022110421886.png" alt="image-20211022110421886"></p><p>ä¾èµ–å…³ç³»ç¤ºä¾‹å›¾ï¼š</p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022110802941.png" alt="image-20211022110802941"></p><blockquote><p>æ”¹è¿›ç‰ˆ</p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022110528996.png" alt="image-20211022110528996"></p></blockquote><h3><span id="ä¾èµ–å€’è½¬å€’ç½®åŸåˆ™">ä¾èµ–å€’è½¬ï¼ˆå€’ç½®ï¼‰åŸåˆ™</span></h3><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022112257188.png" alt="image-20211022112257188"></p><p>è®¾è®¡ç†å¿µï¼šç›¸å¯¹äºç»†èŠ‚ï¼ˆå…·ä½“çš„å®ç°ç±»ï¼‰ï¼ŒæŠ½è±¡ï¼ˆæ¥å£ï¼ŒæŠ½è±¡ç±»ï¼‰çš„ä¸œè¥¿æ›´<strong>ç¨³å®š</strong>ï¼ˆä¼˜ç‚¹è§ä¸Šå›¾ï¼‰ï¼Œä»¥<strong>æŠ½è±¡ä¸ºåŸºç¡€æ­å»ºçš„æ¶æ„</strong>æ¯”<strong>ä»¥ç»†èŠ‚ä¸ºæ¶æ„</strong>è¦æ›´ç¨³å®š</p><p>ä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»çš„ç›®çš„æ˜¯<strong>åˆ¶å®šå¥½è§„èŒƒ</strong>ï¼Œä¸æ¶‰åŠ<strong>å…·ä½“çš„æ“ä½œ</strong>ï¼ŒæŠŠ<strong>å±•ç°ç»†èŠ‚</strong>äº¤ç»™å…·ä½“å®ç°ç±»å»å®Œæˆã€‚</p><p>ç»†èŠ‚åº”è¯¥<strong>ä¾èµ–æŠ½è±¡</strong>ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯<strong>é¢å‘æ¥å£ç¼–ç¨‹</strong></p><p>EXAMPLE:</p><p>å®¢æˆ·ç«¯ï¼š</p><pre><code class="java">package ä¾èµ–å€’è½¬;import java.time.Period;public class Client &#123;    public static void main(String[] args) &#123;        Person person=new Person();        person.receive(new Email());        person.receive(new Weixin());    &#125;&#125;</code></pre><p>ç»Ÿä¸€å‘ä¿¡æ¯æ¥å£ï¼š</p><pre><code class="java">package ä¾èµ–å€’è½¬;interface IReceiver &#123;    public String getInfo();&#125;</code></pre><p>å¾®ä¿¡å’Œemailåˆ†åˆ«å»ºç«‹å®ä½“ç±»å®ç°ç»Ÿä¸€å‘é€ä¿¡æ¯æ¥å£ï¼Œç”±æ­¤å¯ä»¥åœ¨ä¸Šå›¾å®¢æˆ·ç«¯ä¸­å®ç°åŠŸèƒ½ã€‚</p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022115039056.png" alt="image-20211022115039056"></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022114045857.png" alt="image-20211022114045857"></p><h3><span id="é‡Œæ°æ›¿æ¢åŸåˆ™">é‡Œæ°æ›¿æ¢åŸåˆ™</span></h3><p>å¼•å‡ºï¼šç»§æ‰¿ä¹Ÿæœ‰ä¸€äº›å¼Šç«¯ï¼šå¸¦æ¥ä¾µå…¥æ€§ï¼Œå¢åŠ äº†å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ€§ã€‚ä¸€ä¸ªçˆ¶ç±»è¢«å¤šä¸ªå­ç±»ç»§æ‰¿æ—¶ï¼Œå½“çˆ¶ç±»ä¿®æ”¹åŠŸèƒ½ï¼Œåˆ™å¿…é¡»è¦è€ƒè™‘åˆ°æ‰€æœ‰çš„å­ç±»ï¼Œè€Œä¸”ä¿®æ”¹åå­ç±»çš„åŠŸèƒ½ä¼šäº§ç”Ÿæ•…éšœã€‚</p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022122710402.png" alt="image-20211022122710402"></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022122725461.png" alt="image-20211022122725461"></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022122850226.png" alt="image-20211022122850226"></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211022122914008.png" alt="image-20211022122914008"></p><h3><span id="å¼€é—­åŸåˆ™">å¼€é—­åŸåˆ™</span></h3><p>å¯¹æ‰©å±•å¼€æ”¾ï¼ˆæä¾›æ–¹ï¼‰ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼ˆä½¿ç”¨æ–¹ï¼‰</p><p>å°½é‡æ·»åŠ ä»£ç è€Œä¸å»ä¿®æ”¹</p><h3><span id="è¿ªç±³ç‰¹æ³•åˆ™">è¿ªç±³ç‰¹æ³•åˆ™</span></h3><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211023183516689.png" alt="image-20211023183516689"></p><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/image-20211023183343984.png" alt="image-20211023183343984"></p><h3><span id="åˆæˆå¤ç”¨åŸåˆ™">åˆæˆå¤ç”¨åŸåˆ™</span></h3><p>å°½é‡ä½¿ç”¨åˆæˆæˆ–èšåˆçš„æ–¹å¼ï¼Œä¸è¦ä½¿ç”¨ç»§æ‰¿ï¼Œé™ä½è€¦åˆåº¦ã€‚</p><h2><span id="è®¾è®¡åŸåˆ™æ ¸å¿ƒæ€æƒ³">è®¾è®¡åŸåˆ™æ ¸å¿ƒæ€æƒ³</span></h2><p><img src="/2021/10/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8FStudy-0/Blog\source_posts\è®¾è®¡æ¨¡å¼Study-0\image-20211023193922411.png" alt="image-20211023193922411"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™&quot;&gt;è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™&lt;/span&gt;&lt;/h1&gt;&lt;h3&gt;&lt;span id=&quot;å•ä¸€èŒè´£åŸåˆ™&quot;&gt;å•ä¸€èŒè´£åŸåˆ™&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;é€šå¸¸åœ¨ç±»çº§åˆ«å®è¡Œå•ä¸€èŒè´£ï¼Œåªæœ‰åœ¨ç±»ä¸­æ–¹æ³•è¶³å¤Ÿå°‘çš„æƒ…å†µä¸‹ï¼Œæ‰å¯ä»¥åœ¨æ–¹æ³•çº§åˆ«ä¿æŒå•ä¸€èŒè´£åŸåˆ™ã€‚&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="Javaè¿›é˜¶" scheme="http://example.com/categories/Java%E8%BF%9B%E9%98%B6/"/>
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/Java%E8%BF%9B%E9%98%B6/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å¼€å§‹" scheme="http://example.com/categories/Java%E8%BF%9B%E9%98%B6/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%BC%80%E5%A7%8B/"/>
    
    
    <category term="è®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>NodeJSã€Npmã€Es6ã€Babel</title>
    <link href="http://example.com/2021/10/20/NodeJS%E3%80%81Npm%E3%80%81Es6%E3%80%81Babel/"/>
    <id>http://example.com/2021/10/20/NodeJS%E3%80%81Npm%E3%80%81Es6%E3%80%81Babel/</id>
    <published>2021-10-20T09:12:29.000Z</published>
    <updated>2021-10-20T09:26:11.872Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="å‰ç«¯æŠ€èƒ½åŸºç¡€æ‚çƒ©">å‰ç«¯æŠ€èƒ½åŸºç¡€æ‚çƒ©</span></h1><p>å­¦ä¹ æ–‡æ¡£åœ°å€ï¼š<a href="https://www.kuangstudy.com/bbs/1351463043300708353">https://www.kuangstudy.com/bbs/1351463043300708353</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;å‰ç«¯æŠ€èƒ½åŸºç¡€æ‚çƒ©&quot;&gt;å‰ç«¯æŠ€èƒ½åŸºç¡€æ‚çƒ©&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;å­¦ä¹ æ–‡æ¡£åœ°å€ï¼š&lt;a href=&quot;https://www.kuangstudy.com/bbs/1351463043300708353&quot;&gt;https://www.kuangstudy.co</summary>
      
    
    
    
    
    <category term="NodeJSã€Npmã€Es6ã€Babel" scheme="http://example.com/tags/NodeJS%E3%80%81Npm%E3%80%81Es6%E3%80%81Babel/"/>
    
  </entry>
  
  <entry>
    <title>mybatisPlus</title>
    <link href="http://example.com/2021/10/16/mybatisPlus/"/>
    <id>http://example.com/2021/10/16/mybatisPlus/</id>
    <published>2021-10-16T08:50:45.000Z</published>
    <updated>2021-10-18T06:18:40.977Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="mybatisplus">mybatisPlus</span></h1><p><img src="/2021/10/16/mybatisPlus/image-20211016165647437.png" alt="image-20211016165647437"></p><h2><span id="å…¥é—¨">å…¥é—¨</span></h2><p>mapperæ¥å£æ–‡ä»¶ç»§æ‰¿<strong>basemapper</strong>ï¼Œè®°å¾—åŠ å‚æ•°è¦æ˜¾ç¤ºæŸ¥è¯¢å¯¹è±¡ç±»å‹</p><pre><code class="java">//ç»§æ‰¿Basemapperå°±å¯ä»¥ä¸ç¼–å†™xmlæ–‡ä»¶äº†@Repository//ä»£è¡¨æ˜¯æŒä¹…å±‚public interface UserMapper extends BaseMapper&lt;User&gt; &#123;&#125;</code></pre><p>æ³¨æ„ï¼šğŸ§¨ğŸ§¨ğŸ§¨ğŸ§¨ğŸ§¨è¦åœ¨ä¸»å¯åŠ¨ç±»ä¸‹é…ç½®æ‰«æçš„mapperåŒ…ä¸‹æ‰€æœ‰çš„æ¥å£</p><pre><code class="java">@MapperScan(&quot;com.zz.mybatisplus.mapper&quot;)</code></pre><p>ğŸ‡ğŸ‡ğŸ‡ğŸ‡ğŸ‡ğŸ‡</p><h2><span id="æ—¥å¿—é…ç½®">æ—¥å¿—é…ç½®</span></h2><p>ä¸ºäº†æŸ¥çœ‹sqlè¯­å¥è¿ç”¨æƒ…å†µ</p><pre><code class="yml">mybatis-plus:  configuration:    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl</code></pre><p>ç»“æœï¼š</p><p><img src="/2021/10/16/mybatisPlus/image-20211016173856822.png" alt="image-20211016173856822"></p><h2><span id></span></h2><h2><span id="ä¸»é”®ç”Ÿæˆç­–ç•¥">ä¸»é”®ç”Ÿæˆç­–ç•¥</span></h2><p>é›ªèŠ±ç®—æ³•</p><blockquote><p>é»˜è®¤ ID_WORKER å…¨å±€å”¯ä¸€id</p></blockquote><pre><code class="java">/** * &lt;p&gt; * ç”ŸæˆIDç±»å‹æšä¸¾ç±» * &lt;/p&gt; * * @author hubin * @since 2015-11-10 */@Getterpublic enum IdType &#123;    /**     * æ•°æ®åº“IDè‡ªå¢     */    AUTO(0),    /**     * è¯¥ç±»å‹ä¸ºæœªè®¾ç½®ä¸»é”®ç±»å‹     */    NONE(1),    /**     * ç”¨æˆ·è¾“å…¥ID     * è¯¥ç±»å‹å¯ä»¥é€šè¿‡è‡ªå·±æ³¨å†Œè‡ªåŠ¨å¡«å……æ’ä»¶è¿›è¡Œå¡«å……     */    INPUT(2),    /* ä»¥ä¸‹3ç§ç±»å‹ã€åªæœ‰å½“æ’å…¥å¯¹è±¡ID ä¸ºç©ºï¼Œæ‰è‡ªåŠ¨å¡«å……ã€‚ */    /**     * å…¨å±€å”¯ä¸€ID (idWorker)     */    ID_WORKER(3),    /**     * å…¨å±€å”¯ä¸€ID (UUID)     */    UUID(4),    /**     * å­—ç¬¦ä¸²å…¨å±€å”¯ä¸€ID (idWorker çš„å­—ç¬¦ä¸²è¡¨ç¤º)     */    ID_WORKER_STR(5);    private int key;    IdType(int key) &#123;        this.key = key;    &#125;&#125;</code></pre><p><img src="/2021/10/16/mybatisPlus/image-20211017192539524.png" alt="image-20211017192539524"></p><blockquote><p>ä¸»é”®è‡ªå¢</p></blockquote><p>å®ä½“ç±»å­—æ®µä¸Š </p><pre><code class="java">@TableId(type = IdType.AUTO)</code></pre><p>æ•°æ®åº“å­—æ®µä¸€å®šè¦æ˜¯è‡ªå¢ï¼</p><h2><span id="æ›´æ–°æ“ä½œ"><img src="/2021/10/16/mybatisPlus/image-20211017193225402.png">æ›´æ–°æ“ä½œ</span></h2><p>å‚æ•°ä¸ºå¯¹è±¡</p><pre><code class="java">@Test    void test1()&#123;        User user=new User(6,&quot;gzz&quot;,89,&quot;1614399965@qq.com&quot;);        userMapper.updateById(user);    &#125;</code></pre><h2><span id="è‡ªåŠ¨å¡«å……æ—¶é—´">è‡ªåŠ¨å¡«å……æ—¶é—´</span></h2><p>1.æ•°æ®åº“ç®¡ç†å·¥å…·è®¾ç½®</p><p>2.ä»£ç çº§åˆ«è®¾ç½®</p><blockquote><p>å®ä½“ç±»å­—æ®µå±æ€§ä¸Šéœ€è¦å¢åŠ æ³¨è§£</p></blockquote><p><img src="/2021/10/16/mybatisPlus/image-20211017200938069.png" alt="image-20211017200938069"></p><p>å®ç°è‡ªå·±çš„å¤„ç†å™¨</p><pre><code class="java">@Slf4j@Component//æŠŠè‡ªå·±çš„å¤„ç†å™¨æ·»åŠ åˆ°IOCå®¹å™¨ä¸­public class My implements MetaObjectHandler &#123;    @Override    public void insertFill(MetaObject metaObject) &#123;        log.debug(&quot;=================insertFillè¢«è°ƒç”¨==================&quot;);        this.setFieldValByName(&quot;createTime&quot;,new Date(),metaObject);        this.setFieldValByName(&quot;updateTime&quot;,new Date(),metaObject);    &#125;    @Override    public void updateFill(MetaObject metaObject) &#123;        log.debug(&quot;==========updateFillè¢«è°ƒç”¨====================&quot;);        this.setFieldValByName(&quot;updateTime&quot;,new Date(),metaObject);    &#125;&#125;</code></pre><p>ç»“æœæŸ¥çœ‹ï¼š</p><p><img src="/2021/10/16/mybatisPlus/image-20211017201647403.png" alt="image-20211017201647403"></p><h2><span id></span></h2><h2><span id="ä¹è§‚é”">ä¹è§‚é”</span></h2><p>åŸç†ï¼š</p><p>  å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰ version</p><p> æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ªversion </p><p>  æ‰§è¡Œæ›´æ–°æ—¶ï¼Œ set version = newVersion where version = oldVersion å¦‚æœversionä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</p><pre><code class="sql">ä¹è§‚é”ï¼š1ã€å…ˆæŸ¥è¯¢ï¼Œè·å¾—ç‰ˆæœ¬å· version = 1-- Aupdate user set name = &quot;kuangshen&quot;, version = version + 1where id = 2 and version = 1-- B çº¿ç¨‹æŠ¢å…ˆå®Œæˆï¼Œè¿™ä¸ªæ—¶å€™ version = 2ï¼Œä¼šå¯¼è‡´ A ä¿®æ”¹å¤±è´¥ï¼update user set name = &quot;kuangshen&quot;, version = version + 1where id = 2 and version = 1</code></pre><p><img src="/2021/10/16/mybatisPlus/image-20211017211514770.png" alt="image-20211017211514770"></p><p>æ•°æ®åº“å¢åŠ <strong>version</strong>å­—æ®µï¼Œé»˜è®¤ä¸ºä¸€</p><p>å®ä½“ç±»åŠ å¯¹åº”çš„å­—æ®µï¼Œå¢åŠ å¯¹åº”çš„æ³¨è§£</p><pre><code class="java">@Version//ä¹è§‚é”private Integer version;</code></pre><p>æ³¨å†Œç»„ä»¶</p><pre><code class="java">@MapperScan(&quot;com.zz.mybatisplus.mapper&quot;)@EnableTransactionManagement//è‡ªåŠ¨ç®¡ç†äº‹åŠ¡@Configurationpublic class Myconfig &#123;    //æ³¨å†Œä¹è§‚é”æ’ä»¶    @Bean     public OptimisticLockerInterceptor optimisticLockerInterceptor()&#123;        return new OptimisticLockerInterceptor();    &#125;&#125;</code></pre><p>æµ‹è¯•</p><pre><code class="Java"> //æµ‹è¯•ä¹è§‚é”    @Test    void test3()&#123;        // çº¿ç¨‹ 1        User user = userMapper.selectById(1L);        user.setName(&quot;zz111&quot;);        // æ¨¡æ‹Ÿå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†æ’é˜Ÿæ“ä½œ        User user2 = userMapper.selectById(1L);        user2.setName(&quot;zz222&quot;);        userMapper.updateById(user2);        userMapper.updateById(user);//å¦‚æœæ²¡æœ‰ä¹è§‚é”å°±ä¼šè¦†ç›–æ’é˜Ÿçº¿ç¨‹çš„å€¼    &#125;</code></pre><p>ç»“æœå¯ä»¥çœ‹åˆ°åå­—æ›´æ–°æœ€ç»ˆç»“æœä¸ºzz222</p><p><img src="/2021/10/16/mybatisPlus/image-20211017212009400.png" alt="image-20211017212009400"></p><h2><span id></span></h2><h2><span id="é€»è¾‘åˆ é™¤">é€»è¾‘åˆ é™¤</span></h2><p>1.</p><p>æ•°æ®åº“æ·»åŠ é€»è¾‘åˆ é™¤å­—æ®µï¼Œé»˜è®¤ä¸º0<img src="/2021/10/16/mybatisPlus/image-20211018134702720.png" alt="image-20211018134702720"></p><p>2.</p><p>å®ä½“ç±»æ·»åŠ æ³¨è§£å’Œå±æ€§</p><pre><code class="java">@TableLogic//é€»è¾‘åˆ é™¤private Integer deleted;</code></pre><p>3.</p><p><strong>é…ç½®</strong></p><p>æ³¨å†Œé€»è¾‘åˆ é™¤ç»„ä»¶</p><pre><code class="java">  //é€»è¾‘åˆ é™¤    @Bean    public ISqlInjector sqlInjector()&#123;        return new LogicSqlInjector();    &#125;</code></pre><pre><code class="yml">mybatis-plus:  configuration:    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl  #é€»è¾‘åˆ é™¤é…ç½®  global-config:    db-config:      logic-delete-value: 1      logic-not-delete-value: 0</code></pre><p>ä½“éªŒï¼š<img src="/2021/10/16/mybatisPlus/image-20211018134947771.png" alt="image-20211018134947771"></p><p><img src="/2021/10/16/mybatisPlus/image-20211018135228638.png" alt="image-20211018135228638"></p><p>å¯ä»¥çœ‹å‡ºå®é™…æ˜¯æŠŠdeletedå­—æ®µçš„å€¼å˜ä¸ºä¸€ï¼Œä¹‹åå†æŸ¥è¯¢çš„æ—¶å€™SQLè¯­å¥ä¼šè‡ªåŠ¨æ ¹æ®deleted=0æ¥è¿‡æ»¤ï¼Œå¯ä»¥çœ‹ä¸‹å›¾</p><p><img src="/2021/10/16/mybatisPlus/image-20211018135453151.png" alt="image-20211018135453151"></p><h2><span id></span></h2><h2><span id="æ¡ä»¶æ„é€ å™¨">æ¡ä»¶æ„é€ å™¨</span></h2><p>å®ä¾‹åœ¨é¡¹ç›®æµ‹è¯•ç”¨ä¾‹ä¸­æŸ¥çœ‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;mybatisplus&quot;&gt;mybatisPlus&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/2021/10/16/mybatisPlus/image-20211016165647437.png&quot; alt=&quot;image-2021101616564</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Linux</title>
    <link href="http://example.com/2021/10/13/Linux/"/>
    <id>http://example.com/2021/10/13/Linux/</id>
    <published>2021-10-13T03:53:20.000Z</published>
    <updated>2021-11-09T06:16:46.758Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="linux">Linux</span></h1><blockquote><p><strong>/</strong> ä¸ºæ ¹ç›®å½•</p></blockquote><p><img src="/2021/10/13/Linux/image-20211013121356670.png" alt="image-20211013121356670"></p><blockquote><p>pwdä¼šæ˜¾ç¤ºå½“å‰ç”¨æˆ·æ‰€åœ¨çš„ç›®å½•</p><p>é€’å½’åˆ›å»ºç›®å½•   </p><pre><code>mkdir -p</code></pre></blockquote><p><strong>rmdir ( åˆ é™¤ç©ºçš„ç›®å½• )</strong></p><h3><span id="åŸºæœ¬å±æ€§">åŸºæœ¬å±æ€§</span></h3><p><img src="/2021/10/13/Linux/image-20211013123219345.png" alt="image-20211013123219345"></p><p>åœ¨Linuxä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨è¿™ä¸ªæ–‡ä»¶æ˜¯ç›®å½•ã€æ–‡ä»¶æˆ–é“¾æ¥æ–‡ä»¶ç­‰ç­‰ï¼š</p><ul><li><p>å½“ä¸º[ <strong>d</strong> ]åˆ™æ˜¯ç›®å½•</p></li><li><p>å½“ä¸º[ <strong>-</strong> ]åˆ™æ˜¯æ–‡ä»¶ï¼›</p></li><li><p>è‹¥æ˜¯[ <strong>l</strong> ]åˆ™è¡¨ç¤ºä¸ºé“¾æ¥æ–‡æ¡£ ( link file )ï¼›</p></li><li><p>è‹¥æ˜¯[ <strong>b</strong> ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æ¥å£è®¾å¤‡ ( å¯éšæœºå­˜å–è£…ç½® )ï¼›</p></li><li><p>è‹¥æ˜¯[ <strong>c</strong> ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡ ( ä¸€æ¬¡æ€§è¯»å–è£…ç½® )ã€‚</p></li><li><p><img src="/2021/10/13/Linux/image-20211013172707239.png" alt="image-20211013172707239"></p><p><strong>æ¥ä¸‹æ¥çš„å­—ç¬¦ä¸­ï¼Œä»¥ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œä¸”å‡ä¸ºã€rwxã€ çš„ä¸‰ä¸ªå‚æ•°çš„ç»„åˆã€‚</strong></p><p><strong>å…¶ä¸­ï¼Œ[ r ]ä»£è¡¨å¯è¯»(read)ã€[ w ]ä»£è¡¨å¯å†™(write)ã€[ x ]ä»£è¡¨å¯æ‰§è¡Œ(execute)ã€‚</strong></p><p><strong>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ªæƒé™çš„ä½ç½®ä¸ä¼šæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æƒé™ï¼Œå°±ä¼šå‡ºç°å‡å·[ - ]è€Œå·²ã€‚</strong></p></li></ul><p><img src="/2021/10/13/Linux/640" alt="å›¾ç‰‡"></p><p>åœ¨ä»¥ä¸Šå®ä¾‹ä¸­ï¼Œå±ä¸»å’Œå±ç»„éƒ½ä¸º root</p><blockquote><p>ä¿®æ”¹æ–‡ä»¶å±æ€§</p></blockquote><p><strong>1ã€chgrpï¼šæ›´æ”¹æ–‡ä»¶å±ç»„</strong></p><pre><code class="bash">chgrp [-R] å±ç»„å æ–‡ä»¶å</code></pre><p>-Rï¼šé€’å½’æ›´æ”¹æ–‡ä»¶å±ç»„ï¼Œå°±æ˜¯åœ¨æ›´æ”¹æŸä¸ªç›®å½•æ–‡ä»¶çš„å±ç»„æ—¶ï¼Œå¦‚æœåŠ ä¸Š-Rçš„å‚æ•°ï¼Œé‚£ä¹ˆè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„å±ç»„éƒ½ä¼šæ›´æ”¹ã€‚</p><p><strong>2ã€chownï¼šæ›´æ”¹æ–‡ä»¶å±ä¸»ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ›´æ”¹æ–‡ä»¶å±ç»„</strong></p><pre><code class="bash">chown [â€“R] å±ä¸»å æ–‡ä»¶åchown [-R] å±ä¸»åï¼šå±ç»„å æ–‡ä»¶å</code></pre><p><strong>3ã€chmodï¼šæ›´æ”¹æ–‡ä»¶9ä¸ªå±æ€§</strong></p><pre><code class="bash">chmod [-R] xyz æ–‡ä»¶æˆ–ç›®å½•</code></pre><p>Linuxæ–‡ä»¶å±æ€§æœ‰ä¸¤ç§è®¾ç½®æ–¹æ³•ï¼Œä¸€ç§æ˜¯æ•°å­—ï¼Œä¸€ç§æ˜¯ç¬¦å·ã€‚</p><p>Linuxæ–‡ä»¶çš„åŸºæœ¬æƒé™å°±æœ‰ä¹ä¸ªï¼Œåˆ†åˆ«æ˜¯owner/group/othersä¸‰ç§èº«ä»½å„æœ‰è‡ªå·±çš„read/write/executeæƒé™ã€‚</p><p>å…ˆå¤ä¹ ä¸€ä¸‹åˆšåˆšä¸Šé¢æåˆ°çš„æ•°æ®ï¼šæ–‡ä»¶çš„æƒé™å­—ç¬¦ä¸ºï¼šã€-rwxrwxrwxã€ï¼Œ è¿™ä¹ä¸ªæƒé™æ˜¯ä¸‰ä¸ªä¸‰ä¸ªä¸€ç»„çš„ï¼å…¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°å­—æ¥ä»£è¡¨å„ä¸ªæƒé™ï¼Œå„æƒé™çš„åˆ†æ•°å¯¹ç…§è¡¨å¦‚ä¸‹ï¼š</p><pre><code class="bash">r:4     w:2         x:1</code></pre><p>æ¯ç§èº«ä»½(owner/group/others)å„è‡ªçš„ä¸‰ä¸ªæƒé™(r/w/x)åˆ†æ•°æ˜¯éœ€è¦ç´¯åŠ çš„ï¼Œä¾‹å¦‚å½“æƒé™ä¸ºï¼š[-rwxrwxâ€”] åˆ†æ•°åˆ™æ˜¯ï¼š</p><ul><li>owner = rwx = 4+2+1 = 7</li><li>group = rwx = 4+2+1 = 7</li><li>others= â€” = 0+0+0 = 0</li></ul><pre><code class="bash">chmod 770 filename</code></pre><h3><span id="æ–‡ä»¶å†…å®¹æŸ¥çœ‹">æ–‡ä»¶å†…å®¹æŸ¥çœ‹</span></h3><ul><li>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li><li>tac ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ï¼</li><li>nl  æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºé“è¾“å‡ºè¡Œå·ï¼</li><li>more ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ ç©ºæ ¼é”®è¡¨ç¤ºä¸‹ä¸€é¡µï¼Œå›è½¦é”®è¡¨ç¤ºä¸‹ä¸€è¡Œ  / å¼€å¯æŸ¥è¯¢åŠŸèƒ½   </li><li>less ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥å¾€å‰ç¿»é¡µï¼</li><li>head åªçœ‹å¤´å‡ è¡Œ</li><li>tail åªçœ‹å°¾å·´å‡ è¡Œ</li></ul><p>ifconfigæŸ¥çœ‹ç½‘ç»œé…ç½®<img src="/2021/10/13/Linux/image-20211014103811937.png" alt="image-20211014103811937"></p><h3><span id="è´¦å·ç®¡ç†">è´¦å·ç®¡ç†</span></h3><p>ç”¨æˆ·è´¦å·çš„ç®¡ç†</p><blockquote><p>æ·»åŠ è´¦å· useradd</p></blockquote><pre><code>useradd é€‰é¡¹ ç”¨æˆ·å</code></pre><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><p>é€‰é¡¹ :</p></li><li><ul><li>-c comment æŒ‡å®šä¸€æ®µæ³¨é‡Šæ€§æè¿°ã€‚</li><li>-d ç›®å½• æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•ï¼Œå¦‚æœæ­¤ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åŒæ—¶ä½¿ç”¨-mé€‰é¡¹ï¼Œå¯ä»¥åˆ›å»ºä¸»ç›®å½•ã€‚</li><li>-g ç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚</li><li>-G ç”¨æˆ·ç»„ï¼Œç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„ã€‚</li><li>-mã€€ä½¿ç”¨è€…ç›®å½•å¦‚ä¸å­˜åœ¨åˆ™è‡ªåŠ¨å»ºç«‹ã€‚</li><li>-s Shellæ–‡ä»¶ æŒ‡å®šç”¨æˆ·çš„ç™»å½•Shellã€‚</li><li>-u ç”¨æˆ·å· æŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·å·ï¼Œå¦‚æœåŒæ—¶æœ‰-oé€‰é¡¹ï¼Œåˆ™å¯ä»¥é‡å¤ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„æ ‡è¯†å·ã€‚</li></ul></li><li><p>ç”¨æˆ·å :</p></li><li><p>æŒ‡å®šæ–°è´¦å·çš„ç™»å½•åã€‚</p></li></ul><blockquote><p>Linuxä¸‹å¦‚ä½•åˆ‡æ¢ç”¨æˆ·<br>  1.åˆ‡æ¢ç”¨æˆ·çš„å‘½ä»¤ä¸ºï¼šsu username ã€usernameæ˜¯ä½ çš„ç”¨æˆ·åå“¦ã€‘</p></blockquote><blockquote><p>åˆ é™¤å¸å·  </p></blockquote><pre><code class="bash">userdel é€‰é¡¹ ç”¨æˆ·å</code></pre><p>å¸¸ç”¨çš„é€‰é¡¹æ˜¯ <strong>-r</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠç”¨æˆ·çš„ä¸»ç›®å½•ä¸€èµ·åˆ é™¤ã€‚</p><blockquote><p>ä¿®æ”¹å¸å·</p></blockquote><pre><code class="bash">usermod é€‰é¡¹ ç”¨æˆ·å</code></pre><p>å¸¸ç”¨çš„é€‰é¡¹åŒ…æ‹¬-c, -d, -m, -g, -G, -s, -uä»¥åŠ-oç­‰ï¼Œè¿™äº›é€‰é¡¹çš„æ„ä¹‰ä¸useraddå‘½ä»¤ä¸­çš„é€‰é¡¹ä¸€æ ·ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æŒ‡å®šæ–°çš„èµ„æºå€¼ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre><code class="bash"># usermod -s /bin/ksh -d /home/z â€“g developer kuangshen</code></pre><p>æ­¤å‘½ä»¤å°†ç”¨æˆ·kuangshençš„ç™»å½•Shellä¿®æ”¹ä¸ºkshï¼Œä¸»ç›®å½•æ”¹ä¸º/home/zï¼Œç”¨æˆ·ç»„æ”¹ä¸ºdeveloperã€‚</p><blockquote><p><strong>etc/passwd</strong></p></blockquote><pre><code>ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shell</code></pre><p><img src="/2021/10/13/Linux/image-20211015101642181.png" alt="image-20211015101642181"></p><p>æŸ¥çœ‹ç£ç›˜ï¼šdf -h     duæŸ¥çœ‹å½“å‰ç›®å½•ä½¿ç”¨ç©ºé—´æƒ…å†µ</p><p><img src="/2021/10/13/Linux/image-20211015110307308.png" alt="image-20211015110307308"></p><p>æŒ‚è½½</p><p><img src="/2021/10/13/Linux/image-20211015110932717.png" alt="image-20211015110932717"></p><p>å¸è½½ umount -f ã€æŒ‚è½½ä½ç½®ã€‘</p><blockquote><p>è¿›ç¨‹ç®¡ç†</p><p><img src="/2021/10/13/Linux/image-20211015115117601.png" alt="image-20211015115117601"></p></blockquote><p> pstree -pu</p><p>æ ‘çŠ¶æ˜¾ç¤ºè¿›ç¨‹</p><blockquote><p>å‘å¸ƒé¡¹ç›®</p></blockquote><p>æŠŠé¡¹ç›®æ–‡ä»¶æ‰“åŒ…æˆjaræ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><p>æŸ¥çœ‹é¡¹ç›®çš„ç«¯å£å·ï¼Œå¿…é¡»ç¡®ä¿Linuxçš„é˜²ç«å¢™ç«¯å£æ˜¯å¼€å¯çš„</p><pre><code class="bash"># æŸ¥çœ‹firewallæœåŠ¡çŠ¶æ€systemctl status firewalld# å¼€å¯ã€é‡å¯ã€å…³é—­ã€firewalld.serviceæœåŠ¡# å¼€å¯service firewalld start# é‡å¯service firewalld restart# å…³é—­service firewalld stop# æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™firewall-cmd --list-all    # æŸ¥çœ‹å…¨éƒ¨ä¿¡æ¯firewall-cmd --list-ports  # åªçœ‹ç«¯å£ä¿¡æ¯# å¼€å¯ç«¯å£å¼€ç«¯å£å‘½ä»¤ï¼šfirewall-cmd --zone=public --add-port=80/tcp --permanenté‡å¯é˜²ç«å¢™ï¼šsystemctl restart firewalld.serviceå‘½ä»¤å«ä¹‰ï¼š--zone #ä½œç”¨åŸŸ--add-port=80/tcp  #æ·»åŠ ç«¯å£ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£/é€šè®¯åè®®--permanent   #æ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆ</code></pre><blockquote><p>tomcat</p></blockquote><pre><code class="bash"># æ‰§è¡Œï¼šstartup.sh --&gt;å¯åŠ¨tomcat# æ‰§è¡Œï¼šshutdown.sh --&gt;å…³é—­tomcat./startup.sh./shutdown.sh</code></pre><h2><span id="ä¸‰ç§è½¯ä»¶å®‰è£…æ–¹å¼">ä¸‰ç§è½¯ä»¶å®‰è£…æ–¹å¼</span></h2><p>1.rpmå®‰è£…</p><p>2.è§£å‹ç¼©å®‰è£…</p><p>3.yumå®‰è£…</p><p>å„ç§å‘½ä»¤æ— æ³•è¯†åˆ«ï¼š</p><p>è§£å†³ï¼š</p><pre><code class="bash">export PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;linux&quot;&gt;Linux&lt;/span&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;/&lt;/strong&gt; ä¸ºæ ¹ç›®å½•&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/2021/10/13/Linux/image-2021101</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ç‚¹é¤ç³»ç»Ÿå¼€å‘æ—¥è®°</title>
    <link href="http://example.com/2021/09/28/%E7%82%B9%E9%A4%90%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/"/>
    <id>http://example.com/2021/09/28/%E7%82%B9%E9%A4%90%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/</id>
    <published>2021-09-28T12:23:05.000Z</published>
    <updated>2021-09-28T13:09:09.902Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="å¼€å‘æ—¥è®°">å¼€å‘æ—¥è®°</span></h1><h2><span id="day1">Day1</span></h2><p>è®¾è®¡æ•°æ®åº“</p><p><strong>decimal</strong> ç”¨æ¥è®¾è®¡ç‰©å“çš„å•ä»·</p><p>decimalæ˜¯MySQLä¸­å­˜åœ¨çš„ç²¾å‡†æ•°æ®ç±»å‹ï¼Œè¯­æ³•æ ¼å¼â€œDECIMAL(M,D)â€ã€‚å…¶ä¸­ï¼ŒMæ˜¯æ•°å­—çš„æœ€å¤§æ•°ï¼ˆç²¾åº¦ï¼‰ï¼Œå…¶èŒƒå›´ä¸ºâ€œ1ï½65â€ï¼Œé»˜è®¤å€¼æ˜¯10ï¼›Dæ˜¯å°æ•°ç‚¹å³ä¾§æ•°å­—çš„æ•°ç›®ï¼ˆæ ‡åº¦ï¼‰ï¼Œå…¶èŒƒå›´æ˜¯â€œ0ï½30â€ï¼Œä½†ä¸å¾—è¶…è¿‡Mã€‚</p><p><img src="/2021/09/28/%E7%82%B9%E9%A4%90%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/image-20210928205416256.png" alt="image-20210928205416256"></p><p>keyåŠ ç´¢å¼• keyçš„ç”¨é€”ï¼šä¸»è¦æ˜¯ç”¨æ¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦çš„ã€‚</p><p><img src="/2021/09/28/%E7%82%B9%E9%A4%90%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/image-20210928210730121.png"></p><p>æ›´æ–°æ—¶æ•°æ®åº“æ—¶è‡ªåŠ¨æ›´æ–°æ›´æ–°æ—¶é—´ å°±ç”¨  <strong>on update current_timestamp</strong></p><pre><code class="sql">`update_time` timestamp not null default current_timestamp on update current_timestamp comment &#39;ä¿®æ”¹æ—¶é—´&#39;,</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;å¼€å‘æ—¥è®°&quot;&gt;å¼€å‘æ—¥è®°&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;day1&quot;&gt;Day1&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;è®¾è®¡æ•°æ®åº“&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;decimal&lt;/strong&gt; ç”¨æ¥è®¾è®¡ç‰©å“çš„å•ä»·&lt;/p&gt;
&lt;p&gt;decimalæ˜¯My</summary>
      
    
    
    
    
    <category term="ç‚¹é¤ç³»ç»Ÿ" scheme="http://example.com/tags/%E7%82%B9%E9%A4%90%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>Spring bootéšè®°</title>
    <link href="http://example.com/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/"/>
    <id>http://example.com/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/</id>
    <published>2021-09-26T08:00:44.000Z</published>
    <updated>2021-12-04T06:20:47.248Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="spring-bootéšè®°">Spring bootéšè®°</span></h1><p><strong>çº¦å®šå¤§äºé…ç½®</strong></p><h2><span id="yamlé…ç½®">yamlé…ç½®:</span></h2><p>å®ä½“ç±»ä¸ŠåŠ </p><pre><code class="java">@ConfigurationProperties(prefix = &quot;dog&quot;)</code></pre><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20210929201905228.png" alt="image-20210929201905228"></p><p>åˆ›å»ºapplication.yamlæ–‡ä»¶</p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20210929201940747.png" alt="image-20210929201940747"></p><p>ä½¿ç”¨æ—¶ï¼š<img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20210929202014480.png" alt="image-20210929202014480"></p><h3><span id="æ¾æ•£ç»‘å®š">æ¾æ•£ç»‘å®š</span></h3><p>å®ä½“ç±»ä¸­ä¸º<strong>fistname</strong>ï¼Œyamlæ–‡ä»¶ä¸­ä¸º<strong>first-name</strong>ä¹Ÿå¯ä»¥èµ‹å€¼</p><h3><span id="jsr303æ•°æ®æ ¡éªŒ">JSR303æ•°æ®æ ¡éªŒ</span></h3><p>@validatedæ³¨è§£å®ä½“ç±»</p><pre><code class="java">@Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;) //nameå¿…é¡»æ˜¯é‚®ç®±æ ¼å¼    private String name;</code></pre><p><strong>ä½¿ç”¨æ•°æ®æ ¡éªŒï¼Œå¯ä»¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼›</strong></p><pre><code class="java">@NotNull(message=&quot;åå­—ä¸èƒ½ä¸ºç©º&quot;)private String userName;@Max(value=120,message=&quot;å¹´é¾„æœ€å¤§ä¸èƒ½æŸ¥è¿‡120&quot;)private int age;@Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;)private String email;ç©ºæ£€æŸ¥@Null       éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ºnull@NotNull    éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ä¸ºnull, æ— æ³•æŸ¥æ£€é•¿åº¦ä¸º0çš„å­—ç¬¦ä¸²@NotBlank   æ£€æŸ¥çº¦æŸå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯Nullè¿˜æœ‰è¢«Trimçš„é•¿åº¦æ˜¯å¦å¤§äº0,åªå¯¹å­—ç¬¦ä¸²,ä¸”ä¼šå»æ‰å‰åç©ºæ ¼.@NotEmpty   æ£€æŸ¥çº¦æŸå…ƒç´ æ˜¯å¦ä¸ºNULLæˆ–è€…æ˜¯EMPTY.    Booelanæ£€æŸ¥@AssertTrue     éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º true  @AssertFalse    éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º false      é•¿åº¦æ£€æŸ¥@Size(min=, max=) éªŒè¯å¯¹è±¡ï¼ˆArray,Collection,Map,Stringï¼‰é•¿åº¦æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´ä¹‹å†…  @Length(min=, max=) string is between min and max included.æ—¥æœŸæ£€æŸ¥@Past       éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å‰  @Future     éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å  @Pattern    éªŒè¯ String å¯¹è±¡æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™.......ç­‰ç­‰é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æ•°æ®æ ¡éªŒè§„åˆ™</code></pre><p>yamlæ–‡ä»¶ä¼˜å…ˆçº§ï¼š<br>ä¼˜å…ˆçº§1ï¼šé¡¹ç›®è·¯å¾„ä¸‹çš„configæ–‡ä»¶å¤¹é…ç½®æ–‡ä»¶</p><p>ä¼˜å…ˆçº§2ï¼šé¡¹ç›®è·¯å¾„ä¸‹é…ç½®æ–‡ä»¶</p><p>ä¼˜å…ˆçº§3ï¼šèµ„æºè·¯å¾„ä¸‹çš„configæ–‡ä»¶å¤¹é…ç½®æ–‡ä»¶</p><p>ä¼˜å…ˆçº§4ï¼šèµ„æºè·¯å¾„ä¸‹é…ç½®æ–‡ä»¶</p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20210929204121922.png" alt="image-20210929204121922"></p><p>å¤šç¯å¢ƒå¼€å‘ï¼š</p><pre><code class="yaml">server:  port: 8080#é€‰æ‹©è¦æ¿€æ´»é‚£ä¸ªç¯å¢ƒå—spring:  profiles:    active: prod---server:  port: 8081spring:  profiles: prod---server:  port: 8082spring:  profiles: dev</code></pre><h3><span id="è‡ªåŠ¨é…ç½®åŸç†">è‡ªåŠ¨é…ç½®åŸç†ï¼š</span></h3><p>ä¾‹å­ï¼š</p><pre><code class="java">//è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œå’Œä»¥å‰ç¼–å†™çš„é…ç½®æ–‡ä»¶ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼›@Configuration //å¯åŠ¨æŒ‡å®šç±»çš„ConfigurationPropertiesåŠŸèƒ½ï¼›  //è¿›å…¥è¿™ä¸ªHttpPropertiesæŸ¥çœ‹ï¼Œå°†é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„å€¼å’ŒHttpPropertiesç»‘å®šèµ·æ¥ï¼›  //å¹¶æŠŠHttpPropertiesåŠ å…¥åˆ°iocå®¹å™¨ä¸­@EnableConfigurationProperties(&#123;HttpProperties.class&#125;) //Springåº•å±‚@Conditionalæ³¨è§£  //æ ¹æ®ä¸åŒçš„æ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³æŒ‡å®šçš„æ¡ä»¶ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„é…ç½®å°±ä¼šç”Ÿæ•ˆï¼›  //è¿™é‡Œçš„æ„æ€å°±æ˜¯åˆ¤æ–­å½“å‰åº”ç”¨æ˜¯å¦æ˜¯webåº”ç”¨ï¼Œå¦‚æœæ˜¯ï¼Œå½“å‰é…ç½®ç±»ç”Ÿæ•ˆ@ConditionalOnWebApplication(    type = Type.SERVLET)//åˆ¤æ–­å½“å‰é¡¹ç›®æœ‰æ²¡æœ‰è¿™ä¸ªç±»CharacterEncodingFilterï¼›SpringMVCä¸­è¿›è¡Œä¹±ç è§£å†³çš„è¿‡æ»¤å™¨ï¼›@ConditionalOnClass(&#123;CharacterEncodingFilter.class&#125;)//åˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé…ç½®ï¼šspring.http.encoding.enabledï¼›  //å¦‚æœä¸å­˜åœ¨ï¼Œåˆ¤æ–­ä¹Ÿæ˜¯æˆç«‹çš„  //å³ä½¿æˆ‘ä»¬é…ç½®æ–‡ä»¶ä¸­ä¸é…ç½®pring.http.encoding.enabled=trueï¼Œä¹Ÿæ˜¯é»˜è®¤ç”Ÿæ•ˆçš„ï¼›@ConditionalOnProperty(    prefix = &quot;spring.http.encoding&quot;,    value = &#123;&quot;enabled&quot;&#125;,    matchIfMissing = true)public class HttpEncodingAutoConfiguration &#123;    //ä»–å·²ç»å’ŒSpringBootçš„é…ç½®æ–‡ä»¶æ˜ å°„äº†    private final Encoding properties;    //åªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨çš„æƒ…å†µä¸‹ï¼Œå‚æ•°çš„å€¼å°±ä¼šä»å®¹å™¨ä¸­æ‹¿    public HttpEncodingAutoConfiguration(HttpProperties properties) &#123;        this.properties = properties.getEncoding();    &#125;        //ç»™å®¹å™¨ä¸­æ·»åŠ ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶çš„æŸäº›å€¼éœ€è¦ä»propertiesä¸­è·å–    @Bean    @ConditionalOnMissingBean //åˆ¤æ–­å®¹å™¨æ²¡æœ‰è¿™ä¸ªç»„ä»¶ï¼Ÿ    public CharacterEncodingFilter characterEncodingFilter() &#123;        CharacterEncodingFilter filter = new OrderedCharacterEncodingFilter();        filter.setEncoding(this.properties.getCharset().name());        filter.setForceRequestEncoding(this.properties.shouldForce(org.springframework.boot.autoconfigure.http.HttpProperties.Encoding.Type.REQUEST));        filter.setForceResponseEncoding(this.properties.shouldForce(org.springframework.boot.autoconfigure.http.HttpProperties.Encoding.Type.RESPONSE));        return filter;    &#125;    //ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&#125;</code></pre><p><strong>æ ¹æ®å½“å‰ä¸åŒçš„æ¡ä»¶åˆ¤æ–­ï¼Œå†³å®šè¿™ä¸ªé…ç½®ç±»æ˜¯å¦ç”Ÿæ•ˆï¼</strong></p><p>å¤§ä½“ç»“æ„ï¼š</p><pre><code class="Java">//ä»é…ç½®æ–‡ä»¶ä¸­è·å–æŒ‡å®šçš„å€¼å’Œbeançš„å±æ€§è¿›è¡Œç»‘å®š@ConfigurationProperties(prefix = &quot;spring.http&quot;) public class HttpProperties &#123;    // .....&#125;</code></pre><h3><span id="mvcè‡ªåŠ¨é…ç½®åŸç†">mvcè‡ªåŠ¨é…ç½®åŸç†</span></h3><pre><code class="java">Spring MVC Auto-configuration// Spring Bootä¸ºSpring MVCæä¾›äº†è‡ªåŠ¨é…ç½®ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°ä¸å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸€èµ·å·¥ä½œã€‚Spring Boot provides auto-configuration for Spring MVC that works well with most applications.// è‡ªåŠ¨é…ç½®åœ¨Springé»˜è®¤è®¾ç½®çš„åŸºç¡€ä¸Šæ·»åŠ äº†ä»¥ä¸‹åŠŸèƒ½ï¼šThe auto-configuration adds the following features on top of Springâ€™s defaults:// åŒ…å«è§†å›¾è§£æå™¨Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.// æ”¯æŒé™æ€èµ„æºæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œä»¥åŠwebjarsSupport for serving static resources, including support for WebJars // è‡ªåŠ¨æ³¨å†Œäº†Converterï¼š// è½¬æ¢å™¨ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç½‘é¡µæäº¤æ•°æ®åˆ°åå°è‡ªåŠ¨å°è£…æˆä¸ºå¯¹è±¡çš„ä¸œè¥¿ï¼Œæ¯”å¦‚æŠŠ&quot;1&quot;å­—ç¬¦ä¸²è‡ªåŠ¨è½¬æ¢ä¸ºintç±»å‹// Formatterï¼šã€æ ¼å¼åŒ–å™¨ï¼Œæ¯”å¦‚é¡µé¢ç»™æˆ‘ä»¬äº†ä¸€ä¸ª2019-8-10ï¼Œå®ƒä¼šç»™æˆ‘ä»¬è‡ªåŠ¨æ ¼å¼åŒ–ä¸ºDateå¯¹è±¡ã€‘Automatic registration of Converter, GenericConverter, and Formatter beans.// HttpMessageConverters// SpringMVCç”¨æ¥è½¬æ¢Httpè¯·æ±‚å’Œå“åº”çš„çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æŠŠä¸€ä¸ªUserå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¯ä»¥å»çœ‹å®˜ç½‘æ–‡æ¡£è§£é‡Šï¼›Support for HttpMessageConverters (covered later in this document).// å®šä¹‰é”™è¯¯ä»£ç ç”Ÿæˆè§„åˆ™çš„Automatic registration of MessageCodesResolver (covered later in this document).// é¦–é¡µå®šåˆ¶Static index.html support.// å›¾æ ‡å®šåˆ¶Custom Favicon support (covered later in this document).// åˆå§‹åŒ–æ•°æ®ç»‘å®šå™¨ï¼šå¸®æˆ‘ä»¬æŠŠè¯·æ±‚æ•°æ®ç»‘å®šåˆ°JavaBeanä¸­ï¼Automatic use of a ConfigurableWebBindingInitializer bean (covered later in this document)./*å¦‚æœæ‚¨å¸Œæœ›ä¿ç•™Spring Boot MVCåŠŸèƒ½ï¼Œå¹¶ä¸”å¸Œæœ›æ·»åŠ å…¶ä»–MVCé…ç½®ï¼ˆæ‹¦æˆªå™¨ã€æ ¼å¼åŒ–ç¨‹åºã€è§†å›¾æ§åˆ¶å™¨å’Œå…¶ä»–åŠŸèƒ½ï¼‰ï¼Œåˆ™å¯ä»¥æ·»åŠ è‡ªå·±çš„@configurationç±»ï¼Œç±»å‹ä¸ºwebmvcconfiguerï¼Œä½†ä¸æ·»åŠ @EnableWebMvcã€‚å¦‚æœå¸Œæœ›æä¾›RequestMappingHandlerMappingã€RequestMappingHandlerAdapteræˆ–ExceptionHandlerExceptionResolverçš„è‡ªå®šä¹‰å®ä¾‹ï¼Œåˆ™å¯ä»¥å£°æ˜WebMVCregistrationAdapterå®ä¾‹æ¥æä¾›æ­¤ç±»ç»„ä»¶ã€‚*/If you want to keep Spring Boot MVC features and you want to add additional MVC configuration (interceptors, formatters, view controllers, and other features), you can add your own @Configuration class of type WebMvcConfigurer but without @EnableWebMvc. If you wish to provide custom instances of RequestMappingHandlerMapping, RequestMappingHandlerAdapter, or ExceptionHandlerExceptionResolver, you can declare a WebMvcRegistrationsAdapter instance to provide such components.// å¦‚æœæ‚¨æƒ³å®Œå…¨æ§åˆ¶Spring MVCï¼Œå¯ä»¥æ·»åŠ è‡ªå·±çš„@Configurationï¼Œå¹¶ç”¨@EnableWebMvcè¿›è¡Œæ³¨é‡Šã€‚If you want to take complete control of Spring MVC, you can add your own @Configuration annotated with @EnableWebMvc.</code></pre><h3><span id="å›½é™…åŒ–">å›½é™…åŒ–</span></h3><p><strong>1.è®¾ç½®propertiesçš„ç¼–ç é—®é¢˜</strong></p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211003204335787.png" alt="image-20211003204335787"></p><p><strong>2</strong>.<img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211003204447879.png" alt="image-20211003204447879"></p><p>â€‹    <strong>å»ºç«‹è¯­è¨€é…ç½®æ–‡ä»¶ï¼š</strong></p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211003204931853.png" alt="image-20211003204931853"></p><p><strong>3.æ¥ä¸‹æ¥å°±æ˜¯è®©springbootè¯†åˆ«æˆ‘ä»¬å¯¹äºå›½é™…åŒ–çš„ä¸ªæ€§é…ç½®ï¼Œäºæ˜¯æ¶‰åŠåˆ°äº†spring bootçš„è‡ªåŠ¨é…ç½®    MessageSourcePropertiesç±»</strong></p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211003205859135.png" alt="image-20211003205859135"></p><p><em>// è®¾ç½®å›½é™…åŒ–æ–‡ä»¶çš„åŸºç¡€åï¼ˆå»æ‰è¯­è¨€å›½å®¶ä»£ç çš„ï¼‰</em></p><pre><code class="properties">spring.messages.basename=i18n.login</code></pre><p><strong>4.é…ç½®å›½é™…åŒ–è§£æ</strong></p><p>åœ¨Springä¸­æœ‰ä¸€ä¸ªå›½é™…åŒ–çš„Locale ï¼ˆåŒºåŸŸä¿¡æ¯å¯¹è±¡ï¼‰ï¼›é‡Œé¢æœ‰ä¸€ä¸ªå«åšLocaleResolver ï¼ˆè·å–åŒºåŸŸä¿¡æ¯å¯¹è±¡ï¼‰çš„è§£æå™¨ï¼</p><p>é‚£å‡å¦‚æˆ‘ä»¬ç°åœ¨æƒ³ç‚¹å‡»é“¾æ¥è®©æˆ‘ä»¬çš„å›½é™…åŒ–èµ„æºç”Ÿæ•ˆï¼Œå°±éœ€è¦è®©æˆ‘ä»¬è‡ªå·±çš„Localeç”Ÿæ•ˆï¼æˆ‘ä»¬å»è‡ªå·±å†™ä¸€ä¸ªè‡ªå·±çš„LocaleResolverï¼Œå¯ä»¥åœ¨é“¾æ¥ä¸Šæºå¸¦åŒºåŸŸä¿¡æ¯ï¼</p><pre><code class="html">&lt;!-- è¿™é‡Œä¼ å…¥å‚æ•°ä¸éœ€è¦ä½¿ç”¨ ï¼Ÿä½¿ç”¨ ï¼ˆkey=valueï¼‰--&gt;&lt;a class=&quot;btn btn-sm&quot; th:href=&quot;@&#123;/index.html(l=&#39;zh_CN&#39;)&#125;&quot;&gt;ä¸­æ–‡&lt;/a&gt;&lt;a class=&quot;btn btn-sm&quot; th:href=&quot;@&#123;/index.html(l=&#39;en_US&#39;)&#125;&quot;&gt;English&lt;/a&gt;</code></pre><h4><span id="ç¼–å†™ä¸€ä¸ªå¤„ç†çš„ç»„ä»¶ç±»">ç¼–å†™ä¸€ä¸ªå¤„ç†çš„ç»„ä»¶ç±»</span></h4><pre><code class="java">package com.zz.springboot03web.config;import org.springframework.util.StringUtils;import org.springframework.web.servlet.LocaleResolver;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.util.Locale;public class MyLocaleResolver implements LocaleResolver &#123;    @Override    public Locale resolveLocale(HttpServletRequest request) &#123;        String language=request.getParameter(&quot;l&quot;);        Locale locale=Locale.getDefault();//å¦‚æœæ²¡æœ‰è·å–åˆ°å°±ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„        //å¦‚æœéœ€æ±‚é“¾æ¥ä¸ä¸ºç©º        if(!StringUtils.isEmpty(language))&#123;            //åˆ†å‰²è¯·æ±‚éœ€æ±‚            String [] split=language.split(&quot;_&quot;);            locale=new Locale(split[0],split[1]);        &#125;        return locale;    &#125;    @Override    public void setLocale(HttpServletRequest request, HttpServletResponse response, Locale locale) &#123;    &#125;&#125;</code></pre><p><strong>ä¸ºäº†ä½¿è‡ªå·±å®šä¹‰çš„ç»„ä»¶ç”Ÿæ•ˆï¼Œåœ¨æˆ‘ä»¬è‡ªå·±çš„MvcConofigä¸‹æ·»åŠ bean</strong></p><pre><code class="Java">@Beanpublic LocaleResolver localeResolver()&#123;    return new MyLocaleResolver();&#125;</code></pre><h2><span id="ä½¿ç”¨addviewcontrollerå®ç°æ— ä¸šåŠ¡é€»è¾‘è·³è½¬">ä½¿ç”¨addviewController()å®ç°æ— ä¸šåŠ¡é€»è¾‘è·³è½¬</span></h2><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211004174440961.png" alt="image-20211004174440961"></p><p>æ•ˆæœï¼šå®é™…è·³è½¬åˆ°äº†test.htmlé¡µé¢</p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211004174507934.png" alt="image-20211004174507934"></p><h2><span id="requestparamå’Œpathvariable">@RequestParamå’Œ@PathVariable</span></h2><blockquote><p> ç›¸åŒç‚¹ä¸åŒºåˆ«</p></blockquote><p> @RequestParamå’Œ@PathVariableéƒ½èƒ½å¤Ÿå®Œæˆç±»ä¼¼çš„åŠŸèƒ½â€”â€”å› ä¸ºæœ¬è´¨ä¸Šï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨æˆ·çš„è¾“å…¥ï¼Œåªä¸è¿‡è¾“å…¥çš„éƒ¨åˆ†ä¸åŒï¼Œä¸€ä¸ªåœ¨URLè·¯å¾„éƒ¨åˆ†ï¼Œå¦ä¸€ä¸ªåœ¨å‚æ•°éƒ¨åˆ†ã€‚è¦è®¿é—®ä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œè¿™ä¸¤ç§URLè®¾è®¡éƒ½æ˜¯å¯ä»¥çš„ï¼š</p><ul><li>é€šè¿‡@PathVariableï¼Œä¾‹å¦‚/blogs/1</li><li>é€šè¿‡@RequestParamï¼Œä¾‹å¦‚blogs?blogId=1</li></ul><p>é‚£ä¹ˆç©¶ç«Ÿåº”è¯¥é€‰æ‹©å“ªä¸€ç§å‘¢ï¼Ÿå»ºè®®ï¼š</p><p>1ã€å½“URLæŒ‡å‘çš„æ˜¯æŸä¸€å…·ä½“ä¸šåŠ¡èµ„æºï¼ˆæˆ–èµ„æºåˆ—è¡¨ï¼‰ï¼Œä¾‹å¦‚åšå®¢ï¼Œç”¨æˆ·æ—¶ï¼Œä½¿ç”¨@PathVariable</p><p>2ã€å½“URLéœ€è¦å¯¹èµ„æºæˆ–è€…èµ„æºåˆ—è¡¨è¿›è¡Œè¿‡æ»¤ï¼Œç­›é€‰æ—¶ï¼Œç”¨@RequestParam</p><p>ä¾‹å¦‚æˆ‘ä»¬ä¼šè¿™æ ·è®¾è®¡URLï¼š</p><ul><li>/blogs/{blogId}</li><li>/blogs?state=publishè€Œä¸æ˜¯/blogs/state/publishæ¥è¡¨ç¤ºå¤„äºå‘å¸ƒçŠ¶æ€çš„åšå®¢æ–‡ç« </li></ul><h2><span id="å®‰å…¨shiro-springsecurity">å®‰å…¨ï¼ˆshiro  SpringSecurityï¼‰</span></h2><h3><span id="shiro">shiro</span></h3><h4><span id="ç»“åˆæ•°æ®åº“è¿›è¡ŒéªŒè¯å’Œæˆæƒ">ç»“åˆæ•°æ®åº“è¿›è¡ŒéªŒè¯å’Œæˆæƒ</span></h4><p>å®é™…å·¥ä½œä¸­ï¼Œæˆ‘ä»¬éƒ½ä¼šæŠŠæƒé™ç›¸å…³çš„å†…å®¹æ”¾åœ¨æ•°æ®åº“ä¸­</p><p>åŸºäº <a href="https://how2j.cn/k/shiro/shiro-database/1721.html#step7539">RBAC æ¦‚å¿µ</a>ï¼Œ å°±ä¼šå­˜åœ¨3 å¼ åŸºç¡€è¡¨ï¼š ç”¨æˆ·ï¼Œè§’è‰²ï¼Œæƒé™ï¼Œ ä»¥åŠ 2 å¼ ä¸­é—´è¡¨æ¥å»ºç«‹ ç”¨æˆ·ä¸è§’è‰²çš„å¤šå¯¹å¤šå…³ç³»ï¼Œè§’è‰²ä¸æƒé™çš„å¤šå¯¹å¤šå…³ç³»ã€‚ ç”¨æˆ·ä¸æƒé™ä¹‹é—´ä¹Ÿæ˜¯å¤šå¯¹å¤šå…³ç³»ï¼Œä½†æ˜¯æ˜¯é€šè¿‡ è§’è‰²é—´æ¥å»ºç«‹çš„ã€‚</p><h5><span id="ä¸€">ä¸€</span></h5><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211009223652791.png" alt="image-20211009223652791"></p><h5><span id="äºŒ">äºŒ</span></h5><p><strong>æ’å…¥æ¨¡æ‹Ÿæ•°æ®</strong></p><h5><span id="ä¸‰">ä¸‰</span></h5><p>Daoç±»</p><p><strong>æä¾›äº†å’Œæƒé™ç›¸å…³æŸ¥è¯¢</strong></p><h5><span id="å››">å››</span></h5><p>DatabaseRealm å°±æ˜¯ç”¨æ¥é€šè¿‡æ•°æ®åº“ éªŒè¯ç”¨æˆ·ï¼Œå’Œç›¸å…³æˆæƒçš„ç±»ã€‚ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«åšéªŒè¯å’Œæˆæƒï¼š<br>doGetAuthenticationInfo(), doGetAuthorizationInfo()</p><p>è¿™ä¸ªç±»ç”±ç”¨æˆ·æä¾›ï¼Œä½†æ˜¯ä¸ç”±ç”¨æˆ·è‡ªå·±è°ƒç”¨ï¼Œè€Œæ˜¯ç”± Shiro å»è°ƒç”¨ã€‚ä»è€Œåœ¨shiro.iniä¸­é…ç½®</p><pre><code class="java">public class DatabaseRealm extends AuthorizingRealm&#123;    @Override    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) &#123;        //èƒ½è¿›å…¥åˆ°è¿™é‡Œï¼Œè¡¨ç¤ºè´¦å·å·²ç»é€šè¿‡éªŒè¯äº†        String userName =(String)principals.getPrimaryPrincipal();        //é€šè¿‡DAOè·å–è§’è‰²å’Œæƒé™        Set&lt;String&gt; permissions = new Dao().listPermissions(userName);        Set&lt;String&gt; roles = new Dao().listRoles(userName);        //æˆæƒå¯¹è±¡        SimpleAuthorizationInfo s = new SimpleAuthorizationInfo();        //æŠŠé€šè¿‡DAOè·å–åˆ°çš„è§’è‰²å’Œæƒé™æ”¾è¿›å»        s.setStringPermissions(permissions);        s.setRoles(roles);        return s;    &#125;    @Override    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException &#123;        //è·å–è´¦å·å¯†ç         UsernamePasswordToken t = (UsernamePasswordToken) token;        String userName= token.getPrincipal().toString();        String password= new String( t.getPassword());        //è·å–æ•°æ®åº“ä¸­çš„å¯†ç         String passwordInDB = new Dao().getPassword(userName);        //å¦‚æœä¸ºç©ºå°±æ˜¯è´¦å·ä¸å­˜åœ¨ï¼Œå¦‚æœä¸ç›¸åŒå°±æ˜¯å¯†ç é”™è¯¯ï¼Œä½†æ˜¯éƒ½æŠ›å‡ºAuthenticationExceptionï¼Œè€Œä¸æ˜¯æŠ›å‡ºå…·ä½“é”™è¯¯åŸå› ï¼Œå…å¾—ç»™ç ´è§£è€…æä¾›å¸®åŠ©ä¿¡æ¯        if(null==passwordInDB || !passwordInDB.equals(password))&#123;            throw new AuthenticationException();&#125;        //è®¤è¯ä¿¡æ¯é‡Œå­˜æ”¾è´¦å·å¯†ç , getName() æ˜¯å½“å‰Realmçš„ç»§æ‰¿æ–¹æ³•,é€šå¸¸è¿”å›å½“å‰ç±»å :databaseRealm        SimpleAuthenticationInfo a = new SimpleAuthenticationInfo(userName,password,getName());        return a;    &#125;    &#125;</code></pre><h5><span id="äº”">äº”</span></h5><pre><code class="ini">[main]databaseRealm=DatabaseRealmsecurityManager.realms=$databaseRealm</code></pre><h5><span id="ç»“æŸ-Ì€-Ï‰-Ì">ç»“æŸ( â€¢Ì€ Ï‰ â€¢Ì )âœ§</span></h5><h4><span id="åŠ å¯†">åŠ å¯†</span></h4><h2><span id="swagger">swagger</span></h2><h3><span id="é…ç½®swagger">é…ç½®swagger</span></h3><p>ï¼ˆSwaggerå®ä¾‹Beanæ˜¯Docketï¼Œæ‰€ä»¥é€šè¿‡é…ç½®Docketå®ä¾‹æ¥é…ç½®Swagggerã€‚ï¼‰</p><p>  å¯ä»¥é€šè¿‡apiInfo()å±æ€§é…ç½®æ–‡æ¡£ä¿¡æ¯</p><pre><code class="java"> //é…ç½®æ–‡æ¡£ä¿¡æ¯    private ApiInfo apiInfo() &#123;        Contact contact = new Contact(&quot;gzz&quot;, &quot;https://www.zhihu.com/people/sjbja&quot;, &quot;https://weibo.com/u/7194380917?is_all=1&quot;);        return new ApiInfo(                &quot;Swaggerå­¦ä¹ &quot;, // æ ‡é¢˜                &quot;å­¦ä¹ æ¼”ç¤ºå¦‚ä½•é…ç½®Swagger&quot;, // æè¿°                &quot;v1.0&quot;, // ç‰ˆæœ¬                &quot;https://user.qzone.qq.com/1614399965?source=namecardhoverqzone&quot;, // ç»„ç»‡é“¾æ¥                contact, // è”ç³»äººä¿¡æ¯                &quot;Apach 2.0 è®¸å¯&quot;, // è®¸å¯                &quot;è®¸å¯é“¾æ¥&quot;, // è®¸å¯è¿æ¥                new ArrayList&lt;&gt;()// æ‰©å±•        );    &#125;//Docket å®ä¾‹å…³è”ä¸Š apiInfo()@Beanpublic Docket docket() &#123;   return new Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo());&#125;</code></pre><h3><span id="é…ç½®æ¥å£æ‰«æä¿¡æ¯">é…ç½®æ¥å£æ‰«æä¿¡æ¯</span></h3><pre><code class="java"> .select()// é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£ .apis(RequestHandlerSelectors.basePackage(&quot;com.kuang.swagger.controller&quot;)) .build();</code></pre><p>ä¸Šé¢ä¸ºæ ¹æ®åŒ…è·¯å¾„æ‰«ææ¥å£</p><p><strong>å…¶ä»–é…ç½®æ‰«ææ¥å£çš„æ–¹å¼ï¼š</strong></p><pre><code class="java">any() // æ‰«ææ‰€æœ‰ï¼Œé¡¹ç›®ä¸­çš„æ‰€æœ‰æ¥å£éƒ½ä¼šè¢«æ‰«æåˆ°none() // ä¸æ‰«ææ¥å£// é€šè¿‡æ–¹æ³•ä¸Šçš„æ³¨è§£æ‰«æï¼Œå¦‚withMethodAnnotation(GetMapping.class)åªæ‰«ægetè¯·æ±‚withMethodAnnotation(final Class&lt;? extends Annotation&gt; annotation)// é€šè¿‡ç±»ä¸Šçš„æ³¨è§£æ‰«æï¼Œå¦‚.withClassAnnotation(Controller.class)åªæ‰«ææœ‰controlleræ³¨è§£çš„ç±»ä¸­çš„æ¥å£withClassAnnotation(final Class&lt;? extends Annotation&gt; annotation)</code></pre><p>è¿˜å¯ä»¥é…ç½®æ¥å£æ‰«æè¿‡æ»¤ï¼š</p><pre><code class="Java"> // é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/kuangå¼€å¤´çš„æ¥å£      .paths(PathSelectors.ant(&quot;/kuang/**&quot;))</code></pre><p>é…ç½®å¼€å…³</p><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211010183122574.png" alt="image-20211010183122574"></p><p>æ•ˆæœå›¾ï¼š<img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211010183203887.png" alt="image-20211010183203887"></p><h3><span id="åŠ¨æ€é…ç½®å½“é¡¹ç›®å¤„äºtest-devç¯å¢ƒæ—¶æ˜¾ç¤ºswaggerå¤„äºprodæ—¶ä¸æ˜¾ç¤º">åŠ¨æ€é…ç½®å½“é¡¹ç›®å¤„äºtestã€devç¯å¢ƒæ—¶æ˜¾ç¤ºswaggerï¼Œå¤„äºprodæ—¶ä¸æ˜¾ç¤º</span></h3><pre><code class="java">@Bean    public Docket docket(Environment environment)&#123;        // è®¾ç½®è¦æ˜¾ç¤ºswaggerçš„ç¯å¢ƒ        Profiles of = Profiles.of(&quot;dev&quot;, &quot;test&quot;);        // åˆ¤æ–­å½“å‰æ˜¯å¦å¤„äºè¯¥ç¯å¢ƒ        // é€šè¿‡ enable() æ¥æ”¶æ­¤å‚æ•°åˆ¤æ–­æ˜¯å¦è¦æ˜¾ç¤º        boolean b = environment.acceptsProfiles(of);        return new Docket(DocumentationType.SWAGGER_2)                .apiInfo(apiInfo())                .enable(b) //é…ç½®æ˜¯å¦å¯ç”¨Swaggerï¼Œå¦‚æœæ˜¯falseï¼Œåœ¨æµè§ˆå™¨å°†æ— æ³•è®¿é—®                .select()// é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£                .apis(RequestHandlerSelectors.basePackage(&quot;com.kuang.swagger.controller&quot;))                // é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/kuangå¼€å¤´çš„æ¥å£                .paths(PathSelectors.ant(&quot;/kuang/**&quot;))                .build();    &#125;</code></pre><h3><span id="é…ç½®apiåˆ†ç»„">é…ç½®apiåˆ†ç»„</span></h3><h4><span id="ç»™è‡ªå·±åˆ†é…ç»„">ç»™è‡ªå·±åˆ†é…ç»„</span></h4><pre><code>.groupName(&quot;wtt&quot;)// é…ç½®åˆ†ç»„</code></pre><h4><span id="é…ç½®å¤šä¸ªåˆ†ç»„">é…ç½®å¤šä¸ªåˆ†ç»„</span></h4><pre><code class="java">@Bean    public Docket docket1()&#123;        return new Docket(DocumentationType.SWAGGER_2).groupName(&quot;group1&quot;);    &#125;    @Bean    public Docket docket2()&#123;        return new Docket(DocumentationType.SWAGGER_2).groupName(&quot;group2&quot;);    &#125;    @Bean    public Docket docket3()&#123;        return new Docket(DocumentationType.SWAGGER_2).groupName(&quot;group3&quot;);    &#125;</code></pre><h3><span id="å®ä½“é…ç½®">å®ä½“é…ç½®</span></h3><h4><span id="æ–°å»ºå®ä½“ç±»">æ–°å»ºå®ä½“ç±»</span></h4><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211010192744837.png" alt="image-20211010192744837"></p><h4><span id="åœ¨controllerä¸­é…ç½®æ¥å£">åœ¨controllerä¸­é…ç½®æ¥å£</span></h4><p><img src="/2021/09/26/Spring-boot%E9%9A%8F%E8%AE%B0/image-20211010192927354.png" alt="image-20211010192927354"></p><h2><span id="å¼‚æ­¥-å®šæ—¶-é‚®ä»¶ä»»åŠ¡">å¼‚æ­¥ã€å®šæ—¶ã€é‚®ä»¶ä»»åŠ¡</span></h2><h6><span id="å¼‚æ­¥å‰å°å‘é€é‚®ä»¶ç‚¹å‡»å‘é€å‰å°ç¬é—´å“åº”åå°è¿›è¡Œå¤šçº¿ç¨‹å¤„ç†">å¼‚æ­¥ï¼šå‰å°å‘é€é‚®ä»¶ï¼Œç‚¹å‡»å‘é€å‰å°ç¬é—´å“åº”ï¼Œåå°è¿›è¡Œå¤šçº¿ç¨‹å¤„ç†</span></h6><p>å®ç°å¼‚æ­¥æ–¹æ³•ï¼š<br>åœ¨éœ€å®ç°å¼‚æ­¥çš„æ–¹æ³•ä¸ŠåŠ </p><pre><code class="java">//å‘Šè¯‰Springè¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•@Async</code></pre><p>åœ¨ä¸»ç¨‹åºä¸ŠåŠ </p><pre><code class="java">@EnableAsync //å¼€å¯å¼‚æ­¥æ³¨è§£åŠŸèƒ½</code></pre><p>å®ŒæˆğŸ‡ğŸ‡ğŸ‡</p><h6><span id="å®šæ—¶å’Œå‘é€é‚®ä»¶ç»„åˆèµ·æ¥å¯å®ç°å®šæ—¶é‚®ä»¶åŠŸèƒ½">å®šæ—¶å’Œå‘é€é‚®ä»¶ï¼šç»„åˆèµ·æ¥å¯å®ç°å®šæ—¶é‚®ä»¶åŠŸèƒ½</span></h6><p>å¯¼å…¥é‚®ä»¶ä¾èµ–ï¼š</p><pre><code class="xml">&lt;dependency&gt;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;&lt;/dependency&gt;</code></pre><p>å®šæ—¶æœ‰ä¸¤ä¸ªæ³¨è§£ï¼Œå®ç°å½¢å¼å’Œå¼‚æ­¥å·®ä¸å¤šï¼š</p><pre><code class="java">  @Scheduled(cron = &quot;0 0/2 * * * ? &quot;)//æ­¤æ³¨è§£æ”¾åœ¨è¦å®ç°å®šæ—¶ä»»åŠ¡çš„æ–¹æ³•ä¸Š  @EnableScheduling //å¼€å¯åŸºäºæ³¨è§£çš„å®šæ—¶ä»»åŠ¡ï¼Œæ”¾åœ¨ä¸»ç¨‹åºä¸Š</code></pre><p>é‚®ä»¶é…ç½®ï¼š</p><pre><code class="properties">spring.mail.username=1614399965@qq.com#æˆæƒç spring.mail.password=zuursxqcywrddfhfspring.mail.host=smtp.qq.com# qqéœ€è¦é…ç½®sslspring.mail.properties.mail.smtp.ssl.enable=true</code></pre><p>å‘é€ä¸€ä¸ªä¸¤åˆ†é’Ÿä¸€æ¬¡çš„é‚®ä»¶ï¼š</p><pre><code class="java">@Scheduled(cron = &quot;0 0/2 * * * ? &quot;)public void sendEmailTo()&#123;    //é‚®ä»¶è®¾ç½®1ï¼šä¸€ä¸ªç®€å•çš„é‚®ä»¶    SimpleMailMessage message = new SimpleMailMessage();    message.setSubject(&quot;Love tt&quot;);    message.setText(&quot;ä¸€ç”Ÿæ‰€çˆ±&quot;);    message.setTo(&quot;1614399965@qq.com&quot;);    message.setFrom(&quot;1614399965@qq.com&quot;);    mailSender.send(message);&#125;</code></pre><p>å¸¸ç”¨çš„è¡¨è¾¾å¼</p><pre><code>ï¼ˆ1ï¼‰0/2 * * * * ?   è¡¨ç¤ºæ¯2ç§’ æ‰§è¡Œä»»åŠ¡ï¼ˆ1ï¼‰0 0/2 * * * ?   è¡¨ç¤ºæ¯2åˆ†é’Ÿ æ‰§è¡Œä»»åŠ¡ï¼ˆ1ï¼‰0 0 2 1 * ?   è¡¨ç¤ºåœ¨æ¯æœˆçš„1æ—¥çš„å‡Œæ™¨2ç‚¹è°ƒæ•´ä»»åŠ¡ï¼ˆ2ï¼‰0 15 10 ? * MON-FRI   è¡¨ç¤ºå‘¨ä¸€åˆ°å‘¨äº”æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä½œä¸šï¼ˆ3ï¼‰0 15 10 ? 6L 2002-2006   è¡¨ç¤º2002-2006å¹´çš„æ¯ä¸ªæœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15æ‰§è¡Œä½œï¼ˆ4ï¼‰0 0 10,14,16 * * ?   æ¯å¤©ä¸Šåˆ10ç‚¹ï¼Œä¸‹åˆ2ç‚¹ï¼Œ4ç‚¹ï¼ˆ5ï¼‰0 0/30 9-17 * * ?   æœä¹æ™šäº”å·¥ä½œæ—¶é—´å†…æ¯åŠå°æ—¶ï¼ˆ6ï¼‰0 0 12 ? * WED   è¡¨ç¤ºæ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ12ç‚¹ï¼ˆ7ï¼‰0 0 12 * * ?   æ¯å¤©ä¸­åˆ12ç‚¹è§¦å‘ï¼ˆ8ï¼‰0 15 10 ? * *   æ¯å¤©ä¸Šåˆ10:15è§¦å‘ï¼ˆ9ï¼‰0 15 10 * * ?     æ¯å¤©ä¸Šåˆ10:15è§¦å‘ï¼ˆ10ï¼‰0 15 10 * * ?   æ¯å¤©ä¸Šåˆ10:15è§¦å‘ï¼ˆ11ï¼‰0 15 10 * * ? 2005   2005å¹´çš„æ¯å¤©ä¸Šåˆ10:15è§¦å‘ï¼ˆ12ï¼‰0 * 14 * * ?     åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°ä¸‹åˆ2:59æœŸé—´çš„æ¯1åˆ†é’Ÿè§¦å‘ï¼ˆ13ï¼‰0 0/5 14 * * ?   åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°ä¸‹åˆ2:55æœŸé—´çš„æ¯5åˆ†é’Ÿè§¦å‘ï¼ˆ14ï¼‰0 0/5 14,18 * * ?     åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°2:55æœŸé—´å’Œä¸‹åˆ6ç‚¹åˆ°6:55æœŸé—´çš„æ¯5åˆ†é’Ÿè§¦å‘ï¼ˆ15ï¼‰0 0-5 14 * * ?   åœ¨æ¯å¤©ä¸‹åˆ2ç‚¹åˆ°ä¸‹åˆ2:05æœŸé—´çš„æ¯1åˆ†é’Ÿè§¦å‘ï¼ˆ16ï¼‰0 10,44 14 ? 3 WED   æ¯å¹´ä¸‰æœˆçš„æ˜ŸæœŸä¸‰çš„ä¸‹åˆ2:10å’Œ2:44è§¦å‘ï¼ˆ17ï¼‰0 15 10 ? * MON-FRI   å‘¨ä¸€è‡³å‘¨äº”çš„ä¸Šåˆ10:15è§¦å‘ï¼ˆ18ï¼‰0 15 10 15 * ?   æ¯æœˆ15æ—¥ä¸Šåˆ10:15è§¦å‘ï¼ˆ19ï¼‰0 15 10 L * ?   æ¯æœˆæœ€åä¸€æ—¥çš„ä¸Šåˆ10:15è§¦å‘ï¼ˆ20ï¼‰0 15 10 ? * 6L   æ¯æœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘ï¼ˆ21ï¼‰0 15 10 ? * 6L 2002-2005   2002å¹´è‡³2005å¹´çš„æ¯æœˆçš„æœ€åä¸€ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘ï¼ˆ22ï¼‰0 15 10 ? * 6#3   æ¯æœˆçš„ç¬¬ä¸‰ä¸ªæ˜ŸæœŸäº”ä¸Šåˆ10:15è§¦å‘</code></pre><p><code>@RequestParam</code> å’Œ <code>@PathVariable</code> æ³¨è§£æ˜¯ç”¨äºä» request ä¸­æ¥æ”¶è¯·æ±‚çš„ï¼Œä¸¤ä¸ªéƒ½å¯ä»¥æ¥æ”¶å‚æ•°ï¼Œå…³é”®ç‚¹ä¸åŒçš„æ˜¯<code>@RequestParam</code> æ˜¯ä» request é‡Œé¢æ‹¿å–å€¼ï¼Œè€Œ <code>@PathVariable</code> æ˜¯ä»ä¸€ä¸ªURIæ¨¡æ¿é‡Œé¢æ¥å¡«å……</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;spring-bootéšè®°&quot;&gt;Spring bootéšè®°&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;çº¦å®šå¤§äºé…ç½®&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;yamlé…ç½®&quot;&gt;yamlé…ç½®:&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;å®ä½“ç±»ä¸ŠåŠ &lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Spring boot" scheme="http://example.com/categories/Spring-boot/"/>
    
    
    <category term="åˆå­¦" scheme="http://example.com/tags/%E5%88%9D%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>Mybatiså…¥é—¨</title>
    <link href="http://example.com/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/"/>
    <id>http://example.com/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/</id>
    <published>2021-09-21T05:36:49.000Z</published>
    <updated>2021-10-11T11:03:43.186Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="mybatiså…¥é—¨ç¬”è®°">mybatiså…¥é—¨ç¬”è®°</span></h1><h2><span id="ç¬¬ä¸€ä¸ªé¡¹ç›®æ­å»ºæµç¨‹">ç¬¬ä¸€ä¸ªé¡¹ç›®æ­å»ºæµç¨‹</span></h2><ol><li><p>æ­å»ºå®éªŒæ•°æ®åº“</p></li><li><p>å¯¼å…¥mybatisç›¸å…³jaråŒ…</p><pre><code class="java">&lt;dependency&gt;            &lt;groupId&gt;mysql&lt;/groupId&gt;            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;            &lt;version&gt;5.1.47&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;            &lt;version&gt;3.5.4&lt;/version&gt;        &lt;/dependency&gt;</code></pre></li><li><p>ç¼–å†™mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶</p><p><strong><!--åƒä¸‡æ³¨æ„é…ç½®mapperæ˜ å°„--></strong></p></li></ol><pre><code class="java">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE configuration        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;&lt;configuration&gt;    &lt;environments default=&quot;development&quot;&gt;        &lt;environment id=&quot;development&quot;&gt;            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;            &lt;dataSource type=&quot;POOLED&quot;&gt;             &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;             &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=false&amp;amp;useUnicode=false&amp;amp;characterEncoding=utf8&quot;/&gt;             &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;             &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;            &lt;/dataSource&gt;        &lt;/environment&gt;    &lt;/environments&gt;        &lt;!--åƒä¸‡æ³¨æ„é…ç½®mapperæ˜ å°„--&gt;    &lt;mappers&gt;        &lt;mapper resource=&quot;com/zz/Userdao/UserMapper.xml&quot;/&gt;    &lt;/mappers&gt;&lt;/configuration&gt;</code></pre><p>4.ç¼–å†™mybatiså·¥å…·ç±»ï¼ˆç›®çš„ï¼šè·å–sqlsessionï¼‰</p><pre><code class="java">package com.zz.utils;import org.apache.ibatis.io.Resources;import org.apache.ibatis.session.Configuration;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.apache.ibatis.session.SqlSessionFactoryBuilder;import javax.annotation.Resource;import java.io.InputStream;public class MybatisUtil &#123;    private static SqlSessionFactory sqlSessionFactory;    static &#123;        try&#123;            String resource=&quot;mybatis-config.xml&quot;;            InputStream inputStream= Resources.getResourceAsStream(resource);            Configuration config;            sqlSessionFactory=new SqlSessionFactoryBuilder().build(inputStream);        &#125;catch (Exception e)&#123;            e.printStackTrace();        &#125;    &#125;    //è·å–sqlsesionè¿æ¥    public static SqlSession getSqlSession()&#123;        return sqlSessionFactory.openSession();    &#125;&#125;</code></pre><p>5.åˆ›å»ºå®ä½“ç±»</p><pre><code class="java">package com.zz.pojo;public class User &#123;    int id;    public User() &#123;    &#125;    @Override    public String toString() &#123;        return &quot;User&#123;&quot; +                &quot;id=&quot; + id +                &quot;, name=&#39;&quot; + name + &#39;\&#39;&#39; +                &quot;, pwd=&quot; + pwd +                &#39;&#125;&#39;;    &#125;    public User(int id, String name, int pwd) &#123;        this.id = id;        this.name = name;        this.pwd = pwd;    &#125;    public void setId(int id) &#123;        this.id = id;    &#125;    public void setName(String name) &#123;        this.name = name;    &#125;    public void setPwd(int pwd) &#123;        this.pwd = pwd;    &#125;    public int getId() &#123;        return id;    &#125;    public String getName() &#123;        return name;    &#125;    public int getPwd() &#123;        return pwd;    &#125;    String name;    int pwd;&#125;</code></pre><p>6.ç¼–å†™mapper.xml</p><p><strong>UserMapper</strong></p><pre><code class="java">package com.zz.UserMapper;import com.zz.pojo.User;import java.util.List;public interface UserMapper &#123;    List&lt;User&gt; selectAll();&#125;</code></pre><p><strong>UserMapper.xml</strong></p><pre><code class="java">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;!DOCTYPE mapper        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.zz.UserMapper.UserMapper&quot;&gt;    &lt;select id=&quot;selectAll&quot; resultType=&quot;com.zz.pojo.User&quot;&gt;        select * from mybatis.user    &lt;/select&gt;&lt;/mapper&gt;</code></pre><p>7.æµ‹è¯•</p><pre><code class="java">import com.zz.UserMapper.UserMapper;import com.zz.pojo.User;import com.zz.utils.MybatisUtil;import org.apache.ibatis.session.SqlSession;import org.junit.Test;import java.util.List;public class test &#123;    @Test    public void select()&#123;        SqlSession session= MybatisUtil.getSqlSession();        List&lt;User&gt; list=session.getMapper(UserMapper.class).selectAll();        for(User u:list)&#123;            System.out.println(u);        &#125;    &#125;&#125;</code></pre><p>8.ç»“æœ</p><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210921140953500.png" alt="image-20210921140953500"></p><p>å¢åˆ æ”¹éœ€è¦æäº¤äº‹åŠ¡ï¼šsqlsession.commit()</p><h2><span id="ä¸‡èƒ½map">ä¸‡èƒ½Map</span></h2><p>å‡è®¾å®ä½“ç±»ï¼Œæˆ–æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­—æ®µæˆ–å‚æ•°è¿‡å¤šæ—¶ï¼Œåº”å½“ä½¿ç”¨map</p><p>æ­¥éª¤ï¼šğŸ‡ğŸ‡ğŸ‡ğŸ‡</p><p> 1.åœ¨æ¥å£ä¸­æ·»åŠ æ–¹æ³•</p><pre><code class="java">public int updateUser(Map&lt;String, Object&gt; map);</code></pre><p>2.åœ¨mapper.xmlä¸­æ·»åŠ </p><pre><code class="java">&lt;update id=&quot;updateUser&quot; parameterType=&quot;map&quot;&gt;        update mybatis.user set name=#&#123;uname&#125;, pwd=#&#123;pwds&#125; where id=#&#123;id&#125;&lt;/update&gt;</code></pre><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210921210742855.png" alt="image-20210921210742855"></p><p>ç”¨mapä½œä¸ºå‚æ•°çš„å¥½å¤„å°±æ˜¯ä¾¿åˆ©ï¼Œç®­å¤´æ‰€æŒ‡å…ƒç´ æ·å…‹åœ¨å®šä¹‰mapæ—¶è‡ªå·±å®šä¹‰ï¼Œè€Œå‚æ•°ä¸ºUserå®ä½“ç±»æ—¶ï¼Œè¿™äº›å‚æ•°çš†éœ€è¦å’Œåœ¨å®šä¹‰å®ä½“ç±»æ—¶ä¸€æ ·</p><p>3.æµ‹è¯•</p><pre><code class="java"> Map&lt;String, Object&gt; map=new HashMap&lt;String, Object&gt;();        map.put(&quot;id&quot;,1);        map.put(&quot;uname&quot;,&quot;sadsada&quot;);        map.put(&quot;pwds&quot;,4646464);        System.out.println(u.updateUser(map));</code></pre><p>æˆåŠŸï¼</p><h2><span id="æ¨¡ç³ŠæŸ¥è¯¢">æ¨¡ç³ŠæŸ¥è¯¢</span></h2><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210921212535801.png" alt="image-20210921212535801"></p><h2><span id="ç»“æœé›†æ˜ å°„">ç»“æœé›†æ˜ å°„</span></h2><p>åœºæ™¯ï¼šå®ä½“ç±»ä¸­å±æ€§åä¸æ•°æ®åº“è¡¨ä¸­å­—æ®µä¸åŒ¹é… å¦‚ï¼šæ•°æ®åº“ä¸­ä¸ºpwdï¼Œå®ä½“ç±»ä¸­ä¸ºpassword</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>â€‹    1.</p><pre><code class="java">&lt;select id=&quot;selectUser&quot; resultType=&quot;com.zz.pojo.User&quot;&gt;        select id,name,pwd as password from mybatis.user;    &lt;/select&gt;</code></pre><p>â€‹    2.ä½¿ç”¨ç»“æœé›†æ˜ å°„(ResultMap)</p><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210922173708063.png" alt="image-20210922173708063"></p><h2><span id="æ—¥å¿—">æ—¥å¿—</span></h2><h3><span id="log4j">Log4j</span></h3><p>  1.å¯¼åŒ…</p><pre><code class="java">&lt;dependency&gt;            &lt;groupId&gt;log4j&lt;/groupId&gt;            &lt;artifactId&gt;log4j&lt;/artifactId&gt;            &lt;version&gt;1.2.17&lt;/version&gt;        &lt;/dependency&gt;</code></pre><p>2.é…ç½®æ–‡ä»¶ç¼–å†™logj.properties</p><pre><code class="java">#å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œconsoleå’Œfileçš„å®šä¹‰åœ¨ä¸‹é¢çš„ä»£ç log4j.rootLogger=DEBUG,console,file#æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½®log4j.appender.console = org.apache.log4j.ConsoleAppenderlog4j.appender.console.Target = System.outlog4j.appender.console.Threshold=DEBUGlog4j.appender.console.layout = org.apache.log4j.PatternLayoutlog4j.appender.console.layout.ConversionPattern=[%c]-%m%n#æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½®log4j.appender.file = org.apache.log4j.RollingFileAppenderlog4j.appender.file.File=./log/zz.loglog4j.appender.file.MaxFileSize=10mblog4j.appender.file.Threshold=DEBUGlog4j.appender.file.layout=org.apache.log4j.PatternLayoutlog4j.appender.file.layout.ConversionPattern=[%p][%d&#123;yy-MM-dd&#125;][%c]%m%n#æ—¥å¿—è¾“å‡ºçº§åˆ«log4j.logger.org.mybatis=DEBUGlog4j.logger.java.sql=DEBUGlog4j.logger.java.sql.Statement=DEBUGlog4j.logger.java.sql.ResultSet=DEBUGlog4j.logger.java.sql.PreparedStatement=DEBUG</code></pre><p>3.settingè®¾ç½®æ—¥å¿—å®ç°<img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210922185902309.png" alt="image-20210922185902309"></p><p>4.å®ç°</p><pre><code class="java">public class test &#123;    static Logger logger=Logger.getLogger(test.class);    @Test    public void select()&#123;        logger.info(&quot;infoï¼šè¿›å…¥selectUseræ–¹æ³•&quot;);        logger.debug(&quot;debugï¼šè¿›å…¥selectUseræ–¹æ³•&quot;);        logger.error(&quot;error: è¿›å…¥selectUseræ–¹æ³•&quot;);        SqlSession session= MybatisUtil.getSqlSession();        List&lt;User&gt; list=session.getMapper(UserMapper.class).selectAll();        for(User u:list)&#123;            System.out.println(u);        &#125;        session.close();    &#125;&#125;</code></pre><h2><span id="åˆ†é¡µ">åˆ†é¡µ</span></h2><p>å¦‚æœæŸ¥è¯¢å¤§é‡æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€ä½¿ç”¨åˆ†é¡µè¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å¤„ç†å°éƒ¨åˆ†æ•°æ®ï¼Œè¿™æ ·å¯¹æ•°æ®åº“å‹åŠ›å°±åœ¨å¯æ§èŒƒå›´å†…ã€‚</p><h3><span id="limitå®ç°åˆ†é¡µ">limitå®ç°åˆ†é¡µ</span></h3><pre><code class="java">#è¯­æ³•SELECT * FROM table LIMIT stratIndexï¼ŒpageSizeSELECT * FROM table LIMIT 5,10; // æ£€ç´¢è®°å½•è¡Œ 6-15  #ä¸ºäº†æ£€ç´¢ä»æŸä¸€ä¸ªåç§»é‡åˆ°è®°å½•é›†çš„ç»“æŸæ‰€æœ‰çš„è®°å½•è¡Œï¼Œå¯ä»¥æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ä¸º -1ï¼š   SELECT * FROM table LIMIT 95,-1; // æ£€ç´¢è®°å½•è¡Œ 96-last.  #å¦‚æœåªç»™å®šä¸€ä¸ªå‚æ•°ï¼Œå®ƒè¡¨ç¤ºè¿”å›æœ€å¤§çš„è®°å½•è¡Œæ•°ç›®ï¼š   SELECT * FROM table LIMIT 5; //æ£€ç´¢å‰ 5 ä¸ªè®°å½•è¡Œ  #æ¢å¥è¯è¯´ï¼ŒLIMIT n ç­‰ä»·äº LIMIT 0,nã€‚</code></pre><p><strong>æ­¥éª¤ï¼š</strong></p><p>1ã€ä¿®æ”¹Mapperæ–‡ä»¶</p><pre><code class="java">&lt;select id=&quot;selectUser&quot; parameterType=&quot;map&quot; resultType=&quot;user&quot;&gt;  select * from user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;&lt;/select&gt;</code></pre><p>2ã€Mapperæ¥å£ï¼Œå‚æ•°ä¸ºmap</p><pre><code class="java">//é€‰æ‹©å…¨éƒ¨ç”¨æˆ·å®ç°åˆ†é¡µList&lt;User&gt; selectUser(Map&lt;String,Integer&gt; map);</code></pre><p>3ã€åœ¨æµ‹è¯•ç±»ä¸­ä¼ å…¥å‚æ•°æµ‹è¯•</p><ul><li>æ¨æ–­ï¼šèµ·å§‹ä½ç½® =  ï¼ˆå½“å‰é¡µé¢ - 1 ï¼‰ * é¡µé¢å¤§å°</li></ul><pre><code class="java">//åˆ†é¡µæŸ¥è¯¢ , ä¸¤ä¸ªå‚æ•°startIndex , pageSize@Testpublic void testSelectUser() &#123;   SqlSession session = MybatisUtils.getSession();   UserMapper mapper = session.getMapper(UserMapper.class);   int currentPage = 1;  //ç¬¬å‡ é¡µ   int pageSize = 2;  //æ¯é¡µæ˜¾ç¤ºå‡ ä¸ª   Map&lt;String,Integer&gt; map = new HashMap&lt;String,Integer&gt;();   map.put(&quot;startIndex&quot;,(currentPage-1)*pageSize);   map.put(&quot;pageSize&quot;,pageSize);   List&lt;User&gt; users = mapper.selectUser(map);   for (User user: users)&#123;       System.out.println(user);  &#125;   session.close();&#125;</code></pre><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/Blog\source_posts\Mybatiså…¥é—¨\image-20210922195302374.png" alt="image-20210922195302374"></p><h2><span id="mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹">Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹</span></h2><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/640" alt="å›¾ç‰‡"></p><h2><span id="ä½¿ç”¨æ³¨è§£å¼€å‘">ä½¿ç”¨æ³¨è§£å¼€å‘</span></h2><p>ã€æ³¨æ„ç‚¹ï¼šå¢åˆ æ”¹ä¸€å®šè®°å¾—å¯¹äº‹åŠ¡çš„å¤„ç†ã€‘</p><pre><code class="java"> //è·å–sqlsesionè¿æ¥    public static SqlSession getSqlSession()&#123;        return sqlSessionFactory.openSession(true);    &#125;//äº‹åŠ¡è‡ªåŠ¨æäº¤&#125;</code></pre><blockquote><p>#ä¸$çš„åŒºåˆ«</p></blockquote><ul><li><p>#{} çš„ä½œç”¨ä¸»è¦æ˜¯æ›¿æ¢é¢„ç¼–è¯‘è¯­å¥(PrepareStatement)ä¸­çš„å ä½ç¬¦? ã€æ¨èä½¿ç”¨ã€‘å¯ä»¥é˜²æ­¢sqlæ³¨å…¥</p><pre><code>INSERT INTO user (name) VALUES (#&#123;name&#125;);INSERT INTO user (name) VALUES (?);</code></pre></li><li><p>${} çš„ä½œç”¨æ˜¯ç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢</p><pre><code>INSERT INTO user (name) VALUES (&#39;$&#123;name&#125;&#39;);INSERT INTO user (name) VALUES (&#39;kuangshen&#39;);</code></pre></li></ul><h2><span id="å¤šå¯¹ä¸€å¤„ç†">å¤šå¯¹ä¸€å¤„ç†</span></h2><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210923213727143.png" alt="image-20210923213727143"></p><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210923213749558.png" alt="image-20210923213749558"></p><p>åˆ›å»ºä¸¤å¼ è¡¨ï¼šStudentï¼ŒTeacher</p><pre><code class="java">//è·å–æ‰€æœ‰å­¦ç”ŸåŠå¯¹åº”è€å¸ˆçš„ä¿¡æ¯    List&lt;Student&gt; getStudents();</code></pre><p>mapper.xmlæ–‡ä»¶ç¼–å†™</p><p>æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†</p><pre><code class="sql">&lt;select id=&quot;getStudents&quot; resultMap=&quot;StudentTeacher&quot;&gt;        select * from student    &lt;/select&gt;    &lt;resultMap id=&quot;StudentTeacher&quot; type=&quot;com.zz.pojo.Student&quot;&gt;        &lt;!--associationå…³è”å±æ€§ propertyå±æ€§å javaTypeå±æ€§ç±»å‹ columnåœ¨å¤šçš„ä¸€æ–¹çš„è¡¨ä¸­çš„åˆ—å--&gt;        &lt;association property=&quot;teacher&quot;  column=&quot;tid&quot; javaType=&quot;com.zz.pojo.Teacher&quot; select=&quot;getTeacher&quot;/&gt;    &lt;/resultMap&gt;    &lt;select id=&quot;getTeacher&quot; resultType=&quot;com.zz.pojo.Teacher&quot;&gt;        select * from teacher where id= #&#123;id&#125;    &lt;/select&gt;</code></pre><p>æŒ‰ç»“æœåµŒå¥—å¤„ç†</p><pre><code class="sql"> &lt;select id=&quot;getStudents2&quot; resultMap=&quot;StudentTeacher2&quot; &gt;        select s.id sid, s.name sname , t.name tname        from student s,teacher t        where s.tid = t.id    &lt;/select&gt;    &lt;resultMap id=&quot;StudentTeacher2&quot; type=&quot;com.zz.pojo.Student&quot;&gt;        &lt;id property=&quot;id&quot; column=&quot;sid&quot;/&gt;        &lt;result property=&quot;name&quot; column=&quot;sname&quot;/&gt;        &lt;!--å…³è”å¯¹è±¡property å…³è”å¯¹è±¡åœ¨Studentå®ä½“ç±»ä¸­çš„å±æ€§--&gt;        &lt;association property=&quot;teacher&quot; javaType=&quot;com.zz.pojo.Teacher&quot;&gt;            &lt;result property=&quot;name&quot; column=&quot;tname&quot;/&gt;        &lt;/association&gt;    &lt;/resultMap&gt;</code></pre><h2><span id="ä¸€å¯¹å¤šå¤„ç†">ä¸€å¯¹å¤šå¤„ç†</span></h2><p><strong>æŒ‰ç»“æœåµŒå¥—å¤„ç†</strong></p><p>Teacher</p><pre><code class="java">@Datapublic class Teacher &#123;    private int id;    private String name;    //ä¸€ä¸ªè€å¸ˆå¤šä¸ªå­¦ç”Ÿ    private List&lt;Student&gt; students;&#125;</code></pre><p>TeacherMapper.xml</p><pre><code class="sql">&lt;!--    æ€è·¯:        1. ä»å­¦ç”Ÿè¡¨å’Œè€å¸ˆè¡¨ä¸­æŸ¥å‡ºå­¦ç”Ÿidï¼Œå­¦ç”Ÿå§“åï¼Œè€å¸ˆå§“å        2. å¯¹æŸ¥è¯¢å‡ºæ¥çš„æ“ä½œåšç»“æœé›†æ˜ å°„            1. é›†åˆçš„è¯ï¼Œä½¿ç”¨collectionï¼                JavaTypeå’ŒofTypeéƒ½æ˜¯ç”¨æ¥æŒ‡å®šå¯¹è±¡ç±»å‹çš„                JavaTypeæ˜¯ç”¨æ¥æŒ‡å®špojoä¸­å±æ€§çš„ç±»å‹                ofTypeæŒ‡å®šçš„æ˜¯æ˜ å°„åˆ°listé›†åˆå±æ€§ä¸­pojoçš„ç±»å‹ã€‚    --&gt;    &lt;select id=&quot;getTeacher&quot; resultMap=&quot;TeacherStudent&quot;&gt;        select s.id sid, s.name sname , t.name tname, t.id tid        from student s,teacher t        where s.tid = t.id and t.id=#&#123;id&#125;    &lt;/select&gt;    &lt;resultMap id=&quot;TeacherStudent&quot; type=&quot;Teacher&quot;&gt;        &lt;result  property=&quot;name&quot; column=&quot;tname&quot;/&gt;        &lt;collection property=&quot;students&quot; ofType=&quot;Student&quot;&gt;            &lt;result property=&quot;id&quot; column=&quot;sid&quot; /&gt;            &lt;result property=&quot;name&quot; column=&quot;sname&quot; /&gt;            &lt;result property=&quot;tid&quot; column=&quot;tid&quot; /&gt;        &lt;/collection&gt;    &lt;/resultMap&gt;</code></pre><p><strong>æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†</strong></p><pre><code class="sql">&lt;select id=&quot;getTeacher2&quot; resultMap=&quot;TeacherStudent2&quot;&gt;        select * from teacher where id=#&#123;id&#125;    &lt;/select&gt;    &lt;!--columnæ˜¯ä¸€å¯¹å¤šçš„å¤–é”® , å†™çš„æ˜¯ä¸€çš„ä¸»é”®çš„åˆ—å--&gt;    &lt;resultMap id=&quot;TeacherStudent2&quot; type=&quot;Teacher&quot;&gt;        &lt;collection property=&quot;students&quot; javaType=&quot;ArrayList&quot; ofType=&quot;Student&quot; column=&quot;id&quot; select=&quot;getStudentByTeacherId&quot;/&gt;    &lt;/resultMap&gt;    &lt;select id=&quot;getStudentByTeacherId&quot; resultType=&quot;Student&quot;&gt;        select * from student where tid=#&#123;id&#125;    &lt;/select&gt;</code></pre><blockquote><p>å°ç»“</p></blockquote><p>1ã€å…³è”-association</p><p>2ã€é›†åˆ-collection</p><p>3ã€æ‰€ä»¥associationæ˜¯ç”¨äºä¸€å¯¹ä¸€å’Œå¤šå¯¹ä¸€ï¼Œè€Œcollectionæ˜¯ç”¨äºä¸€å¯¹å¤šçš„å…³ç³»</p><p>4ã€JavaTypeå’ŒofTypeéƒ½æ˜¯ç”¨æ¥æŒ‡å®šå¯¹è±¡ç±»å‹çš„</p><ul><li>JavaTypeæ˜¯ç”¨æ¥æŒ‡å®špojoä¸­å±æ€§çš„ç±»å‹</li><li>ofTypeæŒ‡å®šçš„æ˜¯æ˜ å°„åˆ°listé›†åˆå±æ€§ä¸­pojoçš„ç±»å‹ã€‚</li></ul><h2><span id="åŠ¨æ€sql">åŠ¨æ€SQL</span></h2><blockquote><p>if è¯­å¥</p></blockquote><p><strong>éœ€æ±‚ï¼šæ ¹æ®ä½œè€…åå­—å’Œåšå®¢åå­—æ¥æŸ¥è¯¢åšå®¢ï¼å¦‚æœä½œè€…åå­—ä¸ºç©ºï¼Œé‚£ä¹ˆåªæ ¹æ®åšå®¢åå­—æŸ¥è¯¢ï¼Œåä¹‹ï¼Œåˆ™æ ¹æ®ä½œè€…åæ¥æŸ¥è¯¢</strong></p><pre><code class="sql">&lt;!--éœ€æ±‚1ï¼šæ ¹æ®ä½œè€…åå­—å’Œåšå®¢åå­—æ¥æŸ¥è¯¢åšå®¢ï¼å¦‚æœä½œè€…åå­—ä¸ºç©ºï¼Œé‚£ä¹ˆåªæ ¹æ®åšå®¢åå­—æŸ¥è¯¢ï¼Œåä¹‹ï¼Œåˆ™æ ¹æ®ä½œè€…åæ¥æŸ¥è¯¢select * from blog where title = #&#123;title&#125; and author = #&#123;author&#125;--&gt;&lt;select id=&quot;queryBlogIf&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;  select * from blog where   &lt;if test=&quot;title != null&quot;&gt;      title = #&#123;title&#125;   &lt;/if&gt;   &lt;if test=&quot;author != null&quot;&gt;      and author = #&#123;author&#125;   &lt;/if&gt;&lt;/select&gt;</code></pre><p>å¦‚æœtitleä¸ºç©ºçš„è¯ï¼Œsqlè¯­å¥ä¸ºé”™è¯¯è¯­å¥ï¼Œé‚£å°±ç”¨åˆ°where</p><blockquote><p>Where</p></blockquote><p>ä¿®æ”¹ä¸Šé¢çš„SQLè¯­å¥ï¼›</p><pre><code class="sql">&lt;select id=&quot;queryBlogIf&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;  select * from blog   &lt;where&gt;       &lt;if test=&quot;title != null&quot;&gt;          title = #&#123;title&#125;       &lt;/if&gt;       &lt;if test=&quot;author != null&quot;&gt;          and author = #&#123;author&#125;       &lt;/if&gt;   &lt;/where&gt;&lt;/select&gt;</code></pre><p>è¿™ä¸ªâ€œwhereâ€æ ‡ç­¾ä¼šçŸ¥é“å¦‚æœå®ƒåŒ…å«çš„æ ‡ç­¾ä¸­æœ‰è¿”å›å€¼çš„è¯ï¼Œå®ƒå°±æ’å…¥ä¸€ä¸ªâ€˜whereâ€™ã€‚æ­¤å¤–ï¼Œå¦‚æœæ ‡ç­¾è¿”å›çš„å†…å®¹æ˜¯ä»¥AND æˆ–OR å¼€å¤´çš„ï¼Œåˆ™å®ƒä¼šå‰”é™¤æ‰ã€‚</p><blockquote><p>Trim</p></blockquote><p>å’ŒwhereåŠŸèƒ½ä¸€æ ·ï¼Œè¿˜å¯ä»¥å»é™¤å¤šä½™çš„é€—å·</p><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20211011190142894.png" alt="image-20211011190142894"></p><p>å¦‚çº¢æ¡†é‡Œçš„noteä¸ºnullï¼Œåˆ™sqlè¯­å¥é”™è¯¯</p><p>åŠ äº†<trim>åˆ™ä¼šé¿å…å‡ºé”™ï¼Œä¼šè‡ªåŠ¨æŠŠrole_nameåé¢çš„é€—å·å»æ‰ï¼Œä»è€Œsqlè¯­å¥ä¸ä¼šå‡ºé”™</trim></p><blockquote><p>Set</p></blockquote><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•</p><pre><code>int updateBlog(Map map);</code></pre><p>2ã€sqlé…ç½®æ–‡ä»¶</p><pre><code class="sql">&lt;!--æ³¨æ„setæ˜¯ç”¨çš„é€—å·éš”å¼€--&gt;&lt;update id=&quot;updateBlog&quot; parameterType=&quot;map&quot;&gt;  update blog     &lt;set&gt;         &lt;if test=&quot;title != null&quot;&gt;            title = #&#123;title&#125;,         &lt;/if&gt;         &lt;if test=&quot;author != null&quot;&gt;            author = #&#123;author&#125;         &lt;/if&gt;     &lt;/set&gt;  where id = #&#123;id&#125;;&lt;/update&gt;</code></pre><blockquote><p>chooseè¯­å¥</p></blockquote><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨åˆ°æ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶ï¼Œåªæƒ³é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªï¼ŒæŸ¥è¯¢æ¡ä»¶æœ‰ä¸€ä¸ªæ»¡è¶³å³å¯ï¼Œä½¿ç”¨ choose æ ‡ç­¾å¯ä»¥è§£å†³æ­¤ç±»é—®é¢˜</p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•</p><pre><code class="sql">List&lt;Blog&gt; queryBlogChoose(Map map);</code></pre><p>2ã€sqlé…ç½®æ–‡ä»¶</p><pre><code class="sql">&lt;select id=&quot;queryBlogChoose&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;  select * from blog   &lt;where&gt;       &lt;choose&gt;           &lt;when test=&quot;title != null&quot;&gt;                title = #&#123;title&#125;           &lt;/when&gt;           &lt;when test=&quot;author != null&quot;&gt;              and author = #&#123;author&#125;           &lt;/when&gt;           &lt;otherwise&gt;              and views = #&#123;views&#125;           &lt;/otherwise&gt;       &lt;/choose&gt;   &lt;/where&gt;&lt;/select&gt;</code></pre><p>3ã€æµ‹è¯•ç±»</p><pre><code class="sql">@Testpublic void testQueryBlogChoose()&#123;   SqlSession session = MybatisUtils.getSession();   BlogMapper mapper = session.getMapper(BlogMapper.class);   HashMap&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;();   map.put(&quot;title&quot;,&quot;Javaå¦‚æ­¤ç®€å•&quot;);   map.put(&quot;author&quot;,&quot;ç‹‚ç¥è¯´&quot;);   map.put(&quot;views&quot;,9999);   List&lt;Blog&gt; blogs = mapper.queryBlogChoose(map);   System.out.println(blogs);   session.close();&#125;</code></pre><p>å¦‚åªæŸ¥è¯¢é˜…è§ˆé‡ä¸º9999çš„ä¹¦ç±åˆ™æ”¹æˆ<img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210924195725942.png" alt="image-20210924195725942"></p><blockquote><p>SQLç‰‡æ®µ</p></blockquote><p>å¯èƒ½æŸä¸ª sql è¯­å¥æˆ‘ä»¬ç”¨çš„ç‰¹åˆ«å¤šï¼Œä¸ºäº†å¢åŠ ä»£ç çš„é‡ç”¨æ€§ï¼Œç®€åŒ–ä»£ç ï¼Œå°†è¿™äº›ä»£ç æŠ½å–å‡ºæ¥ï¼Œç„¶åä½¿ç”¨æ—¶ç›´æ¥è°ƒç”¨ã€‚</p><p><strong>æå–SQLç‰‡æ®µï¼š</strong></p><pre><code class="sql">&lt;sql id=&quot;if-title-author&quot;&gt;   &lt;if test=&quot;title != null&quot;&gt;      title = #&#123;title&#125;   &lt;/if&gt;   &lt;if test=&quot;author != null&quot;&gt;      and author = #&#123;author&#125;   &lt;/if&gt;&lt;/sql&gt;</code></pre><p><strong>å¼•ç”¨SQLç‰‡æ®µï¼š</strong></p><pre><code class="sql">&lt;select id=&quot;queryBlogIf&quot; parameterType=&quot;map&quot; resultType=&quot;blog&quot;&gt;  select * from blog   &lt;where&gt;       &lt;!-- å¼•ç”¨ sql ç‰‡æ®µï¼Œå¦‚æœrefid æŒ‡å®šçš„ä¸åœ¨æœ¬æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆéœ€è¦åœ¨å‰é¢åŠ ä¸Š namespace --&gt;       &lt;include refid=&quot;if-title-author&quot;&gt;&lt;/include&gt;       &lt;!-- åœ¨è¿™é‡Œè¿˜å¯ä»¥å¼•ç”¨å…¶ä»–çš„ sql ç‰‡æ®µ --&gt;   &lt;/where&gt;&lt;/select&gt;</code></pre><p>æ³¨æ„ï¼š</p><p>â‘ ã€æœ€å¥½åŸºäº å•è¡¨æ¥å®šä¹‰ sql ç‰‡æ®µï¼Œæé«˜ç‰‡æ®µçš„å¯é‡ç”¨æ€§</p><p>â‘¡ã€åœ¨ sql ç‰‡æ®µä¸­ä¸è¦åŒ…æ‹¬ where</p><h2><span id="ç¼“å­˜">ç¼“å­˜</span></h2><p>ä¸€çº§ç¼“å­˜ï¼šä¹Ÿå«æœ¬åœ°ç¼“å­˜ï¼š</p><ul><li>ä¸æ•°æ®åº“åŒä¸€æ¬¡ä¼šè¯æœŸé—´æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šæ”¾åœ¨æœ¬åœ°ç¼“å­˜ä¸­ã€‚</li><li>ä»¥åå¦‚æœéœ€è¦è·å–ç›¸åŒçš„æ•°æ®ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿ï¼Œæ²¡å¿…é¡»å†å»æŸ¥è¯¢æ•°æ®åº“ï¼›</li></ul><p>ä¾‹å¦‚ï¼šSqlsession </p><p>ä½“éªŒï¼šæµ‹è¯•åœ¨ä¸€ä¸ªsessionä¸­æŸ¥è¯¢ä¸¤æ¬¡ç›¸åŒè®°å½•ï¼Œç¬¬äºŒæ¬¡ç›´æ¥ä»ç¼“å­˜è®¿é—®ï¼Œä¸å»è®¿é—®æ•°æ®åº“</p><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210924203651727.png" alt="image-20210924203651727"></p><p><img src="/2021/09/21/Mybatis%E5%85%A5%E9%97%A8/image-20210924203701534.png" alt="image-20210924203701534"></p><p>ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å››ç§æƒ…å†µ:</p><p>1ã€sqlSessionä¸åŒ</p><p>2ã€sqlSessionç›¸åŒï¼ŒæŸ¥è¯¢æ¡ä»¶ä¸åŒ</p><p>3ã€sqlSessionç›¸åŒï¼Œä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´æ‰§è¡Œäº†å¢åˆ æ”¹æ“ä½œï¼</p><p>4ã€sqlSessionç›¸åŒï¼Œæ‰‹åŠ¨æ¸…é™¤ä¸€çº§ç¼“å­˜</p><pre><code class="java">session.clearCache();//æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜</code></pre><p><strong>ä¸€çº§ç¼“å­˜å°±æ˜¯ä¸€ä¸ªmap</strong></p><blockquote><p>äºŒçº§ç¼“å­˜</p></blockquote><ul><li><p>äºŒçº§ç¼“å­˜ä¹Ÿå«å…¨å±€ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜ä½œç”¨åŸŸå¤ªä½äº†ï¼Œæ‰€ä»¥è¯ç”Ÿäº†äºŒçº§ç¼“å­˜</p></li><li><p>åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ï¼Œä¸€ä¸ªåç§°ç©ºé—´ï¼Œå¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ï¼›</p></li><li><p>å·¥ä½œæœºåˆ¶</p></li><li><ul><li>ä¸€ä¸ªä¼šè¯æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«æ”¾åœ¨å½“å‰ä¼šè¯çš„ä¸€çº§ç¼“å­˜ä¸­ï¼›</li><li>å¦‚æœå½“å‰ä¼šè¯å…³é—­äº†ï¼Œè¿™ä¸ªä¼šè¯å¯¹åº”çš„ä¸€çº§ç¼“å­˜å°±æ²¡äº†ï¼›ä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ˜¯ï¼Œä¼šè¯å…³é—­äº†ï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®è¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼›</li><li>æ–°çš„ä¼šè¯æŸ¥è¯¢ä¿¡æ¯ï¼Œå°±å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–å†…å®¹ï¼›</li><li>ä¸åŒçš„mapperæŸ¥å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜ï¼ˆmapï¼‰ä¸­ï¼›</li></ul></li></ul><p>ç®€å•åœ°æ¥è¯´ï¼šäºŒçº§ç¼“å­˜å°±æ˜¯ä¸ºäº†æƒ³ä»ç¼“å­˜ä¸­æŸ¥è¯¢ä¸€çº§ç¼“å­˜ä¸­æ²¡æœ‰çš„ä¸œè¥¿ï¼ˆä¸ªäººç†è§£ï¼‰</p><blockquote><p>ä½¿ç”¨æ­¥éª¤</p></blockquote><p>1ã€å¼€å¯å…¨å±€ç¼“å­˜ ã€mybatis-config.xmlã€‘</p><pre><code class="java">&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;</code></pre><p>2ã€å»æ¯ä¸ªmapper.xmlä¸­é…ç½®ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œè¿™ä¸ªé…ç½®éå¸¸ç®€å•ï¼›ã€xxxMapper.xmlã€‘</p><pre><code class="java">&lt;cache/&gt;</code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;mybatiså…¥é—¨ç¬”è®°&quot;&gt;mybatiså…¥é—¨ç¬”è®°&lt;/span&gt;&lt;/h1&gt;&lt;h2&gt;&lt;span id=&quot;ç¬¬ä¸€ä¸ªé¡¹ç›®æ­å»ºæµç¨‹&quot;&gt;ç¬¬ä¸€ä¸ªé¡¹ç›®æ­å»ºæµç¨‹&lt;/span&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æ­å»ºå®éªŒæ•°æ®åº“&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¼å…¥mybat</summary>
      
    
    
    
    <category term="Aboutæ•°æ®åº“" scheme="http://example.com/categories/About%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="mybatis" scheme="http://example.com/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨</title>
    <link href="http://example.com/2021/09/18/%E6%8B%A6%E6%88%AA%E5%99%A8%E4%B8%8E%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
    <id>http://example.com/2021/09/18/%E6%8B%A6%E6%88%AA%E5%99%A8%E4%B8%8E%E8%BF%87%E6%BB%A4%E5%99%A8/</id>
    <published>2021-09-18T12:46:41.000Z</published>
    <updated>2021-09-20T12:48:17.592Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨">æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨</span></h1><ul><li><p>è¿‡æ»¤å™¨è¿˜å¾—é…ç½®é™æ€èµ„æºè¿‡æ»¤ï¼Œæ‹¦æˆªå™¨åªä¼šæ‹¦æˆªè®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œå¦‚è®¿é—®é™æ€èµ„æºæ˜¯ä¸ä¼šæ‹¦æˆªçš„</p></li><li><p>æ‹¦æˆªå™¨æ˜¯AOPæ€æƒ³çš„å…·ä½“è¿ç”¨ï¼Œæ˜¯springmvcæ¡†æ¶è‡ªå·±çš„ï¼Œä½¿ç”¨äº†springmvcæ¡†æ¶çš„å·¥ç¨‹æ‰èƒ½ä½¿ç”¨b</p></li><li><p>ç»§æ‰¿æ‹¦æˆªå™¨ä¸è®¸é‡å†™ï¼Œç»§æ‰¿è¿‡æ»¤å™¨éœ€è¦é‡å†™æ–¹æ³•</p></li></ul><p>åœ¨web-INFä¸‹çš„æ‰€æœ‰é¡µé¢åªèƒ½é€šè¿‡controlleræˆ–è€…servletè®¿é—®</p><h2><span id="å®ç°æ‹¦æˆªå™¨">å®ç°æ‹¦æˆªå™¨</span></h2><p>å®šä¹‰ä¸ªæ€§åŒ–æ‹¦æˆªå™¨</p><ol><li><p>å®ç°æ‹¦æˆªå™¨æ¥å£</p><pre><code class="java">package com.zz.config;import org.springframework.web.servlet.HandlerInterceptor;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;public class LoignIntercepter implements HandlerInterceptor &#123;    @Override    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;        HttpSession httpSession= request.getSession();        System.out.println(&quot;uri&quot;+request.getRequestURI());        //å¦‚è·³è½¬çš„æ˜¯ç™»å½•é¡µé¢        if(request.getRequestURI().contains(&quot;login&quot;))&#123;            return true;        &#125;        if(httpSession.getAttribute(&quot;userlogininfo&quot;)!=null)&#123;            return true;        &#125;        //æ‰§è¡Œåˆ°è¿™é‡Œè¯´æ˜ç”¨æˆ·æ²¡æœ‰ç™»é™†        // ç”¨æˆ·æ²¡æœ‰ç™»é™†å°±è·³è½¬åˆ°ç™»é™†é¡µé¢        request.getRequestDispatcher(&quot;/WEB-INF/jsp/login.jsp&quot;).forward(request,response);        return false;    &#125;&#125;</code></pre></li><li><p>åœ¨applicationcontext.xmlé‡Œé…ç½®</p><pre><code class="java">&lt;mvc:interceptors&gt;        &lt;mvc:interceptor&gt;            &lt;!--åŒ…æ‹¬è¿™ä¸ªè¯·æ±‚ä¸‹æ‰€æœ‰çš„è¯·æ±‚--&gt;            &lt;mvc:mapping path=&quot;/**&quot;/&gt;            &lt;bean class=&quot;com.zz.config.MyInterceptor&quot;/&gt;        &lt;/mvc:interceptor&gt;        &lt;mvc:interceptor&gt;            &lt;mvc:mapping path=&quot;/**&quot;/&gt;            &lt;bean class=&quot;com.zz.config.LoignIntercepter&quot;/&gt;        &lt;/mvc:interceptor&gt;    &lt;/mvc:interceptors&gt;</code></pre></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨&quot;&gt;æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨&lt;/span&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è¿‡æ»¤å™¨è¿˜å¾—é…ç½®é™æ€èµ„æºè¿‡æ»¤ï¼Œæ‹¦æˆªå™¨åªä¼šæ‹¦æˆªè®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œå¦‚è®¿é—®é™æ€èµ„æºæ˜¯ä¸ä¼šæ‹¦æˆªçš„&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‹¦æˆªå™¨æ˜¯AOPæ€æƒ³çš„å…·ä½“è¿ç”¨ï¼Œæ˜¯springmvc</summary>
      
    
    
    
    <category term="spring mvc" scheme="http://example.com/categories/spring-mvc/"/>
    
    
    <category term="æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨" scheme="http://example.com/tags/%E6%8B%A6%E6%88%AA%E5%99%A8%E4%B8%8E%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>ajaxæ€»ç»“</title>
    <link href="http://example.com/2021/09/18/ajax%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2021/09/18/ajax%E6%80%BB%E7%BB%93/</id>
    <published>2021-09-18T11:35:00.000Z</published>
    <updated>2021-10-13T09:04:21.966Z</updated>
    
    <content type="html"><![CDATA[<h1><span id="ajax">Ajax</span></h1><p>ç°åœ¨å¯¹Ajaxçš„ç†è§£å°±æ˜¯ç®€ç®€å•å•åœ°ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</p><p>Ajaxçš„æ ¸å¿ƒæ˜¯XMLHttpRequestå¯¹è±¡(XHR)ã€‚XHRä¸ºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚å’Œè§£ææœåŠ¡å™¨å“åº”æä¾›äº†æ¥å£ã€‚èƒ½å¤Ÿä»¥å¼‚æ­¥æ–¹å¼ä»æœåŠ¡å™¨è·å–æ–°æ•°æ®ã€‚</p><p>jQuery æä¾›å¤šä¸ªä¸ AJAX æœ‰å…³çš„æ–¹æ³•ã€‚</p><p><strong>å®ç°å¼‚æ­¥éªŒè¯ç”¨æˆ·å</strong></p><p>æ–°å»ºä¸€ä¸ªmavené¡¹ç›®ï¼Œå¢åŠ webæ”¯æŒï¼Œ<strong>é…ç½®å¥½tomcatæœåŠ¡å™¨</strong>ï¼ˆå°±é…ç½®è¿™ç ´ç©æ„äºŒèŠ±äº†æˆ‘ä¸¤å¤©ï¼ï¼ï¼ï¼ï¼ï¼ï¼å¦‚æœ‰é—®é¢˜ï¼šé¦–å…ˆæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä¸è¦å†åŸé¡¹ç›®ä¸‹æ–°å»ºä¸€ä¸ªmodleï¼›æ¥ä¸‹æ¥å°±æ˜¯é…ç½®å¥½tomcatçš„deploymentï¼‰</p><p><img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918194117558.png" alt="image-20210918194117558"></p><img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918194214940.png" alt="image-20210918194214940" style="zoom: 50%;"><p>å¦‚æ²¡æœ‰Artifactï¼Œç‚¹å‡»åŠ å·æŠŠç°é¡¹ç›®ä»¥waråŒ…å½¢å¼å‘å¸ƒï¼Œç‚¹å‡»ğŸ†—å³å¯ã€‚</p><p><img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918194435095.png" alt="image-20210918194435095"></p><p><img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918194456928.png" alt="image-20210918194456928"></p><p>å¦‚é¡¹ç›®éƒ¨ç½²æˆåŠŸè®¿é—®controlleræ˜¾ç¤º500ï¼ŒåŸå› å¯èƒ½æ˜¯springç‰ˆæœ¬å’Œtomcatç‰ˆæœ¬ä¸åŒ¹é…ï¼Œæˆ‘çš„ä¹‹å‰æœ‰é—®é¢˜çš„å°±æ˜¯å› ä¸ºç”¨çš„æ˜¯tomcat6ï¼Œæ¢æˆtomcat9å°±å¥½äº†ã€‚è¿˜æœ‰è¿˜æœ‰ï¼šï¼šï¼šï¼š<strong>è®°å¾—åœ¨project structureé‡Œé¢çš„artifactsé¡¹é‡Œé…ç½®libç›®å½•</strong>ã€‚</p><h2><span id="è¨€å½’æ­£ä¼ ">è¨€å½’æ­£ä¼ </span></h2><p>å¼€å§‹å®ç°åŠŸèƒ½äº†ğŸ§¨ğŸ§¨ğŸ§¨ğŸ ğŸ ğŸ ğŸŠğŸŠğŸŠ</p><p>å®ç°æ•ˆæœç®€å•çš„æ¥è¯´å°±æ˜¯è¾“å…¥è´¦å·åå’Œå¯†ç ï¼Œå½“é¼ æ ‡ç¦»å¼€è¾“å…¥æ¡†ä¹Ÿå°±æ˜¯å¤±å»ç„¦ç‚¹ï¼Œé¡µé¢ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ­£ç¡®æˆ–é”™è¯¯/<img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918195233626.png" alt="image-20210918195233626"></p><p><img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918195314836.png" alt="image-20210918195314836"></p><p>é¦–å…ˆç¼–å†™controllerå±‚ï¼ˆUserControllerï¼‰</p><ul><li>è®°å¾—æ§åˆ¶ç±»å‰è¦åŠ @Restcontrolleræ³¨è§£ï¼Œå°±ä¼šä»¥jsonå½¢å¼è¿”å›å‰å°æ•°æ®</li></ul><pre><code class="java">package com.zz.controller;import com.zz.pojo.User;import org.springframework.stereotype.Controller;import org.springframework.web.HttpMediaTypeException;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import javax.security.auth.login.CredentialException;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.ArrayList;import java.util.List;@RestControllerpublic class AjaxController &#123;       @RequestMapping(&quot;/a3&quot;)    public String ajax3(String name,String pwd)&#123;        String msg = &quot;&quot;;        //æ¨¡æ‹Ÿæ•°æ®åº“ä¸­å­˜åœ¨æ•°æ®        if (name!=null)&#123;            if (&quot;admin&quot;.equals(name))&#123;                msg = &quot;OK&quot;;            &#125;else &#123;                msg = &quot;ç”¨æˆ·åè¾“å…¥é”™è¯¯&quot;;            &#125;        &#125;        if (pwd!=null)&#123;            if (&quot;123456&quot;.equals(pwd))&#123;                msg = &quot;OK&quot;;            &#125;else &#123;                msg = &quot;å¯†ç è¾“å…¥æœ‰è¯¯&quot;;            &#125;        &#125;        return msg; //ç”±äº@RestControlleræ³¨è§£ï¼Œå°†msgè½¬æˆjsonæ ¼å¼è¿”å›    &#125;&#125;</code></pre><p>ç„¶åä»ç½‘ä¸Šä¸‹è½½jqueryï¼Œæ”¾åœ¨é¡¹ç›®çš„webåŒ…ä¸­ï¼Œç„¶åç¼–å†™login.jspé¡µé¢</p><pre><code class="jsp">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&lt;html&gt;&lt;head&gt;  &lt;title&gt;ajax&lt;/title&gt;  &lt;script src=&quot;$&#123;pageContext.request.contextPath&#125;/statics/js/jquery.js&quot;&gt;&lt;/script&gt;  &lt;script&gt;    function a1()&#123;      $.post(&#123;        url:&quot;$&#123;pageContext.request.contextPath&#125;/a3&quot;,        data:&#123;&#39;name&#39;:$(&quot;#name&quot;).val()&#125;,        success:function (data) &#123;          if (data.toString()==&#39;OK&#39;)&#123;            $(&quot;#userInfo&quot;).css(&quot;color&quot;,&quot;green&quot;);          &#125;else &#123;            $(&quot;#userInfo&quot;).css(&quot;color&quot;,&quot;red&quot;);          &#125;          $(&quot;#userInfo&quot;).html(data);        &#125;      &#125;);    &#125;    function a2()&#123;      $.post(&#123;        url:&quot;$&#123;pageContext.request.contextPath&#125;/a3&quot;,        data:&#123;&#39;pwd&#39;:$(&quot;#pwd&quot;).val()&#125;,        success:function (data) &#123;          if (data.toString()==&#39;OK&#39;)&#123;            $(&quot;#pwdInfo&quot;).css(&quot;color&quot;,&quot;green&quot;);          &#125;else &#123;            $(&quot;#pwdInfo&quot;).css(&quot;color&quot;,&quot;red&quot;);          &#125;          $(&quot;#pwdInfo&quot;).html(data);        &#125;      &#125;);    &#125;  &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;  ç”¨æˆ·å:&lt;input type=&quot;text&quot; id=&quot;name&quot; onblur=&quot;a1()&quot;/&gt;  &lt;span id=&quot;userInfo&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;  å¯†ç :&lt;input type=&quot;text&quot; id=&quot;pwd&quot; onblur=&quot;a2()&quot;/&gt;  &lt;span id=&quot;pwdInfo&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>åˆ°ç°åœ¨å¯åŠ¨æœåŠ¡å™¨å°±å¯ä»¥çœ‹åˆ°å•¦ï¼ŒæˆåŠŸååœ¨æµè§ˆå™¨æŸ¥çœ‹æ—¶æ¯å¤±å»ç„¦ç‚¹æ—¶éƒ½ä¼šå‘åå°å‘é€è¯·æ±‚ï¼Œä¹Ÿæ˜¯<strong>Ajaxçš„ç‹¬ç‰¹ä¹‹å¤„ï¼ŒæŠŠä¸»åŠ¨æƒäº¤ç»™äº†å‰ç«¯ã€‚</strong></p><p>æ”¾ä¸€ä¸‹é¡¹ç›®ç»“æ„å›¾å§</p><p><img src="/2021/09/18/ajax%E6%80%BB%E7%BB%93/image-20210918200158409.png" alt="image-20210918200158409"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;&lt;span id=&quot;ajax&quot;&gt;Ajax&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;ç°åœ¨å¯¹Ajaxçš„ç†è§£å°±æ˜¯ç®€ç®€å•å•åœ°ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ&lt;/p&gt;
&lt;p&gt;Ajaxçš„æ ¸å¿ƒæ˜¯XMLHttpRequestå¯¹è±¡(XHR)ã€‚XHRä¸ºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚å’Œè§£ææœåŠ¡å™¨å“åº”æä¾›äº†æ¥å£ã€‚èƒ½å¤Ÿä»¥å¼‚æ­¥æ–¹å¼ä»æœåŠ¡å™¨è·å–æ–°</summary>
      
    
    
    
    
    <category term="ajax" scheme="http://example.com/tags/ajax/"/>
    
  </entry>
  
</feed>
